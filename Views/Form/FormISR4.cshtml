<html lang="en" ng-app="Stock-CMS">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Form ISR 4</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        h1 {
            color: black;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 18pt;
        }

        .s1 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 10pt;
        }

        h2 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 15pt;
        }

        h3 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 12pt;
        }

        .p,
        p {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
            margin: 0pt;
        }

        .s4 {
            color: black;
            font-family: Wingdings;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 14pt;
        }

        .a {
            color: #0462c1;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: underline;
            font-size: 12pt;
        }

        .s7 {
            color: #0462c1;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: underline;
            font-size: 12pt;
        }

        .s8 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 11pt;
        }

        .s9 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        .s11 {
            color: black;
            font-family: "Times New Roman", serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 14pt;
        }

        .s12 {
            color: black;
            font-family: Cambria, serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 20pt;
        }

        .s13 {
            color: black;
            font-family: "Times New Roman", serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        .s14 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: italic;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        .s15 {
            color: black;
            font-family: Cambria, serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 14pt;
        }

        .s16 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: italic;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        .s18 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 12pt;
        }

        .s19 {
            color: black;
            font-family: "Bookshelf Symbol 7";
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        li {
            display: block;
        }

        #l1 {
            padding-left: 0pt;
            counter-reset: c1 1;
        }

            #l1 > li > *:first-child:before {
                counter-increment: c1;
                /* content: counter(c1, upper-latin) ". "; */
                color: black;
                font-family: Arial, sans-serif;
                font-style: normal;
                font-weight: bold;
                text-decoration: none;
                font-size: 12pt;
            }

            #l1 > li:first-child > *:first-child:before {
                counter-increment: c1 0;
            }

        #l2 {
            padding-left: 0pt;
        }

            #l2 > li > *:first-child:before {
                /* content: " "; */
                color: black;
                font-family: Symbol, serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 12pt;
            }

        #l3 {
            padding-left: 0pt;
        }

            #l3 > li > *:first-child:before {
                /* content: " "; */
                color: black;
                font-family: Symbol, serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 12pt;
            }

        table,
        tbody {
            vertical-align: top;
            overflow: visible;
        }


        .card {
            border-radius: 10px;
            overflow: hidden;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .form-select {
            width: 100%;
            padding: 0.75rem;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 1rem;
        }

        .btn-primary {
            width: 100%;
            padding: 12px 16px;
            text-transform: uppercase;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .myTable {
            border-collapse: collapse;
            margin-left: 56px;
            min-width: 750px;
        }

            /* Cell styles */
            .myTable td {
                border: 1px solid #babdbf;
                padding: 3pt;
            }

            /* Header row styles */
            .myTable tr:first-child td {
                font-weight: bold; /* Or use a class for header cells */
            }

            /* Column width adjustments */
            .myTable td:nth-child(1) {
                width: 104pt;
            }

            .myTable td:nth-child(2) {
                width: 108pt;
            }

            .myTable td:nth-child(3) {
                width: 99pt;
            }

            .myTable td:nth-child(4) {
                width: 71pt;
            }

            .myTable td:nth-child(5) {
                width: 95pt;
            }

            /* Text alignment and indentation */
            .myTable p {
                margin: 0;
                text-align: left;
            }

            .myTable td:nth-child(3) p {
                padding-right: 36pt;
            }

            /* Line height */
            .myTable p {
                line-height: 114%;
            }


        .bold {
            font-weight: bold;
        }


        .btn-primary:hover {
            background-color: #0056b3;
            transform: scale(1.05);
        }

        .mybtn {
            background-color: #51b37f !important;
            color: white !important;
            width: auto !important;
        }

        .myarea {
            justify-content: center !important;
            display: flex !important;
            margin-top: 25px !important;
        }
    </style>
</head>
<body style="padding: 5%;" ng-controller="FormController">
    <div class="row align-items-center">
        <!-- Arrow Icon aligned to the left -->
        <a class="col-md-1 text-start" style="font-size:35px;" ng-click="navtogenerateform()">
            <i class="bi bi-arrow-left"></i>
        </a>

        <!-- Centered Heading -->
        <div class="col-md-10 text-center">
            <h3>Form ISR 4</h3>
        </div>
    </div>

    <form name="gForm" ng-submit="genrateForm()">
        <div ng-if="hDiv" class="container my-5">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h4 class="card-title text-center mb-4" style="color:#51b37f;">Generate Form</h4>

                    <div class="row">
                        <!-- Select Customer Dropdown -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="seletedId" class="form-label">Select Customer</label>
                                <select class="form-select" id="seletedId" ng-options="f.id as f.name for f in docs" ng-model="seletedId" ng-change="loadCustomers(seletedId, heirId)">
                                    <option selected disabled value="">Select customer</option>
                                </select>
                            </div>
                        </div>

                        <!-- Select Heir Dropdown -->
                        <div class="col-md-4 mb-3" ng-show="legalheirlist">
                            <div class="form-group">
                                <label for="heirId" class="form-label">Select Heir</label>
                                <select class="form-select" id="heirId" ng-options="g.id as g.name for g in heir" ng-model="heirId" ng-change="loadCustomers(seletedId, heirId)">
                                    <option selected disabled value="">Select Heir</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-md-4 mb-3" ng-show="doclist.option2">
                            <div class="form-group">
                                <label for="unclaimedqty" class="form-label">Unclaimed Quantity</label>
                                <input type="text" ng-model="data.unclaimedqty" class="form-control" ng-change="loadCustomers(seletedId)" placeholder="Unclaimed Quantity">
                            </div>
                        </div>

                        <div class="col-md-4 mb-3" ng-show="doclist.option9">
                            <div class="form-group">
                                <label for="suspenseqty" class="form-label">Suspense Escrow Quantity</label>
                                <input type="text" ng-model="data.suspenseqty" class="form-control" ng-change="loadCustomers(seletedId)" placeholder="Suspense Escrow Quantity">
                            </div>
                        </div>

                        <!-- Certificate Nos
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label for="certificatenos" class="form-label">Certificate Nos</label>
                                    <input type="text" ng-model="data.certificatenos" class="form-control" placeholder="Certificate Nos">
                                </div>
                        </div>-->
                        <!-- Distinctive Nos Start
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label for="distinctiveNosStart" class="form-label">Distinctive Nos Start</label>
                                    <input type="text" ng-model="data.distinctiveNosStart" class="form-control" placeholder="Distinctive Nos Start">
                                </div>
                        </div>-->
                    </div>
                    <div class="row">
                        <!-- Distinctive Nos End
                            <div class="col-md-4 mb-3">
                                <div class="form-group">
                                    <label for="distinctiveNosEnd" class="form-label">Distinctive Nos End</label>
                                    <input type="text" ng-model="data.distinctiveNosEnd" class="form-control" placeholder="Distinctive Nos End">
                                </div>
                        </div>-->
                    </div>
                    <!-- Submit Button
                    <div class="col-md-4 text-center mt-4">
                        <button type="submit" ng-disabled="processdone" class="btn btn-primary px-4" style="background-color:#51b37f; color:white; border-radius: 5px;">
                            Generate Form
                        </button>
                    </div>-->

                </div>
            </div>
        </div>

        <div id="printForm">
            <h1 style="padding-top: 3pt; padding-left: 42pt; text-indent: 0pt; text-align: center;">Form ISR-4</h1>
            <p class="s1" style="padding-top: 1pt; padding-left: 42pt; text-indent: 0pt; line-height: 114%; text-align: center;">
                (see circular No. SEBI/HO/MIRSD/MIRSD_RTAMB/P/CIR/2022/8 dated January 25, 2022 on Issuance of Securities in dematerialized form in case of Investor Service Requests)
            </p>
            <h2 style="padding-left: 42pt; text-indent: 0pt; line-height: 18pt; text-align: center;">Request for issue of Duplicate Certificate and other Service Requests</h2>
            <p class="s1" style="padding-top: 1pt; padding-left: 42pt; text-indent: 0pt; text-align: center;">(for Securities - Shares / Debentures / Bonds, etc., held in physical form)</p>
            <p style="padding-top: 2pt; text-indent: 0pt; text-align: left;"><br /></p>
            <p class="s1" style="text-indent: 0pt; line-height: 12pt; text-align: right;">
                <b>Date:</b><u>{{data.today | date:'dd/MM/yyyy'}}</u>
            </p>
            <ol id="l1">
                <li data-list-text="A.">
                    <h3 style="padding-left: 71pt; text-indent: -28pt; line-height: 10pt; text-align: justify;">Mandatory Documents / details required for processing all service request<span class="p">:</span></h3>
                    <p style="padding-left: 43pt; text-indent: 0pt; text-align: justify;">
                        <b>
                            I / We are submitting the following documents / details and undertake to request the Depository Participant to dematerialize my / our securities within 120 days from the date of issuance of Letter of Confirmation,
                            received from the RTA/Issuer Company
                        </b>
                        (tick <span class="s4"></span>as relevant, refer to the instructions):
                    </p>
                    <ul id="l2">
                        <li data-list-text="">
                            <p style="padding-top: 5pt; padding-left: 64pt; text-indent: -21pt; line-height: 129%; text-align: justify;">
                                Demat Account No. (If available):
                                <u>
                                    @* 46485446858456845 *@{{data.dpid}}{{data.clientid}}
                                </u>
                                Provide Client Master List (<b>CML</b>) of your Demat Account from the Depository Participant*
                            </p>
                        </li>
                        <li data-list-text="">
                            <p class="s8" style="padding-top: 10pt; padding-left: 61pt; text-indent: -18pt; text-align: justify;">
                                <a href="https://www.sebi.gov.in/legal/circulars/nov-2021/common-and-simplified-norms-for-processing-investor-s-service-request-by-rtas-and-norms-for-furnishing-pan-kyc-details-and-nomination_53787.html"
                                   style="color: black; font-family: Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;"
                                   target="_blank">
                                    Provide the following details, if they are not already available with the RTA (see
                                </a>
                                <span class="s7">SEBI</span>
                                <a href="https://www.sebi.gov.in/legal/circulars/nov-2021/common-and-simplified-norms-for-processing-investor-s-service-request-by-rtas-and-norms-for-furnishing-pan-kyc-details-and-nomination_53787.html"
                                   style="color: #0462c1; font-family: Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;"
                                   target="_blank">
                                </a>
                                <span class="s7">circular dated November 03, 2021 </span>in this regard<span class="p">)</span>
                            </p>
                            <table style="border-collapse: collapse; margin-left: 45.914pt;" cellspacing="0">
                                <tr style="height: 15pt;">
                                    <td style="
                                        width: 243pt;
                                        border-top-style: dotted;
                                        border-top-width: 1pt;
                                        border-left-style: dotted;
                                        border-left-width: 1pt;
                                        border-bottom-style: dotted;
                                        border-bottom-width: 1pt;
                                        border-right-style: dotted;
                                        border-right-width: 1pt;
                                    ">
                                        <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">PAN</p>
                                    </td>
                                    <td style="
                                        width: 203pt;
                                        border-top-style: dotted;
                                        border-top-width: 1pt;
                                        border-left-style: dotted;
                                        border-left-width: 1pt;
                                        border-bottom-style: dotted;
                                        border-bottom-width: 1pt;
                                        border-right-style: dotted;
                                        border-right-width: 1pt;
                                    ">
                                        <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Specimen Signature</p>
                                    </td>
                                </tr>
                                <tr style="height: 21pt;">
                                    <td style="
                                        width: 243pt;
                                        border-top-style: dotted;
                                        border-top-width: 1pt;
                                        border-left-style: dotted;
                                        border-left-width: 1pt;
                                        border-bottom-style: dotted;
                                        border-bottom-width: 1pt;
                                        border-right-style: dotted;
                                        border-right-width: 1pt;
                                    ">
                                        <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;" ng-show="!data.condition">
                                            {{data.firstHolderpan}}
                                            <br />{{data.secondHolderpan}}
                                            <br />{{data.thirdHolderpan}}
                                        </p>
                                        <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;" ng-show="data.condition" >
                                            <span ng-repeat="h in data.heirs "> <br />{{h.pan}}</span>
                                            
                                        </p>
                                       Nomination / Declaration to Opt-out
                                    </td>
                                    <td style="
                                        width: 203pt;
                                        border-top-style: dotted;
                                        border-top-width: 1pt;
                                        border-left-style: dotted;
                                        border-left-width: 1pt;
                                        border-bottom-style: dotted;
                                        border-bottom-width: 1pt;
                                        border-right-style: dotted;
                                        border-right-width: 1pt;
                                    ">
                                        <p style="text-indent: 0pt; text-align: left;"><br /></p>
                                    </td>
                                </tr>
                            </table>
                            <p style="padding-left: 43pt; text-indent: 0pt; line-height: 108%; text-align: justify;">
                                * (Your address, e-mail address, mobile number and bank details shall be updated in your folio from the information available in your <b>CML</b>
                                <a href="https://www.sebi.gov.in/sebi_data/commondocs/dec-2021/pdf%20Form%20ISR-1%20(1)_p.pdf"
                                   style="color: black; font-family: Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;"
                                   target="_blank">
                                    ). You can authorize the RTA to update the above details for all your folios. In this regard, please refer to and use
                                </a>
                                <a href="https://www.sebi.gov.in/sebi_data/commondocs/dec-2021/pdf%20Form%20ISR-1%20(1)_p.pdf" class="a" target="_blank">Form </a><span class="s7">ISR-1</span>
                                <a href="https://www.sebi.gov.in/legal/circulars/nov-2021/common-and-simplified-norms-for-processing-investor-s-service-request-by-rtas-and-norms-for-furnishing-pan-kyc-details-and-nomination_53787.html"
                                   style="color: black; font-family: Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;"
                                   target="_blank">
                                    in
                                </a>
                                <span class="s7">SEBI</span>
                                <a href="https://www.sebi.gov.in/legal/circulars/nov-2021/common-and-simplified-norms-for-processing-investor-s-service-request-by-rtas-and-norms-for-furnishing-pan-kyc-details-and-nomination_53787.html"
                                   style="color: #0462c1; font-family: Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;"
                                   target="_blank">
                                </a>
                                <a href="https://www.sebi.gov.in/legal/circulars/nov-2021/common-and-simplified-norms-for-processing-investor-s-service-request-by-rtas-and-norms-for-furnishing-pan-kyc-details-and-nomination_53787.html"
                                   class="a"
                                   target="_blank">
                                    circular dated November 03,
                                </a>
                                <span class="s7">2021</span><span style="color: #4471c4;">.</span>
                            </p>
                            <p style="text-indent: 0pt; text-align: left;"><br /></p>
                        </li>
                    </ul>
                </li>
                <li data-list-text="B.">
                    <p style="padding-left: 71pt; text-indent: -28pt; text-align: left;">I / We request you for the following (tick <span class="s4"></span><span class="s11"> </span>relevant box)</p>
                    <table style="border-collapse: collapse; margin-left: 43.274pt;" cellspacing="0">
                        <tr style="height: 40pt;">
                            <td style="
                                width: 227pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 5pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option1 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option1" value="option1">
                                    <span class="s9">Issue of Duplicate certificate</span>
                                </p>
                            </td>
                            <td style="
                                width: 224pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 28pt; padding-right: 4pt; text-indent: -21pt; line-height: 19pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option2 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option2" value="option2">
                                    <span class="s9">Claim from Unclaimed Suspense Account</span>
                                </p>
                            </td>
                        </tr>
                        <tr style="height: 40pt;">
                            <td style="
                                width: 227pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 27pt; text-indent: -22pt; line-height: 19pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option3 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option3" value="option3">
                                    <span class="s13">Replacement </span><span class="s9">/ Renewal / Exchange of securities certificate</span>
                                </p>
                            </td>
                            <td style="
                                width: 224pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 5pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option4 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option4" value="option4">
                                    <span class="s9">Endorsement</span>
                                </p>
                            </td>
                        </tr>
                        <tr style="height: 40pt;">
                            <td style="
                                width: 227pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 27pt; text-indent: -22pt; line-height: 19pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option5 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option5" value="option5">
                                    <span class="s9">Sub-division / Splitting of securities certificate</span>
                                </p>
                            </td>
                            <td style="
                                width: 224pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 5pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option6 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option6" value="option6">
                                    <span class="s9">Consolidation of Folios</span>
                                </p>
                            </td>
                        </tr>
                        <tr style="height: 25pt;">
                            <td style="
                                width: 227pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 5pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option7 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option7" value="option7">
                                    <span class="s9">Consolidation of Securities certificate</span>
                                </p>
                            </td>
                            <td style="
                                width: 224pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 6pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option8 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option8" value="option8">
                                    <span class="s9">Transmission</span>
                                </p>
                            </td>
                        </tr>
                        <tr style="height: 26pt;">
                            <td style="
                                width: 451pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            "
                                colspan="2">
                                <p class="s12" style="padding-left: 5pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option9 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option9" value="option9">
                                    <span class="s9">Transposition </span><span class="s14">(Mention the new order of holders here)</span> <span class="s9">@* {{data.firstHolder}} &amp; {{data.secondHolder}} &amp; {{data.thirdHolder}} *@</span>
                                </p>
                            </td>
                        </tr>
                        <tr style="height: 26pt;">
                            <td style="
                                width: 451pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            "
                                colspan="2">
                                <p class="s12" style="padding-left: 5pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option10 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option10" value="option10">
                                    <span class="s9">Claim from Suspense Escrow Demat Account </span> <span class="s9">@* {{data.firstHolder}} &amp; {{data.secondHolder}} &amp; {{data.thirdHolder}} *@</span>
                                </p>
                            </td>
                        </tr>
                    </table>
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </li>
                <li data-list-text="C.">
                    <h3 style="padding-left: 71pt; text-indent: -28pt; text-align: left;">I / We are enclosing certificate(s) as detailed below**:</h3>
                    <table style="border-collapse: collapse; margin-left: 48.924pt;" cellspacing="0">
                        <tr style="height: 22pt;">
                            <td style="
                                width: 164pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">Name of the Issuer Company</p>
                            </td>
                            <td style="
                                width: 281pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p style="text-indent: 0pt; text-align: left;">{{data.companyName}} </p>
                            </td>
                        </tr>
                        <tr style="height: 22pt;">
                            <td style="
                                width: 164pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">Folio Number</p>
                            </td>
                            <td style="
                                width: 281pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p style="text-indent: 0pt; text-align: left;">{{data.folioNo}}</p>
                            </td>
                        </tr>
                        <tr style="height: 66pt;">
                            <td style="
                                width: 164pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">Name(s) of the security holder(s) as per the certificate(s)</p>
                                @* <p class="s9" style="padding-left: 5pt; padding-right: 4pt; text-indent: 0pt; line-height: 22pt; text-align: left;"></p> *@
                            </td>
                            <td style="
                                width: 281pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <span ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
                                    <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">1. {{data.firstHolder}} </p>
                                    <p class="s9" style="padding-top: 7pt; padding-left: 5pt; text-indent: 0pt; text-align: left;">2. {{data.secondHolder}}</p>
                                    <p class="s9" style="padding-top: 7pt; padding-left: 5pt; text-indent: 0pt; text-align: left;">3. {{data.thirdHolder}}</p>
                                </span>
                                <span ng-show="data.condition" ng-class="{'hide-print': !data.condition}" ng-repeat="h in data.heirs">
                                    <p class="s9" style="padding-top: 7pt; padding-left: 5pt; text-indent: 0pt; text-align: left;">{{$index + 1}}. {{h.name}}</p>
                                </span>
                            </td>
                        </tr>
                        <tr style="height: 44pt;">
                            <td style="
                                width: 164pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">Number &amp; Face value of securities</p>

                            </td>
                            <td style="
                                width: 281pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p style="text-indent: 0pt; text-align: left;">{{data.qty}} &amp; &#8377 {{data.faceValue}}</p>
                            </td>
                        </tr>
                        <!--<tr style="height: 15pt;">
                            <td style="
                                        width: 164pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                                <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Certificate numbers</p>
                            </td>
                            <td style="
                                        width: 281pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                                        <p style="text-indent: 0pt; text-align: left;">{{data.certificatenos}}</p>
                            </td>
                                </tr>-->
                    </table>
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                    <!--<table style="border-collapse: collapse; margin-left: 48.924pt;" cellspacing="0">
                        <tr style="height: 15pt;">
                            <td style="
                                        width: 164pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                                <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Distinctive numbers</p>
                            </td>
                            <td style="
                                        width: 281pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                                        <p style="text-indent: 0pt; text-align: left;">{{data.distinctiveNosStart}} - {{data.distinctiveNosEnd}}</p>
                            </td>
                        </tr>
                        <tr style="height: 44pt;">
                            <td style="
                                        width: 164pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                                    <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">Number &amp; Face value of securities</p>

                            </td>
                            <td style="
                                        width: 281pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                                        <p style="text-indent: 0pt; text-align: left;">{{data.qty}} &amp; &#8377 {{data.faceValue}}</p>
                            </td>
                        </tr>
                            </table>-->
                    <table class="myTable " ng-show="!(shares.length === 1 && shares[0].certificateNo == 0)">
                        <tr>
                            <td>
                                <p class="bold">Certificate No.**</p>
                            </td>
                            <td>
                                <p class="bold">Distinctive No.**</p>
                            </td>
                            <td>
                                <p class="bold">No. and Face value of</p>
                                <p class="bold">securities held</p>
                            </td>
                        </tr>
                        <tr ng-repeat="tmp in shares">
                            <td>{{tmp.certificateNo}}</td>
                            <td>{{tmp.distinctiveNosFrom}} - {{tmp.distinctiveNosTo}}</td>
                            <td>{{tmp.actualQty}} shares, FV:  {{data.faceValue}}</td>
                        </tr>
                    </table>
                    <p style="padding-left: 43pt; text-indent: 0pt; text-align: left;">** Wherever applicable / whichever details are available</p>
                </li>
                <li data-list-text="D.">
                    <h3 style="padding-top: 14pt; padding-left: 71pt; text-indent: -28pt; line-height: 10pt; text-align: left;">Document / details required for specific service request:</h3>
                    <ul id="l3">
                        <li data-list-text="">
                            <p class="s15" style="padding-left: 78pt; text-indent: -23pt; line-height: 16pt; text-align: left;">
                                i)<span ng-if="isPrint" class="s8" ng-bind="doclist.option1 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option1" value="option1"> <span class="p">Duplicate securities certificate</span>
                            </p>
                            @* <p style="text-indent: 0pt; text-align: left;"><br /></p> *@
                        </li>
                        <li data-list-text="">
                            <p class="s15" style="padding-left: 78pt; text-indent: -27pt; text-align: left;">
                                ii)<span ng-if="isPrint" class="s8" ng-bind="doclist.option2 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option2" value="option2"> <span class="p">Claim from Unclaimed Suspense Account</span>
                            </p>
                            @* <p style="padding-top: 4pt; text-indent: 0pt; text-align: left;"><br /></p> *@
                            <table style="border-collapse: collapse; margin-left: 92.705pt;" cellspacing="0">
                                <tr style="height: 35pt;">
                                    <td style="
                                        width: 170pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                                        <p class="s9" style="padding-top: 2pt; padding-left: 2pt; text-indent: 0pt; text-align: left;">Securities claimed</p>
                                    </td>
                                    <td style="
                                        width: 232pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                                        <p class="s9" style="padding-top: 2pt; padding-left: 100pt; padding-right: 2pt; text-indent: -13pt; text-align: right;">{{data.unclaimedqty}} (in numbers) <br /> <span number-to-words="data.unclaimedqty"></span> (in words)</p>
                                    </td>
                                </tr>
                            </table>
                        </li>
                        <li data-list-text="">
                            <p class="s15" style="padding-top: 13pt; padding-left: 78pt; text-indent: -30pt; text-align: left;">
                                iii)<span ng-if="isPrint" class="s8" ng-bind="doclist.option3 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option3" value="option3"> <span class="p">Replacement / Renewal / Exchange of securities certificate</span>
                            </p>
                            <p style="padding-top: 2pt; padding-left: 92pt; text-indent: 0pt; text-align: left;">(that is defaced, mutilated, torn, decrepit, worn out or where the page on the reverse is fully utilized)</p>
                        </li>
                        <li data-list-text="">
                            <p class="s15" style="padding-left: 78pt; text-indent: -30pt; line-height: 15pt; text-align: left;">
                                iv) <span ng-if="isPrint" class="s8" ng-bind="doclist.option4 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option4" value="option4"><span class="p">Endorsement</span>
                            </p>
                        </li>
                        <li data-list-text="">
                            <p class="s15" style="padding-left: 78pt; text-indent: -27pt; text-align: left;">
                                v)<span ng-if="isPrint" class="s8" ng-bind="doclist.option5 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option5" value="option5"> <span class="p">Sub-division / Splitting of securities certificate</span>
                            </p>
                        </li>
                        <li data-list-text="">
                            <p class="s15" style="padding-top: 1pt; padding-left: 78pt; text-indent: -30pt; text-align: left;">
                                vi)<span ng-if="isPrint" class="s8" ng-bind="doclist.option6 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option6" value="option6"> <span class="p">Consolidation of securities certificate/Folios</span>
                            </p>
                        </li>
                        <li data-list-text="">
                            <p class="s15" style="padding-top: 1pt; padding-left: 78pt; text-indent: -33pt; text-align: left;">
                                vii)<span ng-if="isPrint" class="s8" ng-bind="doclist.option7 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option7" value="option7"><span class="p">Transmission</span>
                            </p>
                        </li>
                        <li data-list-text="">
                            <p class="s15" style="padding-top: 1pt;padding-left: 78pt; text-indent: -36pt; text-align: left;">

                                viii)<span ng-if="isPrint" class="s8" ng-bind="doclist.option8 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option8" value="option8"><span class="p">
                                    Transposition
                                </span>
                            </p>
                        </li>
                        <li data-list-text="">
                            <p class="s15" style="padding-top: 1pt;padding-left: 78pt; text-indent: -36pt; text-align: left;">

                                ix)<span ng-if="isPrint" class="s8" ng-bind="doclist.option9 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option9" value="option9">  <span class="p">
                                    Claim from Suspense Escrow Demat Account
                                </span>
                            </p>
                        </li>
                    </ul>
                </li>
            </ol>
            <table style="border-collapse: collapse; margin-left: 92.705pt;" cellspacing="0">
                <tr style="height: 35pt;">
                    <td style="
                                        width: 170pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                        <p class="s9" style="padding-top: 2pt; padding-left: 2pt; text-indent: 0pt; text-align: left;">Securities claimed</p>
                    </td>
                    <td style="
                                        width: 232pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                        <p class="s9" style="padding-top: 2pt; padding-left: 100pt; padding-right: 2pt; text-indent: -13pt; text-align: right;">{{data.suspenseqty}} (in numbers) <br /> <span number-to-words="data.suspenseqty"></span> (in words)</p>
                    </td>
                </tr>
            </table>
            @* <p style="padding-top: 2pt; text-indent: 0pt; text-align: left;"><br /></p> *@
            <p class="s16" style="padding-left: 50pt; text-indent: 0pt; text-align: left;">Provide / attach original securities certificate(s) <u>for request for item numbers III to VIII above.</u></p>
            <p style="padding-top: 1pt; text-indent: 0pt; text-align: left;"><br /></p>
            <h3 style="padding-left: 43pt; text-indent: 0pt; line-height: 107%; text-align: left;">Declaration<span class="p">: All the above facts stated are true and correct to best of my / our knowledge and belief.</span></h3>
            <div ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
                <table style="border-collapse: collapse; margin-left: 6.05pt;" cellspacing="0">
                    <tr style="height: 15pt;">
                        <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p style="text-indent: 0pt; text-align: left;"><br /></p>
                        </td>
                        <td style="
                        width: 191pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s18" style="padding-left: 25pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Security Holder 1 / Claimant</p>
                        </td>
                        <td style="
                        width: 143pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s18" style="padding-left: 28pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Security Holder 2</p>
                        </td>
                        <td style="
                        width: 107pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s18" style="padding-left: 10pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Security Holder 3</p>
                        </td>
                    </tr>
                    <tr style="height: 45pt;">
                        <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s13" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Signature</p>
                        </td>
                        <td style="
                        width: 191pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>
                        </td>
                        <td style="
                        width: 143pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>
                        </td>
                        <td style="
                        width: 107pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>
                        </td>
                    </tr>
                    <tr style="height: 21pt;">
                        <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s13" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Name</p>
                        </td>
                        <td style="
                        width: 191pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p><span ng-style="{'color': data.firstAlive ? 'red' : 'inherit'}">{{data.firstHolder}}</span>
                        </td>
                        <td style="
                        width: 143pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p><span ng-style="{'color': data.secondAlive ? 'red' : 'inherit'}">{{data.secondHolder}}</span>
                        </td>
                        <td style="
                        width: 107pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p><span ng-style="{'color': data.thirdAlive ? 'red' : 'inherit'}">{{data.thirdHolder}}</span>
                        </td>
                    </tr>
                    <tr style="height: 42pt;">
                        <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s13" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Full address</p>
                        </td>
                        <td style="
                        width: 191pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.firstHolderaddress}}
                        </td>
                        <td style="
                        width: 143pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.secondHolderaddress}}
                        </td>
                        <td style="
                        width: 107pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.thirdHolderaddress}}
                        </td>
                    </tr>
                    <tr style="height: 14pt;">
                        <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s13" style="padding-left: 5pt; text-indent: 0pt; line-height: 13pt; text-align: left;">PIN</p>
                        </td>
                        <td style="
                        width: 191pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.firstHolderpincode}}
                        </td>
                        <td style="
                        width: 143pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.secondHolderpincode}}
                        </td>
                        <td style="
                        width: 107pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.thirdHolderpincode}}
                        </td>
                    </tr>
                </table>
            </div>
            <div ng-show="data.condition" ng-class="{'hide-print': !data.condition}">
                <table style="border-collapse: collapse; margin-left: 6.05pt;" cellspacing="0">
                    <tr style="height: 15pt;">
                        <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p style="text-indent: 0pt; text-align: left;"><br /></p>
                        </td>
                        <td style="
                        width: 185pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s10" style="text-indent: 0pt; line-height: 14pt; text-align: center;">Holder 1</p>
                        </td>
                        <td style="
                        width: 163pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s10" style="text-indent: 0pt; line-height: 14pt; text-align: center;">Holder 2</p>
                        </td>
                        <td style="
                        width: 93pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s10" style="padding-left: 24pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Holder 3</p>
                        </td>
                    </tr>
                    <tr style="height: 45pt;">
                        <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s11" style="padding-left: 5pt; text-indent: 0pt; text-align: left;">Signature</p>
                        </td>
                        <td style="
                        width: 185pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s17" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>
                        </td>
                        <td style="
                        width: 163pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p style="text-indent: 0pt; text-align: left;"><br /></p>
                        </td>
                        <td style="
                        width: 93pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p style="text-indent: 0pt; text-align: left;"><br /></p>
                        </td>
                    </tr>
                    <tr style="height: 21pt;">
                        <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s11" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Name</p>
                        </td>
                        <td style="
                        width: 185pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s17" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p><span ng-style="{'color': data.heirs[0].dateOfDeath ? 'red' : 'inherit'}">{{data.heirs[0].name}}</span>
                        </td>
                        <td style="
                        width: 163pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p style="text-indent: 0pt; text-align: left;"><br /></p><span ng-style="{'color': data.heirs[1].dateOfDeath ? 'red' : 'inherit'}">{{data.heirs[1].name}}</span>
                        </td>
                        <td style="
                        width: 93pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p style="text-indent: 0pt; text-align: left;"><br /></p><span ng-style="{'color': data.heirs[2].dateOfDeath ? 'red' : 'inherit'}">{{data.heirs[2].name}}</span>
                        </td>
                    </tr>
                    <tr style="height: 56pt;">
                        <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s11" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Full address</p>
                        </td>
                        <td style="
                        width: 185pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s17" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.heirs[0].address}}
                        </td>
                        <td style="
                        width: 163pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p style="text-indent: 0pt; text-align: left;"><br /></p>{{data.heirs[1].address}}
                        </td>
                        <td style="
                        width: 93pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p style="text-indent: 0pt; text-align: left;"><br /></p>{{data.heirs[2].address}}
                        </td>
                    </tr>
                    <tr style="height: 14pt;">
                        <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p class="s11" style="padding-left: 5pt; text-indent: 0pt; line-height: 13pt; text-align: left;">PIN</p>
                        </td>
                        <td style="
                        width: 185pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p style="text-indent: 0pt; text-align: left;"><br /></p>{{data.heirs[0].pincode}}
                        </td>
                        <td style="
                        width: 163pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p style="text-indent: 0pt; text-align: left;"><br /></p>{{data.heirs[1].pincode}}
                        </td>
                        <td style="
                        width: 93pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                            <p style="text-indent: 0pt; text-align: left;"><br /></p>{{data.heirs[2].pincode}}
                        </td>
                    </tr>
                </table>
                <p style="padding-left: 43pt; text-indent: 0pt; text-align: justify;">

                    After processing the service request, the RTA shall issue a ‘Letter of Confirmation’ to the securities holder/claimant, which is valid only for 120 days. Using this ‘Letter of Confirmation’, the securities holder/claimant shall request the DP to dematerialize the securities, failing which the securities shall be credited to the Suspense Escrow Demat Account of the Company.

                </p>
            </div>
        </div>
        <!-- Submit Button -->
        <div class="col-md-4 text-center mt-4">
            <button ng-if="hDiv" type="submit" ng-disabled="processdone" class="btn btn-primary px-4" style="background-color:#51b37f; color:white; border-radius: 5px;">
                Generate Form
            </button>
        </div>
    </form>
    <div class="myarea">
        <button class="btn btn-store mybtn" ng-show="isPrint" ng-click="printDiv('printForm')">PRINT</button>
    </div>
</body>
<script>
        angular.module('Stock-CMS', []).directive('numberToWords', function () {
        return {
            restrict: 'A',
            scope: {
                numberToWords: '='
            },
            link: function (scope, element) {
                scope.$watch('numberToWords', function (newVal) {
                    let num = Number(newVal);
                    if (isNaN(num) || num === 0) {
                        element.text('');
                        return;
                    }

                    const ones = ["", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten",
                        "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"];
                    const tens = ["", "", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"];

                    const getWords = (n) => {
                        if (n < 20) return ones[n];
                        return tens[Math.floor(n / 10)] + (n % 10 ? " " + ones[n % 10] : "");
                    };

                    const segments = [
                        { divider: 10000000, name: "Crore" },
                        { divider: 100000, name: "Lakh" },
                        { divider: 1000, name: "Thousand" },
                        { divider: 100, name: "Hundred" },
                    ];

                    let result = '';
                    for (let i = 0; i < segments.length; i++) {
                        let seg = Math.floor(num / segments[i].divider);
                        if (seg > 0) {
                            result += getWords(seg) + " " + segments[i].name + " ";
                            num %= segments[i].divider;
                        }
                    }

                    if (num > 0) {
                        result += getWords(num);
                    }

                    element.text(result.trim());
                });
            }
        };
    }).controller('FormController', function ($scope, $http,$timeout) {
        $scope.customers = [];
        $scope.data = undefined;
              $scope.hDiv = true;
              var params = new URLSearchParams(window.location.search);
              var id = params.get('id');
              var id2 = params.get('id2');
                $scope.requests = {
                    option1: false,
                    option2: false,
                    option3: false,
                    option4: false,
                    option5: false,
                    option6: false,
                    option7: false,
                    option8: false,
                    option9: false,
                    option10: false,
                };
                $scope.doclist = {
                    option1: false,
                    option2: false,
                    option3: false,
                    option4: false,
                    option5: false,
                    option6: false,
                    option7: false,
                    option8: false,
                    option9: false,
                };

              $scope.isPrint = id2 ? true : false
        var isProcessing = false;
        $scope.processdone = false;
        $scope.unclaimed = 0

        // showLoader();

         // Load Customers
         $scope.loadCustomers = function (sid,hid) {
             if(id){
                 hideLoader();
                $scope.hDiv = true;
                $http.get('/Enquiry/GetStocksById/'+id).then(function (response) {
                    var result = response.data;
                    $http.get('/Form/GetHolderByStockId/' +  id).then(function (response) {
                        $scope.docs = response.data;
                        var doc = $scope.docs.find(x => x.id === sid);

                         var isDeceased = !!doc?.dateOfDeath;

                if (isDeceased) {
                    $scope.heirId = null;
    $scope.legalheirlist = isDeceased;
    document.getElementById('heirId').value = '';
                    $http.get('/LegalHeir/GetClaimentLegalHeir/' + doc.id).then(function (response) {
                        $scope.heir = response.data;
                        var heirs = response.data.find(x => x.id === hid); // `hid` needs to be in scope
                        var holder = heirs;

                        populateData(holder, result,$scope.heir,isDeceased);
                    }, function (error) {
                        console.error('Error loading legal heir data:', error);
                        hideLoader();
                    });
                } else {
                    $scope.heirId = null;
    $scope.data = null;
    $scope.legalheirlist = isDeceased;
    document.getElementById('heirId').value = '';
                    var holder = doc;
                    populateData(holder, result,$scope.heir,isDeceased);
                }

                    hideLoader();
                    }, function (error) {
                    console.error('Error loading Docs:', error);
                    hideLoader();
                    });
                }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
                });
            }

            if(id2){
                 $scope.hDiv = false;
            $http.get('/Form/GetGenratedFormById/'+id2).then(function (response) {
                var result = response.data;
                var obj = JSON.parse(result.jsonString);
                $scope.data = {
                    docid: obj.docid,
                    customerName: obj.customerName,
                    today: new Date(obj.today),
                    dpid: obj.dpid,
                    clientid: obj.clientid,
                    firstHolderpan: obj.firstHolderpan,
                    secondHolderpan: obj.secondHolderpan,
                    thirdHolderpan: obj.thirdHolderpan,
                    legelheirpan: obj.legelheirpan,
                    requestlist:JSON.parse(obj.requestlist),
                    companyName: obj.companyName,
                    folioNo: obj.folioNo,
                    jsondata: obj.jsondata,
                    firstHolder:obj.firstHolder,
                    secondHolder:obj.secondHolder,
                    thirdHolder:obj.thirdHolder,
                    certificatenos: obj.certificatenos,
                    distinctiveNosStart: obj.distinctiveNosStart,
                    distinctiveNosEnd: obj.distinctiveNosEnd,
                    qty: obj.qty,
                    rate: obj.rate,
                    docattach: JSON.parse(obj.docattach),
                    qtyinwords: obj.qtyinwords,
                    firstHolderaddress:obj.firstHolderaddress,
                    secondHolderaddress:obj.secondHolderaddress,
                    thirdHolderaddress:obj.thirdHolderaddress,
                        firstHolderpincode: obj.firstHolderpincode,
                    secondHolderpincode: obj.secondHolderpincode,
                    thirdHolderpincode: obj.thirdHolderpincode,
                    firstAlive: obj.firstAlive,
                    secondAlive: obj.secondAlive,
                    thirdAlive: obj.thirdAlive,
                    faceValue: obj.faceValue,
                    unclaimedqty: obj.unclaimedqty,
                    condition: obj.condition,
                    heirs: obj.heirs,
						suspenseqty: obj.suspenseqty,
                        qtyinwords1: obj.qtyinwords1,

                };
                $scope.shares = JSON.parse($scope.data.jsondata);
                    $scope.requests = $scope.data.requestlist;
                $scope.doclist = $scope.data.docattach;
                id = result.stockId;
                checkData();
                hideLoader();
            }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
            });
            }

            function populateData(holder, result, heirlist,isDeceased) {
                 $scope.data = {
                            docid: holder.id,
                            customerName : holder.nameAsPerAadhar,
                            today: new Date(),
                            dpid: holder.dpid,
                            clientid: holder.clientId,
                            firstHolderpan: result.firstHolderData ? result.firstHolderData.pan : '',
                            secondHolderpan: result.secondHolderData ? result.secondHolderData.pan : '',
                            thirdHolderpan: result.thirdHolderData ? result.thirdHolderData.pan : '',
                            legelheirpan: holder.pan,
                            companyName: result.companyName,
                            folioNo: result.folioNo,
                            firstHolder :result.firstHolderName,
                            secondHolder:result.secondHolderName,
                            thirdHolder: result.thirdHolderName,
                            certificatenos: $scope.data && $scope.data.certificatenos || '',
                            distinctiveNosStart:  $scope.data && $scope.data.distinctiveNosStart || '',
                            distinctiveNosEnd: $scope.data && $scope.data.distinctiveNosEnd || '',
                            qty: result.qty,
                            rate: result.rate,
                            unclaimedqty: $scope.data && $scope.data.unclaimedqty || '',
                            suspenseqty: $scope.data && $scope.data.suspenseqty || '',
                            qtyinwords: $scope.numberToWords($scope.data && $scope.data.unclaimedqty || ''),
                            qtyinwords1: $scope.numberToWords($scope.data && $scope.data.suspenseqty || ''),
                            firstHolderaddress: result.firstHolderData.addressAsPerAadhar,
                            secondHolderaddress: result.secondHolderData ? result.secondHolderData.addressAsPerAadhar : '',
                            thirdHolderaddress: result.thirdHolderData ? result.thirdHolderData.addressAsPerAadhar : '',
                            firstHolderpincode: result.firstHolderData ? result.firstHolderData.pinCode : '',
                            secondHolderpincode: result.secondHolderData ? result.secondHolderData.pinCode : '',
                            thirdHolderpincode: result.thirdHolderData ? result.thirdHolderData.pinCode : '',
                            firstAlive: result?.firstHolderData?.dateOfDeath,
                            secondAlive: result?.secondHolderData?.dateOfDeath,
                            thirdAlive: result?.thirdHolderData?.dateOfDeath,
                            faceValue: result.faceValue,
                             jsondata: result.stockJson,
                             condition: isDeceased,
                             heirs: isDeceased ? heirlist.map(h => ({ name: h.name, address: h.addressAsPerAadhar, pincode: h.pinCode, pan: h.pan, dateOfDeath: h.dateOfDeath })) : [],
                        };
                         $scope.shares = JSON.parse($scope.data.jsondata);
            }
        };

    function checkData() {
        if ($scope.data !== undefined) {
            // Delay the printDiv execution until the next digest cycle
            $timeout(function() {
                $scope.printDiv('printForm');
            }, 0);  // 0 delay to ensure it runs after the view update
        } else {
            setTimeout(checkData, 1000); // Retry after 1000ms if data is not yet available
        }
    }

     $scope.navtogenerateform = function () {
        window.open('/Form/GenerateForm/'+id, '_self');
    };

     $scope.numberToWords = function(num) {
        var ones = ["", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten", "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"];
        var tens = ["", "", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"];
        var units = ["", "Hundred", "Thousand", "Lakh", "Crore"];  // Adjusted for Indian system

        // Helper function to convert numbers less than 1000
        function convertToWords(num) {
            if (num === 0) return "Zero";
            var words = "";

            // Process hundreds
            if (Math.floor(num / 100) > 0) {
                words += ones[Math.floor(num / 100)] + " Hundred ";
                num %= 100;
            }

            // Process tens and ones
            if (num > 0) {
                if (num < 20) {
                    words += ones[num];
                } else {
                    words += tens[Math.floor(num / 10)];
                    if (num % 10 > 0) {
                        words += " " + ones[num % 10];
                    }
                }
            }

            return words.trim();
        }

        // Main function to convert numbers to words with appropriate units (Thousand, Lakh, Crore)
        if (num === 0) return "Zero";

        var result = '';
        var i = 0;

        // Process lakhs, thousands, and hundreds
        while (num > 0) {
            if (num % 1000 !== 0) {
                result = convertToWords(num % 1000) + " " + units[i] + " " + result;
            }
            num = Math.floor(num / 1000);
            i++;
        }

        return result.trim();
    };

        //Genrate Form
         $scope.genrateForm = function () {
             if(id){
                 $scope.processdone = true;
                 if($scope.data.jsondata == undefined){
                     Swal.fire({
                            title: 'Error!',
                            text:  'Please Enter Stock Qty data in Custome\'s Stock Page',
                            icon: 'error',
                            confirmButtonText: 'Try Again'
                        });
                        $scope.processdone = false;
                return;
                 }
            var arr = angular.copy($scope.requests);
            $scope.data.requestlist = JSON.stringify(arr,null,2);

             var arr1 = angular.copy($scope.doclist);
             $scope.data.docattach= JSON.stringify(arr1,null,2);

             let jsonString = JSON.stringify($scope.data, null, 2);
             var data ={
                 formName : 'Form ISR 4',
                 StockId : id,
                 url : `/Form/FormISR4?id2=`,
                 jsonString : jsonString,
                 ClientName: $scope.data.customerName,
                  ClientId: $scope.data.docid,
                 IsActive : true
             }

             const url = '/Form/GenrateForm';
                $http.post(url, data).then(function (response) {
                    if (response.data.success) {
                        Swal.fire({
                            title: 'Success',
                            text: response.data.message || 'Operation successful!',
                            icon: 'success',
                            confirmButtonText: 'OK'
                        });
                        $scope.processdone = false;
                        // $scope.loadCustomers();
                        window.open(response.data.data.url + response.data.data.id,'_self')
                    } else {
                        Swal.fire({
                         title: 'This Form is already Exits',
                         text: "do you want to go to that form?",
                         icon: 'warning',
                         showCancelButton: true,
                         confirmButtonText: 'Yes',
                         cancelButtonText: 'No'
                     }).then((result) => {
                         if (result.isConfirmed) {
                             window.open(response.data.message, '_self');
                         }
                 });
                 $scope.processdone = false;
                    }
                    isProcessing = false;
                }, function (error) {
                    Swal.fire({
                        title: 'Error',
                        text: 'An error occurred.',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                    $scope.processdone = false;
                    isProcessing = false;
                });
            //console.log(dataString);
            }
         }

        // Load Customers
        // $scope.loadCustomers = function () {
        //     $http.get('/Master/GetCustomers').then(function (response) {
        //         $scope.customers = response.data[0];
        //         hideLoader();
        //     }, function (error) {
        //         console.error('Error loading customers:', error);
        //         hideLoader();
        //     });
        // };

        // $scope.loadDocs = function () {
        //     if (true) {
        //         $http.get('/doc/getDocs/' + 1).then(function (response) {
        //             $scope.docs = response.data;
        //             hideLoader();
        //         }, function (error) {
        //             console.error('Error loading Docs:', error);
        //             hideLoader();
        //         });
        //     }
        // };

        $scope.navtogenerateform = function () {
        window.open('/Form/GenerateForm/'+id, '_self');
    };

        //Function
        $scope.printDiv = function (divId) {
                    var css ='<style type="text/css"> *{margin:0;padding:0;text-indent:0}h1{margin-bottom:0px;color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:18pt}.s1{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:10pt}h2{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:15pt}h3{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:12pt;margin-bottom:0px}.p,p{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt;margin:0pt}.s4{color:black;font-family:Wingdings;font-style:normal;font-weight:normal;text-decoration:none;font-size:14pt}.a{color:#0462c1;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:underline;font-size:12pt}.s7{color:#0462c1;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:underline;font-size:12pt}.s8{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:11pt}.s9{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}.s11{color:black;font-family:"Times New Roman",serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:14pt}.s12{color:black;font-family:Cambria,serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:20pt}.s13{color:black;font-family:"Times New Roman",serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}.s14{color:black;font-family:Calibri,sans-serif;font-style:italic;font-weight:normal;text-decoration:none;font-size:12pt}.s15{color:black;font-family:Cambria,serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:14pt}.s16{color:black;font-family:Calibri,sans-serif;font-style:italic;font-weight:normal;text-decoration:none;font-size:12pt}.s18{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:12pt}.s19{color:black;font-family:"Bookshelf Symbol 7";font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}li{display:block}#l1{padding-left:0pt;counter-reset:c1 1}#l1>li>*:first-child:before{counter-increment:c1;content:counter(c1,upper-latin)". ";color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:12pt}#l1>li:first-child>*:first-child:before{counter-increment:c1 0}#l2{padding-left:0pt}#l2>li>*:first-child:before{color:black;font-family:Symbol,serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}#l3{padding-left:0pt}#l3>li>*:first-child:before{color:black;font-family:Symbol,serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}table,tbody{vertical-align:top;overflow:visible}.ng-hide{display:none} .myTable { border-collapse: collapse;margin-left: 56px;min-width: 650px;}.myTable td {border: 1px solid #babdbf;padding: 3pt;}.myTable tr:first-child td {font-weight: bold;}.myTable td:nth-child(1) {width: 104pt;}.myTable td:nth-child(2) {width: 108pt;}.myTable td:nth-child(3) {width: 99pt;}.myTable td:nth-child(4) {width: 71pt;}.myTable td:nth-child(5) {width: 95pt;}.myTable p {margin: 0;text-align: left;}.myTable td:nth-child(3) p {padding-right: 36pt;}.myTable p {line-height: 114%;} @@media print {.hide-print {display: none !important;}}</style>';
            var innerContents = document.getElementById(divId).innerHTML;
            var popupWinindow = window.open('', '_blank', 'width=600,height=700,scrollbars=no,menubar=no,toolbar=no,location=no,status=no,titlebar=no');
            popupWinindow.document.open();
            popupWinindow.document.write('<html><head><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">' + css + '</ head > <body style="padding-left: 0 5% 0 5%;" onload="window.print()">' + innerContents + '</html>');
            popupWinindow.document.close();
        };
        //Initialize
        $scope.loadCustomers();
        // $scope.loadDocs();
    });
</script>

</html>
