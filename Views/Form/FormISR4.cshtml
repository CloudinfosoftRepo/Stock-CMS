<html lang="en" ng-app="Stock-CMS">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Form ISR 4</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        h1 {
            color: black;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 18pt;
        }

        .s1 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 10pt;
        }

        h2 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 15pt;
        }

        h3 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 12pt;
        }

        .p,
        p {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
            margin: 0pt;
        }

        .s4 {
            color: black;
            font-family: Wingdings;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 14pt;
        }

        .a {
            color: #0462c1;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: underline;
            font-size: 12pt;
        }

        .s7 {
            color: #0462c1;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: underline;
            font-size: 12pt;
        }

        .s8 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 11pt;
        }

        .s9 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        .s11 {
            color: black;
            font-family: "Times New Roman", serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 14pt;
        }

        .s12 {
            color: black;
            font-family: Cambria, serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 20pt;
        }

        .s13 {
            color: black;
            font-family: "Times New Roman", serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        .s14 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: italic;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        .s15 {
            color: black;
            font-family: Cambria, serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 14pt;
        }

        .s16 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: italic;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        .s18 {
            color: black;
            font-family: Calibri, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 12pt;
        }

        .s19 {
            color: black;
            font-family: "Bookshelf Symbol 7";
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        li {
            display: block;
        }

        #l1 {
            padding-left: 0pt;
            counter-reset: c1 1;
        }

            #l1 > li > *:first-child:before {
                counter-increment: c1;
                /* content: counter(c1, upper-latin) ". "; */
                color: black;
                font-family: Arial, sans-serif;
                font-style: normal;
                font-weight: bold;
                text-decoration: none;
                font-size: 12pt;
            }

            #l1 > li:first-child > *:first-child:before {
                counter-increment: c1 0;
            }

        #l2 {
            padding-left: 0pt;
        }

            #l2 > li > *:first-child:before {
                /* content: " "; */
                color: black;
                font-family: Symbol, serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 12pt;
            }

        #l3 {
            padding-left: 0pt;
        }

            #l3 > li > *:first-child:before {
                /* content: " "; */
                color: black;
                font-family: Symbol, serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 12pt;
            }

        table,
        tbody {
            vertical-align: top;
            overflow: visible;
        }
    </style>
</head>
<body style="padding-left: 5%;" ng-controller="FormController">
    <div class="row align-items-center">
        <!-- Arrow Icon aligned to the left -->
        <a class="col-md-1 text-start" style="font-size:35px;" ng-click="navtogenerateform()">
            <i class="bi bi-arrow-left"></i>
        </a>

        <!-- Centered Heading -->
        <div class="col-md-10 text-center">
            <h3>Form ISR 4</h3>
        </div>
    </div>

    <form name="gForm" ng-submit="genrateForm()">
    <div ng-if="hDiv">
        
            <div class="row">
                @* <div class="col-md-12"> *@
                <div class="form-group mb-3 col-md-3">
                    <label for="seletedId" class="form-label">select customer</label>
                    <select class="form-select w-auto" ng-options="f.id as f.name for f in docs" ng-model="seletedId" ng-change="loadCustomers(seletedId)">
                        <option selected disabled value="">Select customer</option>
                    </select>
                </div>
                <div class="form-group mb-3  col-md-3">
                    <label for="certificatenos" class="form-label">Certificate Nos</label>
                    <input type="text" ng-model="data.certificatenos" class="form-control search-orders" placeholder="Certificate Nos">
                </div>
                <div class="form-group mb-3  col-md-3">
                    <label for="distinctiveNosStart" class="form-label">Distinctive Nos Start</label>
                    <input type="text" ng-model="data.distinctiveNosStart" class="form-control search-orders" placeholder="Distinctive Nos Start">
                </div>
                <div class="form-group mb-3  col-md-3">
                    <label for="distinctiveNosEnd" class="form-label">Distinctive Nos End</label>
                    <input type="text" ng-model="data.distinctiveNosEnd" class="form-control search-orders" placeholder="Distinctive Nos End">
                </div>
                @* </div> *@
                <div class="text-center m-2 col-md-4">
                    <button type="submit" class="btn" style="background-color:#003980; color:white;">
                        Genrate Form
                    </button>
                </div>
            </div>
       
    </div>
    <div id="printForm">
    <h1 style="padding-top: 3pt; padding-left: 42pt; text-indent: 0pt; text-align: center;">Form ISR-4</h1>
    <p class="s1" style="padding-top: 1pt; padding-left: 42pt; text-indent: 0pt; line-height: 114%; text-align: center;">
        (see circular No. SEBI/HO/MIRSD/MIRSD_RTAMB/P/CIR/2022/8 dated January 25, 2022 on Issuance of Securities in dematerialized form in case of Investor Service Requests)
    </p>
    <h2 style="padding-left: 42pt; text-indent: 0pt; line-height: 18pt; text-align: center;">Request for issue of Duplicate Certificate and other Service Requests</h2>
    <p class="s1" style="padding-top: 1pt; padding-left: 42pt; text-indent: 0pt; text-align: center;">(for Securities - Shares / Debentures / Bonds, etc., held in physical form)</p>
    <p style="padding-top: 2pt; text-indent: 0pt; text-align: left;"><br /></p>
    <p class="s1" style="text-indent: 0pt; line-height: 12pt; text-align: right;">
        <b>Date:</b><u>{{data.today | date:'dd/MM/yyyy'}}</u>
    </p>
    <ol id="l1">
        <li data-list-text="A.">
            <h3 style="padding-left: 71pt; text-indent: -28pt; line-height: 15pt; text-align: justify;">Mandatory Documents / details required for processing all service request<span class="p">:</span></h3>
            <p style="padding-left: 43pt; text-indent: 0pt; text-align: justify;">
                <b>
                    I / We are submitting the following documents / details and undertake to request the Depository Participant to dematerialize my / our securities within 120 days from the date of issuance of Letter of Confirmation,
                    received from the RTA/Issuer Company
                </b>
                (tick <span class="s4"></span>as relevant, refer to the instructions):
            </p>
            <ul id="l2">
                <li data-list-text="">
                    <p style="padding-top: 5pt; padding-left: 64pt; text-indent: -21pt; line-height: 129%; text-align: justify;">
                        Demat Account No. (If available):
                        <u>
@* 46485446858456845 *@{{data.dpid}}
                        </u>
                        Provide Client Master List (<b>CML</b>) of your Demat Account from the Depository Participant*
                    </p>
                </li>
                <li data-list-text="">
                    <p class="s8" style="padding-top: 10pt; padding-left: 61pt; text-indent: -18pt; text-align: justify;">
                        <a href="https://www.sebi.gov.in/legal/circulars/nov-2021/common-and-simplified-norms-for-processing-investor-s-service-request-by-rtas-and-norms-for-furnishing-pan-kyc-details-and-nomination_53787.html"
                           style="color: black; font-family: Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;"
                           target="_blank">
                            Provide the following details, if they are not already available with the RTA (see
                        </a>
                        <span class="s7">SEBI</span>
                        <a href="https://www.sebi.gov.in/legal/circulars/nov-2021/common-and-simplified-norms-for-processing-investor-s-service-request-by-rtas-and-norms-for-furnishing-pan-kyc-details-and-nomination_53787.html"
                           style="color: #0462c1; font-family: Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;"
                           target="_blank">
                        </a>
                        <span class="s7">circular dated November 03, 2021 </span>in this regard<span class="p">)</span>
                    </p>
                    <table style="border-collapse: collapse; margin-left: 45.914pt;" cellspacing="0">
                        <tr style="height: 15pt;">
                            <td style="
                                        width: 243pt;
                                        border-top-style: dotted;
                                        border-top-width: 1pt;
                                        border-left-style: dotted;
                                        border-left-width: 1pt;
                                        border-bottom-style: dotted;
                                        border-bottom-width: 1pt;
                                        border-right-style: dotted;
                                        border-right-width: 1pt;
                                    ">
                                <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">PAN</p>
                            </td>
                            <td style="
                                        width: 203pt;
                                        border-top-style: dotted;
                                        border-top-width: 1pt;
                                        border-left-style: dotted;
                                        border-left-width: 1pt;
                                        border-bottom-style: dotted;
                                        border-bottom-width: 1pt;
                                        border-right-style: dotted;
                                        border-right-width: 1pt;
                                    ">
                                <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Specimen Signature</p>
                            </td>
                        </tr>
                        <tr style="height: 21pt;">
                            <td style="
                                        width: 243pt;
                                        border-top-style: dotted;
                                        border-top-width: 1pt;
                                        border-left-style: dotted;
                                        border-left-width: 1pt;
                                        border-bottom-style: dotted;
                                        border-bottom-width: 1pt;
                                        border-right-style: dotted;
                                        border-right-width: 1pt;
                                    ">
                                        <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">{{data.firstHolderpan}}
                                            <br />{{data.secondHolderpan}}
                                            <br />{{data.thirdHolderpan}}
                                            <br />Nomination / Declaration to Opt-out</p>
                            </td>
                            <td style="
                                        width: 203pt;
                                        border-top-style: dotted;
                                        border-top-width: 1pt;
                                        border-left-style: dotted;
                                        border-left-width: 1pt;
                                        border-bottom-style: dotted;
                                        border-bottom-width: 1pt;
                                        border-right-style: dotted;
                                        border-right-width: 1pt;
                                    ">
                                <p style="text-indent: 0pt; text-align: left;"><br /></p>
                            </td>
                        </tr>
                    </table>
                    <p style="padding-left: 43pt; text-indent: 0pt; line-height: 108%; text-align: justify;">
                        * (Your address, e-mail address, mobile number and bank details shall be updated in your folio from the information available in your <b>CML</b>
                        <a href="https://www.sebi.gov.in/sebi_data/commondocs/dec-2021/pdf%20Form%20ISR-1%20(1)_p.pdf"
                           style="color: black; font-family: Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;"
                           target="_blank">
                            ). You can authorize the RTA to update the above details for all your folios. In this regard, please refer to and use
                        </a>
                        <a href="https://www.sebi.gov.in/sebi_data/commondocs/dec-2021/pdf%20Form%20ISR-1%20(1)_p.pdf" class="a" target="_blank">Form </a><span class="s7">ISR-1</span>
                        <a href="https://www.sebi.gov.in/legal/circulars/nov-2021/common-and-simplified-norms-for-processing-investor-s-service-request-by-rtas-and-norms-for-furnishing-pan-kyc-details-and-nomination_53787.html"
                           style="color: black; font-family: Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;"
                           target="_blank">
                            in
                        </a>
                        <span class="s7">SEBI</span>
                        <a href="https://www.sebi.gov.in/legal/circulars/nov-2021/common-and-simplified-norms-for-processing-investor-s-service-request-by-rtas-and-norms-for-furnishing-pan-kyc-details-and-nomination_53787.html"
                           style="color: #0462c1; font-family: Calibri, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;"
                           target="_blank">
                        </a>
                        <a href="https://www.sebi.gov.in/legal/circulars/nov-2021/common-and-simplified-norms-for-processing-investor-s-service-request-by-rtas-and-norms-for-furnishing-pan-kyc-details-and-nomination_53787.html"
                           class="a"
                           target="_blank">
                            circular dated November 03,
                        </a>
                        <span class="s7">2021</span><span style="color: #4471c4;">.</span>
                    </p>
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </li>
            </ul>
        </li>
        <li data-list-text="B.">
            <p style="padding-left: 71pt; text-indent: -28pt; text-align: left;">I / We request you for the following (tick <span class="s4"></span><span class="s11"> </span>relevant box)</p>
            <table style="border-collapse: collapse; margin-left: 43.274pt;" cellspacing="0">
                <tr style="height: 40pt;">
                    <td style="
                                width: 227pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 5pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option1 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option1" value="option1">
                                    <span class="s9">Issue of Duplicate certificate</span>
                                </p>
                    </td>
                    <td style="
                                width: 224pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 28pt; padding-right: 4pt; text-indent: -21pt; line-height: 19pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option2 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option2" value="option2">
                                    <span class="s9">Claim from Unclaimed Suspense Account</span>
                                </p>
                    </td>
                </tr>
                <tr style="height: 40pt;">
                    <td style="
                                width: 227pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                        <p class="s12" style="padding-left: 27pt; text-indent: -22pt; line-height: 19pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option3 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option3" value="option3">
                                    <span class="s13">Replacement </span><span class="s9">/ Renewal / Exchange of securities certificate</span>
                        </p>
                    </td>
                    <td style="
                                width: 224pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 5pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option4 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option4" value="option4">
                                    <span class="s9">Endorsement</span>
                                </p>
                    </td>
                </tr>
                <tr style="height: 40pt;">
                    <td style="
                                width: 227pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 27pt; text-indent: -22pt; line-height: 19pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option5 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option5" value="option5">
                                    <span class="s9">Sub-division / Splitting of securities certificate</span>
                                </p>
                    </td>
                    <td style="
                                width: 224pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 5pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option6 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option6" value="option6">
                                    <span class="s9">Consolidation of Folios</span>
                                </p>
                    </td>
                </tr>
                <tr style="height: 25pt;">
                    <td style="
                                width: 227pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 5pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option7 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option7" value="option7">
                                    <span class="s9">Consolidation of Securities certificate</span>
                                </p>
                    </td>
                    <td style="
                                width: 224pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            ">
                                <p class="s12" style="padding-left: 6pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option8 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option8" value="option8">
                                    <span class="s9">Transmission</span>
                                </p>
                    </td>
                </tr>
                <tr style="height: 26pt;">
                    <td style="
                                width: 451pt;
                                border-top-style: dotted;
                                border-top-width: 1pt;
                                border-left-style: dotted;
                                border-left-width: 1pt;
                                border-bottom-style: dotted;
                                border-bottom-width: 1pt;
                                border-right-style: dotted;
                                border-right-width: 1pt;
                            "
                        colspan="2">
                                <p class="s12" style="padding-left: 5pt; text-indent: 0pt; line-height: 22pt; text-align: left;">
                                    <span ng-if="isPrint" class="s8" ng-bind="requests.option9 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="requests.option9" value="option9">
                                    <span class="s9">Transposition </span><span class="s14">(Mention the new order of holders here)</span> <span class="s9">{{data.firstHolder}} &amp; {{data.secondHolder}} &amp; {{data.thirdHolder}}</span>
                                </p>
                    </td>
                </tr>
            </table>
            <p style="text-indent: 0pt; text-align: left;"><br /></p>
        </li>
        <li data-list-text="C.">
            <h3 style="padding-left: 71pt; text-indent: -28pt; text-align: left;">I / We are enclosing certificate(s) as detailed below**:</h3>
            <table style="border-collapse: collapse; margin-left: 48.924pt;" cellspacing="0">
                <tr style="height: 22pt;">
                    <td style="
                                width: 164pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                        <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">Name of the Issuer Company</p>
                    </td>
                    <td style="
                                width: 281pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p style="text-indent: 0pt; text-align: left;">{{data.companyName}} </p>
                    </td>
                </tr>
                <tr style="height: 22pt;">
                    <td style="
                                width: 164pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                        <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">Folio Number</p>
                    </td>
                    <td style="
                                width: 281pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p style="text-indent: 0pt; text-align: left;">{{data.folioNo}}</p>
                    </td>
                </tr>
                <tr style="height: 66pt;">
                    <td style="
                                width: 164pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                            <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">Name(s) of the security holder(s) as per the certificate(s)</p>
                        @* <p class="s9" style="padding-left: 5pt; padding-right: 4pt; text-indent: 0pt; line-height: 22pt; text-align: left;"></p> *@
                    </td>
                    <td style="
                                width: 281pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">1. {{data.firstHolder}} </p>
                                <p class="s9" style="padding-top: 7pt; padding-left: 5pt; text-indent: 0pt; text-align: left;">2. {{data.secondHolder}}</p>
                                <p class="s9" style="padding-top: 7pt; padding-left: 5pt; text-indent: 0pt; text-align: left;">3. {{data.thirdHolder}}</p>
                    </td>
                </tr>
                <tr style="height: 15pt;">
                    <td style="
                                width: 164pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                        <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Certificate numbers</p>
                    </td>
                    <td style="
                                width: 281pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p style="text-indent: 0pt; text-align: left;">{{data.certificatenos}}</p>
                    </td>
                </tr>
            </table>
            <p style="text-indent: 0pt; text-align: left;"><br /></p>
            <table style="border-collapse: collapse; margin-left: 48.924pt;" cellspacing="0">
                <tr style="height: 15pt;">
                    <td style="
                                width: 164pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                        <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Distinctive numbers</p>
                    </td>
                    <td style="
                                width: 281pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                                <p style="text-indent: 0pt; text-align: left;">{{data.distinctiveNosStart}} - {{data.distinctiveNosEnd}}</p>
                    </td>
                </tr>
                <tr style="height: 44pt;">
                    <td style="
                                width: 164pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                            <p class="s9" style="padding-left: 5pt; text-indent: 0pt; line-height: 15pt; text-align: left;">Number &amp; Face value of securities</p>
                  
                    </td>
                    <td style="
                                width: 281pt;
                                border-top-style: solid;
                                border-top-width: 1pt;
                                border-left-style: solid;
                                border-left-width: 1pt;
                                border-bottom-style: solid;
                                border-bottom-width: 1pt;
                                border-right-style: solid;
                                border-right-width: 1pt;
                            ">
                        <p style="text-indent: 0pt; text-align: left;">{{data.qty}} &amp; &#8377 {{data.rate}}</p>
                    </td>
                </tr>
            </table>
            <p style="padding-left: 43pt; text-indent: 0pt; text-align: left;">** Wherever applicable / whichever details are available</p>
        </li>
        <li data-list-text="D.">
            <h3 style="padding-top: 14pt; padding-left: 71pt; text-indent: -28pt; line-height: 14pt; text-align: left;">Document / details required for specific service request:</h3>
            <ul id="l3">
                <li data-list-text="">
                            <p class="s15" style="padding-left: 78pt; text-indent: -23pt; line-height: 16pt; text-align: left;">
                                i)<span ng-if="isPrint" class="s8" ng-bind="doclist.option1 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option1" value="option1"> <span class="p">Duplicate securities certificate</span>
                            </p>
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </li>
                <li data-list-text="">
                            <p class="s15" style="padding-left: 78pt; text-indent: -27pt; text-align: left;">
                                ii)<span ng-if="isPrint" class="s8" ng-bind="doclist.option2 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option2" value="option2"> <span class="p">Claim from Unclaimed Suspense Account</span>
                            </p>
                    <p style="padding-top: 4pt; text-indent: 0pt; text-align: left;"><br /></p>
                    <table style="border-collapse: collapse; margin-left: 92.705pt;" cellspacing="0">
                        <tr style="height: 35pt;">
                            <td style="
                                        width: 170pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                                <p class="s9" style="padding-top: 2pt; padding-left: 2pt; text-indent: 0pt; text-align: left;">Securities claimed</p>
                            </td>
                            <td style="
                                        width: 232pt;
                                        border-top-style: solid;
                                        border-top-width: 1pt;
                                        border-left-style: solid;
                                        border-left-width: 1pt;
                                        border-bottom-style: solid;
                                        border-bottom-width: 1pt;
                                        border-right-style: solid;
                                        border-right-width: 1pt;
                                    ">
                                        <p class="s9" style="padding-top: 2pt; padding-left: 115pt; padding-right: 2pt; text-indent: -13pt; text-align: right;">{{data.qty}}(in numbers) <br /> {{data.qtyinwords}}(in words)</p>
                            </td>
                        </tr>
                    </table>
                </li>
                <li data-list-text="">
                            <p class="s15" style="padding-top: 13pt; padding-left: 78pt; text-indent: -30pt; text-align: left;">
                                iii)<span ng-if="isPrint" class="s8" ng-bind="doclist.option3 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option3" value="option3"> <span class="p">Replacement / Renewal / Exchange of securities certificate</span>
                            </p>
                    <p style="padding-top: 2pt; padding-left: 92pt; text-indent: 0pt; text-align: left;">(that is defaced, mutilated, torn, decrepit, worn out or where the page on the reverse is fully utilized)</p>
                </li>
                <li data-list-text="">
                            <p class="s15" style="padding-left: 78pt; text-indent: -30pt; line-height: 15pt; text-align: left;">
                                iv) <span ng-if="isPrint" class="s8" ng-bind="doclist.option4 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option4" value="option4"><span class="p">Endorsement</span>
                            </p>
                </li>
                <li data-list-text="">
                            <p class="s15" style="padding-left: 78pt; text-indent: -27pt; text-align: left;">
                                v)<span ng-if="isPrint" class="s8" ng-bind="doclist.option5 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option5" value="option5"> <span class="p">Sub-division / Splitting of securities certificate</span>
                            </p>
                </li>
                <li data-list-text="">
                            <p class="s15" style="padding-top: 1pt; padding-left: 78pt; text-indent: -30pt; text-align: left;">
                                vi)<span ng-if="isPrint" class="s8" ng-bind="doclist.option6 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option6" value="option6"> <span class="p">Consolidation of securities certificate/Folios</span>
                            </p>
                </li>
                <li data-list-text="">
                            <p class="s15" style="padding-top: 1pt; padding-left: 78pt; text-indent: -33pt; text-align: left;">
                                vii)<span ng-if="isPrint" class="s8" ng-bind="doclist.option7 ? '☑' : '☐'"></span>

                                <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option7" value="option7"><span class="p">Transmission</span>
                            </p>
                </li>
                <li data-list-text="">
                            <p class="s15" style="padding-left: 78pt; text-indent: -36pt; text-align: left;content:none;">
                                <span class="p">
                                    viii)<span ng-if="isPrint" class="s8" ng-bind="doclist.option8 ? '☑' : '☐'"></span>

                                    <input ng-show="!isPrint" ng-disabled="isPrint" type="checkbox" ng-model="doclist.option8" value="option8"> Transposition
                                </span>
                            </p>
                </li>
            </ul>
        </li>
    </ol>
    <p style="padding-top: 2pt; text-indent: 0pt; text-align: left;"><br /></p>
    <p class="s16" style="padding-left: 50pt; text-indent: 0pt; text-align: left;">Provide / attach original securities certificate(s) <u>for request for item numbers III to VIII above.</u></p>
    <p style="padding-top: 1pt; text-indent: 0pt; text-align: left;"><br /></p>
    <h3 style="padding-left: 43pt; text-indent: 0pt; line-height: 107%; text-align: left;">Declaration<span class="p">: All the above facts stated are true and correct to best of my / our knowledge and belief.</span></h3>
    <table style="border-collapse: collapse; margin-left: 6.05pt;" cellspacing="0">
        <tr style="height: 15pt;">
            <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                <p style="text-indent: 0pt; text-align: left;"><br /></p>
            </td>
            <td style="
                        width: 191pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                <p class="s18" style="padding-left: 25pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Security Holder 1 / Claimant</p>
            </td>
            <td style="
                        width: 143pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                <p class="s18" style="padding-left: 28pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Security Holder 2</p>
            </td>
            <td style="
                        width: 107pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                <p class="s18" style="padding-left: 10pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Security Holder 3</p>
            </td>
        </tr>
        <tr style="height: 45pt;">
            <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                <p class="s13" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Signature</p>
            </td>
            <td style="
                        width: 191pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                        <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>
            </td>
            <td style="
                        width: 143pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                        <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>
            </td>
            <td style="
                        width: 107pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                        <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>
            </td>
        </tr>
        <tr style="height: 21pt;">
            <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                <p class="s13" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Name</p>
            </td>
            <td style="
                        width: 191pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                        <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.firstHolder}}
            </td>
            <td style="
                        width: 143pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                        <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.secondHolder}}
            </td>
            <td style="
                        width: 107pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                        <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.thirdHolder}}
            </td>
        </tr>
        <tr style="height: 42pt;">
            <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                <p class="s13" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Full address</p>
            </td>
            <td style="
                        width: 191pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                        <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.firstHolderaddress}}
            </td>
            <td style="
                        width: 143pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                        <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.secondHolderaddress}}
            </td>
            <td style="
                        width: 107pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                        <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>{{data.thirdHolderaddress}}
            </td>
        </tr>
        <tr style="height: 14pt;">
            <td style="
                        width: 114pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                <p class="s13" style="padding-left: 5pt; text-indent: 0pt; line-height: 13pt; text-align: left;">PIN</p>
            </td>
            <td style="
                        width: 191pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>
            </td>
            <td style="
                        width: 143pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>
            </td>
            <td style="
                        width: 107pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    ">
                <p class="s19" style="padding-left: 5pt; text-indent: 0pt; text-align: left;"></p>
            </td>
        </tr>
    </table>
    </div>
    </form>
    <button class="btn btn-store" ng-click="printDiv('printForm')">Print</button>
</body>
<script>
    angular.module('Stock-CMS', []).controller('FormController', function ($scope, $http,$timeout) {
        $scope.customers = [];
        $scope.data = undefined;
              $scope.hDiv = true;
              var params = new URLSearchParams(window.location.search);
              var id = params.get('id');
              var id2 = params.get('id2');
              $scope.isPrint = id2 ? true : false
        var isProcessing = false;

        // showLoader();

         // Load Customers
         $scope.loadCustomers = function (sid) {
             if(id){
                $scope.hDiv = true;
                $http.get('/Enquiry/GetStocksById/'+id).then(function (response) {
                    var result = response.data;
                    $http.get('/Form/GetHolderByStockId/' +  id).then(function (response) {
                        $scope.docs = response.data;
                        var doc = $scope.docs.find(x => x.id === sid);
                        $scope.data = {
                            customerName : doc.nameAsPerAadhar,
                            today: new Date(),
                            dpid: doc.dpid,
                            firstHolderpan: result.firstHolderData ? result.firstHolderData.pan : '',
                            secondHolderpan: result.secondHolderData ? result.secondHolderData.pan : '',
                            thirdHolderpan: result.thirdHolderData ? result.thirdHolderData.pan : '',
                            companyName: result.companyName,
                            folioNo: result.folioNo,
                            firstHolder :result.firstHolderName,
                            secondHolder:result.secondHolderName,
                            thirdHolder: result.thirdHolderName,
                            certificatenos: $scope.data && $scope.data.certificatenos || '',
                            distinctiveNosStart:  $scope.data && $scope.data.distinctiveNosStart || '',
                            distinctiveNosEnd: $scope.data && $scope.data.distinctiveNosEnd || '',
                            qty: result.qty,
                            rate: result.rate,
                            qtyinwords: $scope.numberToWords(result.qty),
                            firstHolderaddress: result.firstHolderData.addressAsPerAadhar,
                            secondHolderaddress: result.secondHolderData ? result.secondHolderData.addressAsPerAadhar : '',
                            thirdHolderaddress: result.thirdHolderData ? result.thirdHolderData.addressAsPerAadhar : '',
                        };

                    hideLoader();
                    }, function (error) {
                    console.error('Error loading Docs:', error);
                    hideLoader();
                    });
                }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
                });
            }

            if(id2){
                 $scope.hDiv = false;
            $http.get('/Form/GetGenratedFormById/'+id2).then(function (response) {
                var result = response.data;
                var obj = JSON.parse(result.jsonString);
                $scope.data = {
                    customerName: obj.customerName,
                    today: new Date(obj.today),
                    dpid: obj.dpid,
                    firstHolderpan: obj.firstHolderpan,
                    secondHolderpan: obj.secondHolderpan,
                    thirdHolderpan: obj.thirdHolderpan,
                    requestlist:JSON.parse(obj.requestlist),
                    companyName: obj.companyName,
                    folioNo: obj.folioNo,
                    firstHolder:obj.firstHolder,
                    secondHolder:obj.secondHolder,
                    thirdHolder:obj.thirdHolder,
                    certificatenos: obj.certificatenos,
                    distinctiveNosStart: obj.distinctiveNosStart,
                    distinctiveNosEnd: obj.distinctiveNosEnd,
                    qty: obj.qty,
                    rate: obj.rate,
                    docattach: JSON.parse(obj.docattach),
                    qtyinwords: obj.qtyinwords,
                    firstHolderaddress:obj.firstHolderaddress,
                    secondHolderaddress:obj.secondHolderaddress,
                    thirdHolderaddress:obj.thirdHolderaddress,
                };
                    $scope.requests = $scope.data.requestlist;
                $scope.doclist = $scope.data.docattach;
                id = result.stockId;
                checkData();
                hideLoader();
            }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
            });
            }
        };

    function checkData() {
        if ($scope.data !== undefined) {
            // Delay the printDiv execution until the next digest cycle
            $timeout(function() {
                $scope.printDiv('printForm');
            }, 0);  // 0 delay to ensure it runs after the view update
        } else {
            setTimeout(checkData, 1000); // Retry after 1000ms if data is not yet available
        }
    }

     $scope.navtogenerateform = function () {
        window.open('/Form/GenerateForm/'+id, '_self');
    };

     $scope.numberToWords = function(num) {
        var ones = ["", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten", "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"];
        var tens = ["", "", "Twenty", "Thirty", "Forty", "Fifty", "Sixty", "Seventy", "Eighty", "Ninety"];
        var units = ["", "Hundred", "Thousand", "Lakh", "Crore"];  // Adjusted for Indian system

        // Helper function to convert numbers less than 1000
        function convertToWords(num) {
            if (num === 0) return "Zero";
            var words = "";

            // Process hundreds
            if (Math.floor(num / 100) > 0) {
                words += ones[Math.floor(num / 100)] + " Hundred ";
                num %= 100;
            }

            // Process tens and ones
            if (num > 0) {
                if (num < 20) {
                    words += ones[num];
                } else {
                    words += tens[Math.floor(num / 10)];
                    if (num % 10 > 0) {
                        words += " " + ones[num % 10];
                    }
                }
            }

            return words.trim();
        }

        // Main function to convert numbers to words with appropriate units (Thousand, Lakh, Crore)
        if (num === 0) return "Zero";

        var result = '';
        var i = 0;

        // Process lakhs, thousands, and hundreds
        while (num > 0) {
            if (num % 1000 !== 0) {
                result = convertToWords(num % 1000) + " " + units[i] + " " + result;
            }
            num = Math.floor(num / 1000);
            i++;
        }

        return result.trim();
    };

        //Genrate Form
         $scope.genrateForm = function () {
             if(id){

            var arr = angular.copy($scope.requests);
            $scope.data.requestlist = JSON.stringify(arr,null,2);

             var arr1 = angular.copy($scope.doclist);
             $scope.data.docattach= JSON.stringify(arr1,null,2);

             let jsonString = JSON.stringify($scope.data, null, 2);
             var data ={
                 formName : 'Form ISR 4',
                 StockId : id,
                 url : `/Form/FormISR4?id2=`,
                 jsonString : jsonString,
                 ClientName: $scope.data.customerName,
                 IsActive : true
             }

             const url = '/Form/GenrateForm';
                $http.post(url, data).then(function (response) {
                    if (response.data.success) {
                        Swal.fire({
                            title: 'Success',
                            text: response.data.message || 'Operation successful!',
                            icon: 'success',
                            confirmButtonText: 'OK'
                        });
                        // $scope.loadCustomers();
                        window.open(response.data.data.url + response.data.data.id,'_self')
                    } else {
                        Swal.fire({
                            title: 'Error!',
                            text: response.data.message || 'There was an issue adding the customer.',
                            icon: 'error',
                            confirmButtonText: 'Try Again'
                        });
                    }
                    isProcessing = false;
                }, function (error) {
                    Swal.fire({
                        title: 'Error',
                        text: 'An error occurred.',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                    isProcessing = false;
                });
            //console.log(dataString);
            }
         }

        // Load Customers
        // $scope.loadCustomers = function () {
        //     $http.get('/Master/GetCustomers').then(function (response) {
        //         $scope.customers = response.data[0];
        //         hideLoader();
        //     }, function (error) {
        //         console.error('Error loading customers:', error);
        //         hideLoader();
        //     });
        // };

        // $scope.loadDocs = function () {
        //     if (true) {
        //         $http.get('/doc/getDocs/' + 1).then(function (response) {
        //             $scope.docs = response.data;
        //             hideLoader();
        //         }, function (error) {
        //             console.error('Error loading Docs:', error);
        //             hideLoader();
        //         });
        //     }
        // };

        $scope.navtogenerateform = function () {
        window.open('/Form/GenerateForm/'+id, '_self');
    };

        //Function
        $scope.printDiv = function (divId) {
                    var css ='<style type="text/css"> *{margin:0;padding:0;text-indent:0}h1{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:18pt}.s1{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:10pt}h2{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:15pt}h3{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:12pt}.p,p{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt;margin:0pt}.s4{color:black;font-family:Wingdings;font-style:normal;font-weight:normal;text-decoration:none;font-size:14pt}.a{color:#0462c1;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:underline;font-size:12pt}.s7{color:#0462c1;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:underline;font-size:12pt}.s8{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:11pt}.s9{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}.s11{color:black;font-family:"Times New Roman",serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:14pt}.s12{color:black;font-family:Cambria,serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:20pt}.s13{color:black;font-family:"Times New Roman",serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}.s14{color:black;font-family:Calibri,sans-serif;font-style:italic;font-weight:normal;text-decoration:none;font-size:12pt}.s15{color:black;font-family:Cambria,serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:14pt}.s16{color:black;font-family:Calibri,sans-serif;font-style:italic;font-weight:normal;text-decoration:none;font-size:12pt}.s18{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:12pt}.s19{color:black;font-family:"Bookshelf Symbol 7";font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}li{display:block}#l1{padding-left:0pt;counter-reset:c1 1}#l1>li>*:first-child:before{counter-increment:c1;content:counter(c1,upper-latin)". ";color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:12pt}#l1>li:first-child>*:first-child:before{counter-increment:c1 0}#l2{padding-left:0pt}#l2>li>*:first-child:before{color:black;font-family:Symbol,serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}#l3{padding-left:0pt}#l3>li>*:first-child:before{color:black;font-family:Symbol,serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}table,tbody{vertical-align:top;overflow:visible}.ng-hide{display:none} </style>';
            var innerContents = document.getElementById(divId).innerHTML;
            var popupWinindow = window.open('', '_blank', 'width=600,height=700,scrollbars=no,menubar=no,toolbar=no,location=no,status=no,titlebar=no');
            popupWinindow.document.open();
            popupWinindow.document.write('<html><head><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">' + css + '</ head > <body style="padding-left: 8%;"onload="window.print()">' + innerContents + '</html>');
            popupWinindow.document.close();
        };
        //Initialize
        $scope.loadCustomers();
        // $scope.loadDocs();
    });
</script>

</html>
