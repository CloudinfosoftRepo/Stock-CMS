<html lang="en" ng-app="Stock-CMS">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Form ISR-13</title>
    <style type="text/css">
      * {
        margin: 0;
        padding: 0;
        text-indent: 0;
      }
      .h1,
      h1 {
        color: #231f20;
        font-family: Calibri, sans-serif;
        font-style: normal;
        font-weight: bold;
        text-decoration: none;
        font-size: 11pt;
      }
      .s1 {
        color: #231f20;
        font-family: Calibri, sans-serif;
        font-style: italic;
        font-weight: bold;
        text-decoration: none;
        font-size: 11pt;
      }
      .s2 {
        color: #231f20;
        font-family: Calibri, sans-serif;
        font-style: italic;
        font-weight: normal;
        text-decoration: none;
        font-size: 11pt;
      }
      p {
        color: #231f20;
        font-family: Calibri, sans-serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 11pt;
        margin: 0pt;
      }
      .s3 {
        color: #231f20;
        font-family: "Times New Roman", serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: underline;
        font-size: 11pt;
      }
      .s4 {
        color: #231f20;
        font-family: Calibri, sans-serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 11pt;
      }
      .s5 {
        color: black;
        font-family: Calibri, sans-serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 11pt;
      }
      li {
        display: block;
      }
      #l1 {
        padding-left: 0pt;
        counter-reset: c1 1;
      }
      #l1 > li > *:first-child:before {
        counter-increment: c1;
        content: "(" counter(c1, decimal) ") ";
        color: black;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
      }
      #l1 > li:first-child > *:first-child:before {
        counter-increment: c1 0;
      }
      #l2 {
        padding-left: 0pt;
        counter-reset: c2 1;
      }
      #l2 > li > *:first-child:before {
        counter-increment: c2;
        content: "(" counter(c2, lower-latin) ") ";
        color: #231f20;
        font-family: Calibri, sans-serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 11pt;
      }
      #l2 > li:first-child > *:first-child:before {
        counter-increment: c2 0;
      }
      li {
        display: block;
      }
      #l3 {
        padding-left: 0pt;
      }
      #l3 > li > *:first-child:before {
        content: "· ";
        color: black;
        font-family: Calibri, sans-serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 11pt;
      }
      #l4 {
        padding-left: 0pt;
      }
      #l4 > li > *:first-child:before {
        /* content: "· "; */
        color: black;
        font-family: Calibri, sans-serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 11pt;
      }
      table,
      tbody {
        vertical-align: top;
        overflow: visible;
      }
    </style>
  </head>
<body style="padding-left: 5%;" ng-controller="FormController">
    <div ng-if="hDiv">
        <form name="gForm" ng-submit="genrateForm()">
            <div class="row">
                 @* <div class="col-md-12">  *@
                 <div class="form-group mb-3"> 
                     <label for="seletedid" class="form-label">select customer</label> 
                     <select class="form-select w-auto" ng-options="f.id as f.name for f in docs" ng-model="seletedid" ng-change="loadCustomers(seletedid)"> 
                         <option selected disabled value="">Select customer</option> 
                     </select> 
                 </div> 
                <div class="form-group mb-3 col-md-3">
                    <label for="natureofsecurity" class="form-label">Nature Of Security</label>
                    <input type="text" ng-model="data.natureofsecurity" class="form-control search-orders" placeholder="Nature Of Security">
                </div>
                <div class="form-group mb-3  col-md-3">
                    <label for="certificatenos" class="form-label">Certificate Nos</label>
                    <input type="text" ng-model="data.certificatenos" class="form-control search-orders" placeholder="Certificate Nos">
                </div>
                <div class="form-group mb-3  col-md-3">
                    <label for="distinctiveNosStart" class="form-label">Distinctive Nos Start</label>
                    <input type="text" ng-model="data.distinctiveNosStart" class="form-control search-orders" placeholder="Distinctive Nos Start">
                </div>
                <div class="form-group mb-3  col-md-3">
                    <label for="distinctiveNosEnd" class="form-label">Distinctive Nos End</label>
                    <input type="text" ng-model="data.distinctiveNosEnd" class="form-control search-orders" placeholder="Distinctive Nos End">
                </div>
                <div class="form-group mb-3  col-md-3">
                    <label for="occupation" class="form-label">Occupation</label>
                    <input type="text" ng-model="data.occupation" class="form-control search-orders" placeholder="Occupation">
                </div>
                <div class="form-group mb-3  col-md-3">
                    <label for="nationality" class="form-label">Nationality</label>
                    <input type="text" ng-model="data.nationality" class="form-control search-orders" placeholder="Nationality">
                </div>
                <div class="form-group mb-3  col-md-3">
                    <label for="email" class="form-label">E Mail</label>
                    <input type="email" ng-model="data.email" class="form-control search-orders" placeholder="E Mail">
                </div>
                <div class="form-group mb-3  col-md-3">
                    <label for="relation" class="form-label">Relationship</label>
                    <input type="text" ng-model="data.relation" class="form-control search-orders" placeholder="Relationship">
                </div>
                <div class="form-group mb-3  col-md-3">
                    <label for="witnessname" class="form-label">Witness's Name</label>
                    <input type="text" ng-model="data.witnessname" class="form-control search-orders" placeholder="Witness's Name">
                </div>
                <div class="form-group mb-3 col-md-4">
                    <label for="witnessaddress" class="form-label">Witness Address</label>
                    <textarea id="address" ng-model="data.witnessaddress"
                              class="form-control" style="height: 100px; width: 100%;" placeholder="Witness Address" rows="5" cols="5" required></textarea>
                </div>
                @* </div> *@
                <div class="text-center m-2 col-md-4">
                    <button type="submit" class="btn" style="background-color:#003980; color:white;">
                        Genrate Form
                    </button>
                </div>
            </div>
        </form>
    </div>
    <div id="printForm">
    <h1
      style="
        padding-top: 1pt;
        /* padding-left: 188pt; */
        text-indent: 0pt;
        line-height: 182%;
        text-align: center;
      "
    >
      Form No. SH-13
    </h1>
    <h1
      style="
        padding-top: 1pt;
        /* padding-left: 188pt; */
        text-indent: 0pt;
        line-height: 182%;
        text-align: center;
      "
    >
    Nomination Form
    </h1>
    <p
      class="s1"
      style="text-align: center"
    >
      [Pursuant to section 72 of the Companies Act, 2013 and rule 19 (1) of
      <span class="h1"
        >the Companies (Share Capital and Debentures) Rules 2014</span
      >]
    </p>
    <br>
    <p
      class="s2"
      style="
        padding-left: 17pt;
        text-indent: 0pt;
        line-height: 13pt;
        text-align: left;
      "
    >
      To
    </p>
    <p
      style="
        padding-top: 12pt;
        padding-left: 17pt;
        text-indent: 0pt;
        text-align: left;
      "
    >
            Name of the company: {{data.officename}}
    </p>
    <p
      style="
        padding-top: 11pt;
        padding-left: 17pt;
        text-indent: 0pt;
        text-align: left;
      "
    >
            Address of the company:{{data.officeaddress}}
    </p>
    <p
      style="
        padding-top: 11pt;
        padding-left: 25pt;
        text-indent: 0pt;
        line-height: 154%;
        text-align: justify;
      "
    >
      I/We
      <span class="s3">{{data.customerName}}, {{data.holders}} </span>the holder(s) of the securities particulars of which are given hereunder
      wish to make nomination and do here by nominate the following persons in
      whom shall vest, all the rights in respect of such securities in the event
      of my/our death.
    </p>
    <ol id="l1">
      <li data-list-text="(1)">
        <p
          style="
            padding-left: 60pt;
            text-indent: -34pt;
            line-height: 153%;
            text-align: left;
          "
        >
          PARTICULARS OF THE SECURITIES (in respect of which nomination is being
          made)
        </p>
        <table 
          style="border-collapse: collapse; margin-left: 52.5pt"
          cellspacing="0"
        >
          <tr style="height: 45pt">
            <td
              style="
                width: 93pt;
                border-top-style: solid;
                border-top-width: 1pt;
                border-top-color: #231f20;
                border-left-style: solid;
                border-left-width: 1pt;
                border-left-color: #231f20;
                border-bottom-style: solid;
                border-bottom-width: 1pt;
                border-bottom-color: #231f20;
                border-right-style: solid;
                border-right-width: 1pt;
                border-right-color: #231f20;
              "
            >
              <p
                class="s4"
                style="
                  padding-left: 13pt;
                  padding-right: 36pt;
                  text-indent: 0pt;
                  line-height: 155%;
                  text-align: left;
                "
              >
                Nature of securities
              </p>
            </td>
            <td
              style="
                width: 67pt;
                border-top-style: solid;
                border-top-width: 1pt;
                border-top-color: #231f20;
                border-left-style: solid;
                border-left-width: 1pt;
                border-left-color: #231f20;
                border-bottom-style: solid;
                border-bottom-width: 1pt;
                border-bottom-color: #231f20;
                border-right-style: solid;
                border-right-width: 1pt;
                border-right-color: #231f20;
              "
            >
              <p
                class="s4"
                style="padding-left: 9pt; text-indent: 0pt; text-align: left"
              >
                Folio No.
              </p>
            </td>
            <td
              style="
                width: 77pt;
                border-top-style: solid;
                border-top-width: 1pt;
                border-top-color: #231f20;
                border-left-style: solid;
                border-left-width: 1pt;
                border-left-color: #231f20;
                border-bottom-style: solid;
                border-bottom-width: 1pt;
                border-bottom-color: #231f20;
                border-right-style: solid;
                border-right-width: 1pt;
                border-right-color: #231f20;
              "
            >
              <p
                class="s4"
                style="
                  padding-left: 10pt;
                  padding-right: 22pt;
                  text-indent: 9pt;
                  line-height: 155%;
                  text-align: left;
                "
              >
                No. of securities
              </p>
            </td>
            <td
              style="
                width: 67pt;
                border-top-style: solid;
                border-top-width: 1pt;
                border-top-color: #231f20;
                border-left-style: solid;
                border-left-width: 1pt;
                border-left-color: #231f20;
                border-bottom-style: solid;
                border-bottom-width: 1pt;
                border-bottom-color: #231f20;
                border-right-style: solid;
                border-right-width: 1pt;
                border-right-color: #231f20;
              "
            >
              <p
                class="s4"
                style="
                  padding-left: 27pt;
                  padding-right: 11pt;
                  text-indent: -19pt;
                  line-height: 155%;
                  text-align: left;
                "
              >
                Certificate No.
              </p>
            </td>
            <td
              style="
                width: 81pt;
                border-top-style: solid;
                border-top-width: 1pt;
                border-top-color: #231f20;
                border-left-style: solid;
                border-left-width: 1pt;
                border-left-color: #231f20;
                border-bottom-style: solid;
                border-bottom-width: 1pt;
                border-bottom-color: #231f20;
                border-right-style: solid;
                border-right-width: 1pt;
                border-right-color: #231f20;
              "
            >
              <p
                class="s4"
                style="padding-left: 12pt; text-indent: 0pt; text-align: left"
              >
                Distinctive No.
              </p>
            </td>
          </tr>
          <tr style="height: 24pt">
            <td
              style="
                width: 93pt;
                border-top-style: solid;
                border-top-width: 1pt;
                border-top-color: #231f20;
                border-left-style: solid;
                border-left-width: 1pt;
                border-left-color: #231f20;
                border-bottom-style: solid;
                border-bottom-width: 1pt;
                border-bottom-color: #231f20;
                border-right-style: solid;
                border-right-width: 1pt;
                border-right-color: #231f20;
              "
            >
                            <p style="text-indent: 0pt; text-align: left">{{data.natureofsecurity}}</p>
            </td>
            <td
              style="
                width: 67pt;
                border-top-style: solid;
                border-top-width: 1pt;
                border-top-color: #231f20;
                border-left-style: solid;
                border-left-width: 1pt;
                border-left-color: #231f20;
                border-bottom-style: solid;
                border-bottom-width: 1pt;
                border-bottom-color: #231f20;
                border-right-style: solid;
                border-right-width: 1pt;
                border-right-color: #231f20;
              "
            >
                            <p style="text-indent: 0pt; text-align: left">{{data.folioNo}}</p>
            </td>
            <td
              style="
                width: 77pt;
                border-top-style: solid;
                border-top-width: 1pt;
                border-top-color: #231f20;
                border-left-style: solid;
                border-left-width: 1pt;
                border-left-color: #231f20;
                border-bottom-style: solid;
                border-bottom-width: 1pt;
                border-bottom-color: #231f20;
                border-right-style: solid;
                border-right-width: 1pt;
                border-right-color: #231f20;
              "
            >
              <p style="text-indent: 0pt; text-align: left">{{data.qty}}</p>
            </td>
            <td
              style="
                width: 67pt;
                border-top-style: solid;
                border-top-width: 1pt;
                border-top-color: #231f20;
                border-left-style: solid;
                border-left-width: 1pt;
                border-left-color: #231f20;
                border-bottom-style: solid;
                border-bottom-width: 1pt;
                border-bottom-color: #231f20;
                border-right-style: solid;
                border-right-width: 1pt;
                border-right-color: #231f20;
              "
            >
                            <p style="text-indent: 0pt; text-align: left">{{data.certificatenos}}</p>
            </td>
            <td
              style="
                width: 81pt;
                border-top-style: solid;
                border-top-width: 1pt;
                border-top-color: #231f20;
                border-left-style: solid;
                border-left-width: 1pt;
                border-left-color: #231f20;
                border-bottom-style: solid;
                border-bottom-width: 1pt;
                border-bottom-color: #231f20;
                border-right-style: solid;
                border-right-width: 1pt;
                border-right-color: #231f20;
              "
            >
                            <p style="text-indent: 0pt; text-align: left">{{data.distinctiveNosStart}}-{{data.distinctiveNosEnd}}</p>
            </td>
          </tr>
        </table>
      </li>
      <li data-list-text="(2)">
        <p
          style="
            padding-top: 11pt;
            padding-left: 47pt;
            text-indent: -21pt;
            text-align: left;
          "
        >
          PARTICULARSOFNOMINEE/S—
        </p>
        <ol id="l2">
          <li data-list-text="(a)">
            <p
              style="
                padding-top: 11pt;
                padding-left: 72pt;
                text-indent: -20pt;
                text-align: left;
              "
            >
                            Name: {{data.customerName}}
            </p>
          </li>
          <li data-list-text="(b)">
            <p
              style="
                padding-top: 10pt;
                padding-left: 72pt;
                text-indent: -20pt;
                text-align: left;
              "
            >
              Date of Birth: {{data.dob | date:'dd/MM/yyyy'}}
            </p>
          </li>
          <li data-list-text="(c)">
            <p
              style="
                padding-top: 11pt;
                padding-left: 71pt;
                text-indent: -20pt;
                text-align: left;
              "
            >
                            @* Father’s/Mother’s/Spouse’s name *@{{data.relationship}}: {{data.sonof}}
            </p>
          </li>
          <li data-list-text="(d)">
            <p
              style="
                padding-top: 11pt;
                padding-left: 72pt;
                text-indent: -20pt;
                text-align: left;
              "
            >
              Occupation: {{data.occupation}}
            </p>
          </li>
          <li data-list-text="(e)">
            <p
              style="
                padding-top: 10pt;
                padding-left: 72pt;
                text-indent: -20pt;
                text-align: left;
              "
            >
              Nationality: {{data.nationality}}
            </p>
          </li>
          <li data-list-text="(f)">
            <p
              style="
                padding-top: 11pt;
                padding-left: 70pt;
                text-indent: -18pt;
                text-align: left;
              "
            >
                            Address: {{data.address}}
            </p>
          </li>
        </ol>
      </li>
    </ol>
    <br>
    <ul id="l3">
      <li data-list-text="·">
        <p
          class="s5"
          style="
            padding-top: 2pt;
            padding-left: 28pt;
            text-indent: -23pt;
            text-align: left;
          "
        >
                    E-mail id: {{data.email}}
        </p>
      </li>
      <li data-list-text="·">
        <p
          class="s5"
          style="padding-left: 28pt; text-indent: -23pt; text-align: left"
        >
                    Relationship with the security holder: {{data.relation}}
        </p>
        <p style="text-indent: 0pt; text-align: left"><br /></p>
      </li>
      <li data-list-text="·">
        <p style="padding-left: 28pt; text-indent: -23pt; text-align: left">
          INCASENOMINEEISAMINOR--
        </p>
        <ul id="l4">
          <li data-list-text="·">
            <p style="padding-left: 43pt; text-indent: -12pt; text-align: left">
              Date of birth:{{data.dob | date:'dd/MM/yyyy'}}
            </p>
          </li>
          <li data-list-text="·">
            <p style="padding-left: 43pt; text-indent: -12pt; text-align: left">
              Date of attaining majority:{{data.majordate | date:'dd/MM/yyyy'}}
            </p>
          </li>
          <li data-list-text="·">
            <p style="padding-left: 43pt; text-indent: -12pt; text-align: left">
                            Name of guardian: {{data.holders}}
            </p>
          </li>
          <li data-list-text="·">
            <p style="padding-left: 43pt; text-indent: -12pt; text-align: left">
              Address of guardian: {{data.address}}
            </p>
          </li>
        </ul>
      </li>
    </ul>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
        <p style="padding-left: 8pt; text-indent: 0pt; text-align: left">Name: {{data.customerName}}</p>
    <p
      style="
        padding-top: 11pt;
        padding-left: 8pt;
        text-indent: 0pt;
        text-align: left;
      "
    >
      Address:{{data.address}}
    </p>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p
      style="
        padding-left: 8pt;
        text-indent: 0pt;
        line-height: 160%;
        text-align: left;
      "
    >
            Name of the Security Holder(s) Signature Witness with  Name and address
    </p>
        <p style="text-indent: 0pt; text-align: left">{{data.customerName}}, {{data.holders}}</p>
    <p
      class="s5"
      style="padding-left: 258pt; text-indent: 0pt; text-align: left"
    >
            @* SHREYASH CHHAGANI *@ {{data.witnessname}}
    </p>
    <p
      class="s5"
      style="padding-left: 260pt; text-indent: 0pt; text-align: left"
    >
            @* B-204, RATNADEEP APPARTMENT VADODARA, 390025 *@ {{data.witnessaddress}}
  </p>
    </div>
    <button class="btn btn-store" ng-click="printDiv('printForm')">Print</button>
  </body>
<script>
    angular.module('Stock-CMS', []).controller('FormController', function ($scope, $http) {
        $scope.customers = [];
          $scope.data = undefined;
            $scope.hDiv = true;
            var params = new URLSearchParams(window.location.search);
            var id = params.get('id');
            var id2 = params.get('id2');
        var isProcessing = false;

        // showLoader();

         // Load Customers
         $scope.loadCustomers = function (sid) {
             if(id){
                 $scope.hDiv = true;
            $http.get('/Enquiry/GetStocksById/'+id).then(function (response) {
                var result = response.data;
                let holders = [
                        result.firstHolder || '',
                        result.secondHolder || '',
                        result.thirdHolder || ''
                    ].filter(holder => holder.trim() !== '');
                $http.get('/doc/getDocs/' +  result.customer.id).then(function (response) {
                     $scope.docs = response.data;
                    var doc = $scope.docs.find(x => x.id === sid);
                    var year = new Date(doc.dob).getFullYear();
                    var month = new Date(doc.dob).getMonth();
                    var day = new Date(doc.dob).getDate();
                $scope.data = {
                        customerName : doc.name,
                        officename : result.companyName,
                       address : doc.addressAsPerAadhar,
                       dob: doc.dob,
                       sonof: doc.relativesName,
                       relationship: doc.relationship,
                       email: '',
                       relation:'',
                   natureofsecurity: '',
                    certificatenos:'',
                   distinctiveNosStart: '',
                   distinctiveNosEnd:'',
                   qty: result.qty,
                   folioNo : result.folioNo,
                   officeaddress: '1101, Crescenzo, G-Block, Opp. MCA Club, Bandra-Kurla Complex, Bandra (East), Mumbai, Maharashtra, 400051',
                    holders : holders.length > 0 ? `${holders.join(') (')}` : '',
                    occupation: '',
                    nationality: '',
                    majordate: new Date(year + 18,month,day),
                    witnessaddress:'',
                    witnessname:'',
                };

                hideLoader();
                }, function (error) {
                    console.error('Error loading Docs:', error);
                    hideLoader();
                });
            }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
            });
            }

            if(id2){
                 $scope.hDiv = false;
            $http.get('/Form/GetGenratedFormById/'+id2).then(function (response) {
                var result = response.data;
                var obj = JSON.parse(result.jsonString);
                $scope.data = {
                    customerName: obj.customerName,
                    address: obj.address,
                    natureofsecurity: obj.natureofsecurity,
                    folioNo: obj.folioNo,
                    qty: obj.qty,
                    dob: new Date(obj.dob),
                    sonof: obj.sonof,
                    relationship: obj.relationship,
                    email: obj.email,
                    relationship: obj.relationship,
                    certificatenos: obj.certificatenos,
                    distinctiveNosStart: obj.distinctiveNosStart,
                    distinctiveNosEnd: obj.distinctiveNosEnd,
                    officename: obj.officename,
                    officeaddress: obj.officeaddress,
                    holders: obj.holders,
                    occupation: obj.occupation,
                    nationality: obj.nationality,
                    majordate: new Date(obj.majordate),
                    witnessname: obj.witnessname,
                    witnessaddress: obj.witnessaddress,
                };
                hideLoader();
            }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
            });
            }
        };

          $scope.calculateAge = function(dob) {
      if (!dob) {
        return '';
      }
      var birthDate = new Date(dob);
      var currentDate = new Date();
      var age = currentDate.getFullYear() - birthDate.getFullYear();
      var m = currentDate.getMonth() - birthDate.getMonth();

      // Adjust age if the current month is before the birth month or if the birth day hasn't occurred yet
      if (m < 0 || (m === 0 && currentDate.getDate() < birthDate.getDate())) {
        age--;
      }
      return age;
    };

        //Genrate Form
         $scope.genrateForm = function () {
             if(id){
             let jsonString = JSON.stringify($scope.data, null, 2);
             var data ={
                 formName : 'Form ISR 13',
                 StockId : id,
                 url : `/Form/FormISR13?id2=`,
                 jsonString : jsonString,
                 ClientName: $scope.data.customerName,
                 IsActive : true
             }

             const url = '/Form/GenrateForm';
                $http.post(url, data).then(function (response) {
                    if (response.data.success) {
                        Swal.fire({
                            title: 'Success',
                            text: response.data.message || 'Operation successful!',
                            icon: 'success',
                            confirmButtonText: 'OK'
                        });
                        // $scope.loadCustomers();
                                                window.open(response.data.data.url + response.data.data.id,'_self')

                    } else {
                        Swal.fire({
                            title: 'Error!',
                            text: response.data.message || 'There was an issue adding the customer.',
                            icon: 'error',
                            confirmButtonText: 'Try Again'
                        });
                    }
                    isProcessing = false;
                }, function (error) {
                    Swal.fire({
                        title: 'Error',
                        text: 'An error occurred.',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                    isProcessing = false;
                });
            //console.log(dataString);
            }
         }

        // Load Customers
        // $scope.loadCustomers = function () {
        //     $http.get('/Master/GetCustomers').then(function (response) {
        //         $scope.customers = response.data[0];
        //         hideLoader();
        //     }, function (error) {
        //         console.error('Error loading customers:', error);
        //         hideLoader();
        //     });
        // };

        // $scope.loadDocs = function () {
        //     if (true) {
        //         $http.get('/doc/getDocs/' + 1).then(function (response) {
        //             $scope.docs = response.data;
        //             hideLoader();
        //         }, function (error) {
        //             console.error('Error loading Docs:', error);
        //             hideLoader();
        //         });
        //     }
        // };

        //Function
        $scope.printDiv = function (divId) {
                        var css ='<style type="text/css">*{margin:0;padding:0;text-indent:0}.h1,h1{color:#231f20;font-family:Calibri,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:11pt}.s1{color:#231f20;font-family:Calibri,sans-serif;font-style:italic;font-weight:bold;text-decoration:none;font-size:11pt}.s2{color:#231f20;font-family:Calibri,sans-serif;font-style:italic;font-weight:normal;text-decoration:none;font-size:11pt}p{color:#231f20;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:11pt;margin:0pt}.s3{color:#231f20;font-family:"Times New Roman",serif;font-style:normal;font-weight:normal;text-decoration:underline;font-size:11pt}.s4{color:#231f20;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:11pt}.s5{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:11pt}li{display:block}#l1{padding-left:0pt;counter-reset:c1 1}#l1>li>*:first-child:before{counter-increment:c1;content:"("counter(c1,decimal)") ";color:black;font-style:normal;font-weight:normal;text-decoration:none}#l1>li:first-child>*:first-child:before{counter-increment:c1 0}#l2{padding-left:0pt;counter-reset:c2 1}#l2>li>*:first-child:before{counter-increment:c2;content:"("counter(c2,lower-latin)") ";color:#231f20;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:11pt}#l2>li:first-child>*:first-child:before{counter-increment:c2 0}#l3{padding-left:0pt}#l3>li>*:first-child:before{content:"· ";color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:11pt}#l4{padding-left:0pt}#l4>li>*:first-child:before{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:11pt}table,tbody{vertical-align:top;overflow:visible}</style>';
            var innerContents = document.getElementById(divId).innerHTML;
            var popupWinindow = window.open('', '_blank', 'width=600,height=700,scrollbars=no,menubar=no,toolbar=no,location=no,status=no,titlebar=no');
            popupWinindow.document.open();
            popupWinindow.document.write('<html><head><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">' + css + '</ head > <body style="padding-left: 8%;"onload="window.print()">' + innerContents + '</html>');
            popupWinindow.document.close();
        };
        //Initialize
        $scope.loadCustomers();
        // $scope.loadDocs();
    });
</script>
</html>
