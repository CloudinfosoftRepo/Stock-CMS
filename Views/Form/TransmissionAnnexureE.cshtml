<html lang="en" ng-app="Stock-CMS">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Transmission Annexure E.DOCX</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
            text-indent: 0;
        }

        .s1 {
            color: black;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 12pt;
        }

        .s2 {
            color: black;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        h2 {
            color: black;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 11.5pt;
        }

        .s4 {
            color: #006fbf;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: underline;
            font-size: 12pt;
        }

        h1 {
            color: black;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: none;
            font-size: 12pt;
        }

        p {
            color: black;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
            margin: 0pt;
        }

        .s5 {
            color: black;
            font-family: "Times New Roman", serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: underline;
            font-size: 12pt;
        }

        .s6 {
            color: black;
            font-family: "Times New Roman", serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        .s8 {
            color: #a6a6a6;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        .s9 {
            color: #a6a6a6;
            font-family: "Times New Roman", serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: underline;
            font-size: 12pt;
        }

        .s10 {
            color: black;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 8pt;
            vertical-align: 4pt;
        }

        .s11 {
            color: #d0d1d4;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: none;
            font-size: 12pt;
        }

        .s12 {
            color: #d0d1d4;
            font-family: "Times New Roman", serif;
            font-style: normal;
            font-weight: normal;
            text-decoration: underline;
            font-size: 12pt;
        }

        .s14 {
            color: black;
            font-family: Arial, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-decoration: underline;
            font-size: 12pt;
        }

        table,
        tbody {
            vertical-align: top;
            overflow: visible;
        }

        .table-cell {
            border: 1px solid #babdbf;
            padding: 3pt;
            text-align: left;
            vertical-align: top;
        }

        .table-header {
            text-align: center;
            line-height: 14pt;
        }

        /* Shared styles for paragraphs */
        .table-text {
            padding-top: 3pt;
            text-indent: 0pt;
            line-height: 14pt;
        }

        .table-text-indent {
            padding-left: 3pt;
            padding-right: 9pt;
            text-indent: 25pt;
        }


        .card {
            border-radius: 10px;
            overflow: hidden;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .form-select {
            width: 100%;
            padding: 0.75rem;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 1rem;
        }

        .btn-primary {
            width: 100%;
            padding: 12px 16px;
            text-transform: uppercase;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

            .btn-primary:hover {
                background-color: #0056b3;
                transform: scale(1.05);
            }
    </style>
</head>
<body style="padding: 5%;" ng-controller="FormController">
    <div class="row align-items-center">
        <!-- Arrow Icon aligned to the left -->
        <a class="col-md-1 text-start" style="font-size:35px;" ng-click="navtogenerateform()">
            <i class="bi bi-arrow-left"></i>
        </a>

        <!-- Centered Heading -->
        <div class="col-md-10 text-center">
            <h3>Transmission Annexure E</h3>
        </div>
    </div>
    
    <div ng-if="hDiv" class="container my-5">
        <div class="card shadow-sm">
            <div class="card-body">
                <form name="gForm" ng-submit="genrateForm()">
                    <h4 class="card-title text-center mb-4" style="color:#003980;">Generate Form</h4>

                    <div class="row">
                        <!-- Select Customer Dropdown -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="seletedId" class="form-label">Select Customer</label>
                                <select class="form-select" ng-options="f.id as f.name for f in docs" ng-model="seletedId" ng-change="loadCustomers(seletedId, heirId)">
                                    <option selected disabled value="">Select customer</option>
                                </select>
                            </div>
                        </div>

                        <!-- Select Heir Dropdown -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="heirId" class="form-label">Select Heir</label>
                                <select class="form-select" ng-options="g.id as g.name for g in heir" ng-model="heirId" ng-change="loadCustomers(seletedId, heirId)">
                                    <option selected disabled value="">Select Heir</option>
                                </select>
                            </div>
                        </div>

                        <!-- Certificate Nos -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="certificatenos" class="form-label">Certificate Nos</label>
                                <input type="text" ng-model="data.certificatenos" class="form-control" placeholder="Certificate Nos">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Distinctive Nos Start -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="distinctiveNosStart" class="form-label">Distinctive Nos Start</label>
                                <input type="text" ng-model="data.distinctiveNosStart" class="form-control" placeholder="Distinctive Nos Start">
                            </div>
                        </div>

                        <!-- Distinctive Nos End -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="distinctiveNosEnd" class="form-label">Distinctive Nos End</label>
                                <input type="text" ng-model="data.distinctiveNosEnd" class="form-control" placeholder="Distinctive Nos End">
                            </div>
                        </div>

                        <!-- Witness 1's Name -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="witness1name" class="form-label">Witness 1's Name</label>
                                <input type="text" ng-model="data.witness1name" class="form-control" placeholder="Witness 1's Name">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Witness 2's Name -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="witness2name" class="form-label">Witness 2's Name</label>
                                <input type="text" ng-model="data.witness2name" class="form-control" placeholder="Witness 2's Name">
                            </div>
                        </div>

                        <!-- Signed Submit Date -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="singnedsubmitdate" class="form-label">Signed Submit Date</label>
                                <input type="date" ng-model="data.singnedsubmitdate" class="form-control" placeholder="Signed Submit Date">
                            </div>
                        </div>

                        <!-- Place of Submission -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="place" class="form-label">Place</label>
                                <input type="text" ng-model="data.place" class="form-control" placeholder="Place">
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="col-md-4 text-center m-2">
                        <button type="submit" class="btn btn-primary" style="background-color:#003980; color:white; border-radius: 5px;">
                            Generate Form
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="printForm">
    <p style="text-indent: 0pt; text-align: center; border: 1pt solid #000000;display: block;min-height: 15pt;">
        Annexure E
    </p>
    <p style="padding-left: 349pt; text-indent: 0pt; text-align: left" />
    <p style="padding-top: 4pt; text-indent: 0pt; text-align: left"><br /></p>

    <p style="text-indent: 0pt; text-align: center; border: 1pt solid #000000;display: block;min-height: 15pt;">
        Note: <i><b>To be executed in the presence of a Public Notary </b></i><b>/ Gazetted Officer</b>
    </p>

    <p style="padding-left: 13pt; text-indent: 0pt; text-align: left" />
    <h2 style="
        padding-top: 12pt;
        padding-left: 16pt;
        text-indent: 0pt;
        text-align: left;
      ">
        Bond of Indemnity to be furnished jointly by all Legal Heir(s) including
        the Claimant(s)
    </h2>
    <p class="s4"
       style="padding-left: 78pt; text-indent: 0pt; text-align: left">
        (To be submitted on Non-judicial Stamp Paper of appropriate value)
    </p>
    <h1 style="
        padding-top: 5pt;
        padding-left: 159pt;
        text-indent: -128pt;
        text-align: left;
      ">
        [For Transmission of Securities on death of Sole Securities’ Holder, where
        no nomination has been registered]
    </h1>
    <p style="padding-left: 6pt; text-indent: 0pt; text-align: left">
        I/We,
            <span class="s5">@* RTADVYG CSACC *@{{data.customerName}} </span>do hereby solemnly affirm and state on oath as follows:
    </p>
    <p style="
        padding-top: 5pt;
        padding-left: 6pt;
        text-indent: 0pt;
        text-align: left;
      ">
        That Mr. /Ms.
        <span class="s5">@* VASDEDA *@{{data.sonof}} </span><span class="s6"> </span>was holding the following securities:
    </p>
    <p style="padding-top: 2pt; text-indent: 0pt; text-align: left"><br /></p>
    <table style="border-collapse: collapse; margin-left: 6.5pt" cellspacing="0">
        <tr style="height: 32pt">
            <td class="table-cell" style="width: 104pt;">
                <p class="table-text">Name of the Company</p>
            </td>
            <td class="table-cell" style="width: 107pt;">
                <p class="table-text">Certificate No.</p>
            </td>
            <td class="table-cell" style="width: 106pt;">
                <p class="table-text">Distinctive No.</p>
            </td>
            <td class="table-cell" style="width: 66pt;">
                <p class="table-text">Folio No.</p>
            </td>
            <td class="table-cell" style="width: 98pt;">
                <p class="table-text table-text-indent">No. of securities held</p>
            </td>
        </tr>

        <!-- Repeated row structure can be simplified -->
        <tr style="height: 18pt">
            <td class="table-cell" style="width: 104pt;">
                    <p class="table-text">{{data.officename}}</p>
            </td>
            <td class="table-cell" style="width: 107pt;">
                    <p class="table-text">{{data.certificatenos}}</p>
            </td>
            <td class="table-cell" style="width: 106pt;">
                    <p class="table-text">{{data.distinctiveNosStart}} - {{data.distinctiveNosEnd}}</p>
            </td>
            <td class="table-cell" style="width: 66pt;">
                    <p class="table-text">{{data.folioNo}}</p>
            </td>
            <td class="table-cell" style="width: 98pt;">
                <p class="table-text">{{data.qty}}</p>
            </td>
        </tr>

        <!-- Repeated structure for more rows can be simplified 
        <tr style="height: 18pt">
            <td class="table-cell" style="width: 104pt;">
                <p class="table-text">DVSDS</p>
            </td>
            <td class="table-cell" style="width: 107pt;">
                <p class="table-text">BFDSV</p>
            </td>
            <td class="table-cell" style="width: 106pt;">
                <p class="table-text">FBSA</p>
            </td>
            <td class="table-cell" style="width: 66pt;">
                <p class="table-text">V1DS3</p>
            </td>
            <td class="table-cell" style="width: 98pt;">
                <p class="table-text">615DSV</p>
            </td>
            </tr>-->

        <!-- Repeated row structure can be simplified further 
        <tr style="height: 18pt">
            <td class="table-cell" style="width: 104pt;">
                <p class="table-text"><br /></p>
            </td>
            <td class="table-cell" style="width: 107pt;">
                <p class="table-text"><br /></p>
            </td>
            <td class="table-cell" style="width: 106pt;">
                <p class="table-text"><br /></p>
            </td>
            <td class="table-cell" style="width: 66pt;">
                <p class="table-text"><br /></p>
            </td>
            <td class="table-cell" style="width: 98pt;">
                <p class="table-text"><br /></p>
            </td>
            </tr>-->
    </table>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p style="padding-left: 6pt; text-indent: 0pt; text-align: justify">
        That the aforesaid deceased holder died <i>intestate </i>on
            <span class="s5">@* VSDVRSKEV65VS *@{{data.dateofdeath | date:'dd/MM/yyyy'}} </span><span class="s6"> </span>without registering any nominee, leaving behind
        him/her the following persons as the only surviving legal heirs, according
        to the laws of intestate succession applicable to him/her by which he/she
        was governed at the time of his/her death.
    </p>
    <p style="padding-top: 1pt; text-indent: 0pt; text-align: left"><br /></p>
    <table style="border-collapse: collapse; margin-left: 6.5pt" cellspacing="0">
        <tr style="height: 42pt">
            <td style="width: 183pt; border: 1px solid #a6a8ab;">
                <p style="padding-left: 20pt; text-align: left;">Name of the Legal Heir(s)</p>
            </td>
            <td style="width: 184pt; border: 1px solid #a6a8ab;">
                <p style="padding-left: 1pt; text-align: left;">Address and contact details</p>
            </td>
            <td style="width: 35pt; border: 1px solid #a6a8ab;">
                <p style="padding-left: 3pt; text-align: left;">Age</p>
            </td>
            <td style="width: 86pt; border: 1px solid #a6a8ab;">
                <p style="padding-left: 4pt; text-align: left;">Relation with the Deceased</p>
            </td>
        </tr>

            <!--Empty Rows-->
            <tr style="height: 21pt" ng-repeat="tmp in heirlist">
            <td style="width: 183pt; border: 1px solid #a6a8ab;">
                    <p style="text-align: left;">{{ $index + 1 }}){{tmp.name}}</p>
            </td>
                <td style="width: 184pt; border: 1px solid #a6a8ab;">{{tmp.addressAsPerAadhar}}</td>
                <td style="width: 35pt; border: 1px solid #a6a8ab;">{{calculateAge(tmp.dob,tmp.dateOfDeath)}}</td>
                <td style="width: 86pt; border: 1px solid #a6a8ab;">{{tmp.relationWithDead}}</td>
        </tr>

            <!--<tr style="height: 21pt">
            <td style="width: 183pt; border: 1px solid #a6a8ab;">
                <p style="text-align: left;">2)V</p>
            </td>
            <td style="width: 184pt; border: 1px solid #a6a8ab;">VES</td>
            <td style="width: 35pt; border: 1px solid #a6a8ab;">VE54</td>
            <td style="width: 86pt; border: 1px solid #a6a8ab;">25</td>
        </tr>

        <tr style="height: 21pt">
            <td style="width: 183pt; border: 1px solid #a6a8ab;">
                <p style="text-align: left;">3)S</p>
            </td>
            <td style="width: 184pt; border: 1px solid #a6a8ab;">VESSEV</td>
            <td style="width: 35pt; border: 1px solid #a6a8ab;">VEES52</td>
            <td style="width: 86pt; border: 1px solid #a6a8ab;">VE52S6</td>
        </tr>

        <tr style="height: 20pt">
            <td style="width: 183pt; border: 1px solid #a6a8ab;">
                <p style="text-align: left;">4)</p>
            </td>
            <td style="width: 184pt; border: 1px solid #a6a8ab;"></td>
            <td style="width: 35pt; border: 1px solid #a6a8ab;"></td>
            <td style="width: 86pt; border: 1px solid #a6a8ab;"></td>
            </tr>-->
    </table>

    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p style="padding-left: 18pt; text-indent: 0pt; text-align: center">OR</p>
    <p style="padding-left: 6pt; text-indent: 0pt; text-align: justify">
        That the aforesaid deceased holder died on
            <span class="s5">@* CGVHBAWC *@{{data.dateofdeath | date:'dd/MM/yyyy'}} </span>, without registering any nominee, leaving behind him/her the following
        persons as the only surviving legal heirs, according to the laws of
        testamentary succession.
    </p>
    <table style="border-collapse: collapse; margin-left: 6.5pt" cellspacing="0">
        <!-- Table Header -->
        <tr style="height: 30pt">
            <td style="width: 148pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p class="s2" style="text-indent: 0pt; text-align: left">Name of the Legal Heir(s)/Claimant(s)</p>
            </td>
            <td style="width: 163pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p class="s2" style="padding-left: 67pt; padding-right: 17pt; text-indent: 0pt; text-align: left;">Address and contact details</p>
            </td>
            <td style="width: 28pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p class="s2" style="padding-left: 3pt; text-indent: 0pt; text-align: left;">Age</p>
            </td>
            <td style="width: 142pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p class="s2" style="padding-left: 4pt; text-indent: 0pt; text-align: left;">Relationship with the Deceased</p>
            </td>
        </tr>

        <!-- Row 1 -->
            <tr style="height: 21pt" ng-repeat="tmp in heir">
            <td style="width: 148pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                    <p class="s2" style="text-indent: 0pt; text-align: left">{{ $index + 1 }}){{tmp.name}}</p>
            </td>
            <td style="width: 163pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                    <p style="text-indent: 0pt; text-align: left">{{tmp.addressAsPerAadhar}}</p>
            </td>
            <td style="width: 28pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                    <p style="text-indent: 0pt; text-align: left">{{calculateAge(tmp.dob,tmp.dateOfDeath)}}</p>
            </td>
            <td style="width: 142pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                    <p style="text-indent: 0pt; text-align: left">{{tmp.relationWithDead}}</p>
            </td>
        </tr>

        <!-- Row 2
        <tr style="height: 20pt">
            <td style="width: 148pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p class="s2" style="text-indent: 0pt; text-align: left">2)VSEV</p>
            </td>
            <td style="width: 163pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p style="text-indent: 0pt; text-align: left">15VSEVVSEVS,VESVES</p>
            </td>
            <td style="width: 28pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p style="text-indent: 0pt; text-align: left">516SV</p>
            </td>
            <td style="width: 142pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p style="text-indent: 0pt; text-align: left">213</p>
            </td>
            </tr> -->

        <!-- Row 3 
        <tr style="height: 22pt">
            <td style="width: 148pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p class="s2" style="text-indent: 0pt; text-align: left">3</p>
            </td>
            <td style="width: 163pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p style="text-indent: 0pt; text-align: left"><br /></p>
            </td>
            <td style="width: 28pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p style="text-indent: 0pt; text-align: left"><br /></p>
            </td>
            <td style="width: 142pt; border-top: solid 1pt #a6a8ab; border-left: solid 1pt #a6a8ab; border-bottom: solid 1pt #a6a8ab; border-right: solid 1pt #a6a8ab;">
                <p style="text-indent: 0pt; text-align: left"><br /></p>
            </td>
            </tr>-->
    </table>

    <p style="padding-top: 13pt; text-indent: 0pt; text-align: left"><br /></p>
    <p style="text-indent: 0pt; text-align: left" />
    <p style="text-indent: 0pt; text-align: left" />
    <p style="padding-left: 6pt; text-indent: 0pt; text-align: justify">
        Therefore, I/We, the Legal Heir(s)/Claimant(s) and deponent(s) herein
        has/have, approached
        <span class="s9">
                @* DBSB RHGR H *@{{data.officename}}/{{data.rtaName}}
        </span>(Name of the Company/RTA) with a request to transmit
        the aforesaid securities in the name of the undersigned Mr. /Ms.
        <span class="s9">
                @* VSDVSVDE G SG G *@{{data.customerName}}
        </span>[Name(s) of the legal heir(s)/claimant(s)<span style="color: #000">]</span><span class="s9"> </span><span class="s10">#</span><span style="color: #000">
            , on my/our behalf, without insisting on production of a Succession
            Certificate/ Probate of Will / Letter of Administration or any Court
            order, for which we execute an indemnity as is
        </span>herein contained and on relying on the information herein given by us,
        believing the same to be true.
    </p>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p style="text-indent: 0pt; text-align: left" />
    <p style="padding-left: 6pt; text-indent: 0pt; text-align: justify">
        In consideration therefore of my/our request to transfer/transmit the
        above said securities to the name of the undersigned Mr. /Ms.<span class="s9">
                @* SGNFGN15 *@{{data.customerName}}
        </span><span class="s9"> </span><span class="s10">#</span>
    </p>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p style="padding-left: 6pt; text-indent: 0pt; text-align: justify">
        I/We hereby jointly and severely agree and undertake to indemnify and keep
            indemnified, saved, defended, harmless, {{data.officename}}/{{data.rtaName}} [Name of the Company/ Issuer and
        any RTA] and its successors and assigns for all time hereafter against all
        losses, costs, claims, actions, demands, risks, charges, expenses,
        damages, etc., whatsoever which they may suffer and/or incur by reason of
        transferring the said securities as herein above mentioned, at my/our
        request to the undersigned Mr./Ms.
            <span class="s5">{{data.customerName}}</span><span class="s6"> </span><span style="color: #a6a6a6">[Name(s) of the legal heir(s)/claimant(s)</span>]<span style="color: #d0d1d4">_</span><span class="s12"> </span><span style="color: #bebebe">_</span><span class="s10">#</span>, without
        insisting on production of a Succession Certificate / Probate of Will /
        Letter of Administration or any Court order.
    </p>
    <p style="padding-top: 1pt; text-indent: 0pt; text-align: left"><br /></p>
    <p style="padding-left: 6pt; text-indent: 0pt; text-align: justify">
        IN WITNESS WHEREOF the said 1) Mr. /Ms.<span class="s5">
                @* VSVSBG G EGTHRTT *@{{data.witness1name}}
        </span>
        <span class="s5">
            @* BRSDVS BGRDBRB *@
        </span>
    </p>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p style="
        padding-left: 5pt;
        text-indent: 0pt;
        line-height: 1pt;
        text-align: left;
      " />
    <p style="padding-top: 1pt; text-indent: 0pt; text-align: left"><br /></p>
    <p class="s11"
       style="padding-left: 6pt; text-indent: 0pt; text-align: left">
        (Name and signature of the witness)
        <span class="s12">@* BSEGV ESN *@</span>
    </p>
    <p style="
        padding-top: 1pt;
        padding-left: 6pt;
        text-indent: 0pt;
        text-align: left;
      ">
        And 2) Mr. /Ms.
            <span class="s5">@* IYVJY VJBYHB *@{{data.witness2name}}</span>
    </p>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p style="
        padding-left: 5pt;
        text-indent: 0pt;
        line-height: 1pt;
        text-align: left;
      " />
    <p style="padding-top: 2pt; text-indent: 0pt; text-align: left"><br /></p>
    <p class="s11"
       style="padding-left: 6pt; text-indent: 0pt; text-align: justify">
        (Name and signature of the witness )<span class="s12">
            @* FCVG HGVJB HJ B *@
        </span>
    </p>
    <p style="text-indent: 0pt; text-align: left" />
    <p style="
        padding-top: 1pt;
        padding-left: 6pt;
        text-indent: 276pt;
        line-height: 108%;
        text-align: justify;
      ">
            {{data.customerName}}
            <span class="s10">#</span>, have hereunto set their respective hands and
        seals this day of
            <span class="s9">@* 12/185/1650 *@{{data.singnedsubmitdate | date:'dd/MM/yyyy'}} </span><span style="color: #a6a6a6">. </span>Signed and delivered by the said
        legal heir/s.
    </p>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <table style="border-collapse: collapse; margin-left: 6.5pt" cellspacing="0">
        <!-- Row 1: Table Header -->
        <tr style="height: 28pt">
            <!-- Column 1: Name of the Legal Heirs -->
            <td style="width: 252pt; border: solid 1pt #babdbf;">
                <p class="s1" style="padding-left: 91pt; text-indent: 0pt; text-align: left;">
                    Name of the Legal Heirs
                </p>
            </td>
            <!-- Column 2: Signature of the Legal Heirs -->
            <td style="width: 229pt; border: solid 1pt #babdbf;">
                <p class="s1" style="padding-left: 35pt; padding-right: 28pt; text-indent: 0pt; line-height: 14pt; text-align: left;">
                    Signature of the Legal Heirs
                </p>
            </td>
        </tr>

        <!-- Row 2: First Heir -->
            <tr style="height: 33pt" ng-repeat="tmp in heirlist">
            <td style="width: 252pt; border: solid 1pt #babdbf;">
                    <p class="s2" style="text-indent: 0pt; line-height: 14pt; text-align: left;">{{ $index + 1 }}){{tmp.name}}</p>
            </td>
            <td style="width: 229pt; border: solid 1pt #babdbf;">
                <p style="text-indent: 0pt; text-align: left"><br /></p>
            </td>
        </tr>

        <!-- Row 3: Second Heir 
        <tr style="height: 34pt">
            <td style="width: 252pt; border: solid 1pt #babdbf;">
                <p class="s2" style="text-indent: 0pt; text-align: left">2)VSVEV</p>
            </td>
            <td style="width: 229pt; border: solid 1pt #babdbf;">
                <p style="text-indent: 0pt; text-align: left"><br /></p>
            </td>
            </tr>-->

        <!-- Row 4: Third Heir 
        <tr style="height: 33pt">
            <td style="width: 252pt; border: solid 1pt #babdbf;">
                <p class="s2" style="text-indent: 0pt; line-height: 14pt; text-align: left">3)SVESESV</p>
            </td>
            <td style="width: 229pt; border: solid 1pt #babdbf;">
                <p style="text-indent: 0pt; text-align: left"><br /></p>
            </td>
            </tr>-->

        <!-- Row 5: Fourth Heir 
        <tr style="height: 34pt">
            <td style="width: 252pt; border: solid 1pt #babdbf;">
                <p class="s2" style="text-indent: 0pt; text-align: left">4)SEVSDV</p>
            </td>
            <td style="width: 229pt; border: solid 1pt #babdbf;">
                <p style="text-indent: 0pt; text-align: left"><br /></p>
            </td>
            </tr>-->
    </table>

    <p style="
        padding-top: 13pt;
        padding-left: 6pt;
        text-indent: 0pt;
        text-align: justify;
      ">
        (*) = Name of the deceased security holder (#) = Name of the claimant/s
    </p>
    <p class="s14"
       style="padding-top: 13pt; text-indent: 0pt; text-align: center">
        Signed before me
    </p>
    <p style="padding-left: 5pt; text-indent: 0pt; text-align: justify">
        at:
        <span class="s5">{{data.place}}</span>
    </p>
    <p style="padding-top: 2pt; text-indent: 0pt; text-align: left"><br /></p>
    <p style="padding-left: 5pt; text-indent: 0pt; text-align: left">
            on<span style="color: #d0d1d4">: </span><span class="s12">{{data.today | date:'__/MM/yyyy'}}</span>
    </p>
    <p style="padding-top: 9pt; text-indent: 0pt; text-align: left"><br /></p>
    <p class="s8" style="padding-left: 6pt; text-indent: 0pt; text-align: left">
        Signature of Notary
    </p>
    <p class="s8"
       style="
        padding-top: 9pt;
        padding-left: 5pt;
        text-indent: 0pt;
        text-align: left;
      ">
        Official stamp &amp; seal of the Notary &amp; Regn. No.:
    </p>
    </div>
    <button class="btn btn-store" ng-click="printDiv('printForm')">Print</button>
</body>
<script>
    angular.module('Stock-CMS', []).controller('FormController', function ($scope, $http,$timeout) {
        $scope.customers = [];
         $scope.data = undefined;
              $scope.hDiv = true;
              var params = new URLSearchParams(window.location.search);
              var id = params.get('id');
              var id2 = params.get('id2');
              $scope.isPrint = id2 ? true : false;
        var isProcessing = false;

        // showLoader();

         $scope.navtogenerateform = function () {
        window.open('/Form/GenerateForm/'+id, '_self');
    };

    function checkData() {
        if ($scope.data !== undefined) {
            // Delay the printDiv execution until the next digest cycle
            $timeout(function() {
                $scope.printDiv('printForm');
            }, 0);  // 0 delay to ensure it runs after the view update
        } else {
            setTimeout(checkData, 1000); // Retry after 1000ms if data is not yet available
        }
    }
     $scope.calculateAge = function(dob, deathDate) {
        if (!dob) {
            return '';
        }

        var birthDate = new Date(dob);
        var currentDate = new Date();
        var age = currentDate.getFullYear() - birthDate.getFullYear();
        var m = currentDate.getMonth() - birthDate.getMonth();

        if (m < 0 || (m === 0 && currentDate.getDate() < birthDate.getDate())) {
            age--;
        }

        // If deathDate is provided, calculate age at the time of death
        if (deathDate) {
            var deathDateObj = new Date(deathDate);
            age = deathDateObj.getFullYear() - birthDate.getFullYear();
            var mDeath = deathDateObj.getMonth() - birthDate.getMonth();

            if (mDeath < 0 || (mDeath === 0 && deathDateObj.getDate() < birthDate.getDate())) {
                age--;
            }
            return age;
            // return age + ' (deceased)';
        }

        return age;
    };

    // Load Customers
         $scope.loadCustomers = function (sid,hid) {
             if(id){
                $scope.hDiv = true;
                $http.get('/Enquiry/GetStocksById/'+id).then(function (response) {
                    var result = response.data;
                    $http.get('/Form/GetHolderByStockId/' +  id).then(function (response) {
                        $scope.docs = response.data;
                        var doc = $scope.docs.find(x => x.id === sid);
                        $http.get('/LegalHeir/GetLegalHeir/' + doc.id).then(function (response) {
                            $scope.heirlist = response.data;
                            $http.get('/LegalHeir/GetClaimentLegalHeir/' + doc.id).then(function (response) {
                                $scope.heir =response.data;
                                var heirs = response.data.find(x => x.id === hid);

                                $scope.data = {
                                    docid: heirs.id,
                                    customerName : heirs.nameAsPerAadhar,
                                    sonof: doc.nameAsPerAadhar,
                                    officename : result.companyName,
                                    certificatenos:'',
                                    distinctiveNosStart:'',
                                    distinctiveNosEnd:'',
                                    folioNo : result.folioNo,
                                    qty: result.qty,
                                    dateofdeath: doc.dateOfDeath,
                                    rtaName: result.company.rtaName,
                                    witness1name:'',
                                    witness2name:'',
                                    singnedsubmitdate:'',
                                    place: 'Vadodara',
                                    today: new Date(),
                                };

                                hideLoader();
                            }, function (error) {
                            console.error('Error loading legal Heir:', error);
                            hideLoader();
                            });
                        }, function (error) {
                        console.error('Error loading Legal Heirs:', error);
                        hideLoader();
                        });
                    }, function (error) {
                    console.error('Error loading Docs:', error);
                    hideLoader();
                    });
                }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
                });
            }

            if(id2){
                 $scope.hDiv = false;
            $http.get('/Form/GetGenratedFormById/'+id2).then(function (response) {
                var result = response.data;
                var obj = JSON.parse(result.jsonString);
                $scope.data = {
                    docid: obj.docid,
                    customerName: obj.customerName,
                    sonof: obj.sonof,
                    officename: obj.officename,
                    certificatenos: obj.certificatenos,
                    distinctiveNosStart: obj.distinctiveNosStart,
                    distinctiveNosEnd: obj.distinctiveNosEnd,
                    folioNo: obj.folioNo,
                    qty: obj.qty,
                    dateofdeath: new Date(obj.dateofdeath),
                    heirs: JSON.parse(obj.heirs),
                    claiment: JSON.parse(obj.claiment),
                    rtaName: obj.rtaName,
                    witness1name: obj.witness1name,
                    witness2name: obj.witness2name,
                    singnedsubmitdate: new Date(obj.singnedsubmitdate),
                    place: obj.place,
                    today: new Date(obj.today),
                };
                $scope.heirlist = $scope.data.heirs;
                $scope.heir = $scope.data.claiment;

                id = result.stockId;
                checkData();
                hideLoader();
            }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
            });
            }
        };

         //Genrate Form
         $scope.genrateForm = function () {
             if(id){
                  var arr = angular.copy($scope.heirlist);
                 $scope.data.heirs = JSON.stringify(arr,null,2);

                 var arr1 = angular.copy($scope.heir);
                 $scope.data.claiment = JSON.stringify(arr1,null,2);

             let jsonString = JSON.stringify($scope.data, null, 2);
             var data ={
                 formName : 'Transmission Annexure E',
                 StockId : id,
                 url : `/Form/TransmissionAnnexureE?id2=`,
                 jsonString : jsonString,
                 ClientName: $scope.data.customerName,
                  ClientId: $scope.data.docid,
                 IsActive : true
             }

             const url = '/Form/GenrateForm';
                $http.post(url, data).then(function (response) {
                    if (response.data.success) {
                        Swal.fire({
                            title: 'Success',
                            text: response.data.message || 'Operation successful!',
                            icon: 'success',
                            confirmButtonText: 'OK'
                        });
                        // $scope.loadCustomers();
                        window.open(response.data.data.url + response.data.data.id,'_self')
                    } else {
                       Swal.fire({
                         title: 'This Form is already Exits',
                         text: "do you want to go to that form?",
                         icon: 'warning',
                         showCancelButton: true,
                         confirmButtonText: 'Yes',
                         cancelButtonText: 'No'
                     }).then((result) => {
                         if (result.isConfirmed) {
                             window.open(response.data.message, '_self');
                         }
                 });

                    }
                    isProcessing = false;
                }, function (error) {
                    Swal.fire({
                        title: 'Error',
                        text: 'An error occurred.',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                    isProcessing = false;
                });
            //console.log(dataString);
            }
         }


        // Load Customers
        // $scope.loadCustomers = function () {
        //     $http.get('/Master/GetCustomers').then(function (response) {
        //         $scope.customers = response.data[0];
        //         hideLoader();
        //     }, function (error) {
        //         console.error('Error loading customers:', error);
        //         hideLoader();
        //     });
        // };

        // $scope.loadDocs = function () {
        //     if (true) {
        //         $http.get('/doc/getDocs/' + 1).then(function (response) {
        //             $scope.docs = response.data;
        //             hideLoader();
        //         }, function (error) {
        //             console.error('Error loading Docs:', error);
        //             hideLoader();
        //         });
        //     }
        // };

        //Function
        $scope.printDiv = function (divId) {
               var css ='<style type="text/css">*{margin:0;padding:0;text-indent:0}.s1{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:12pt}.s2{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}h2{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:11.5pt}.s4{color:#006fbf;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:underline;font-size:12pt}h1{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:12pt}p{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt;margin:0pt}.s5{color:black;font-family:"Times New Roman",serif;font-style:normal;font-weight:normal;text-decoration:underline;font-size:12pt}.s6{color:black;font-family:"Times New Roman",serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}.s8{color:#a6a6a6;font-family:Arial,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}.s9{color:#a6a6a6;font-family:"Times New Roman",serif;font-style:normal;font-weight:normal;text-decoration:underline;font-size:12pt}.s10{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:8pt;vertical-align:4pt}.s11{color:#d0d1d4;font-family:Arial,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}.s12{color:#d0d1d4;font-family:"Times New Roman",serif;font-style:normal;font-weight:normal;text-decoration:underline;font-size:12pt}.s14{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:underline;font-size:12pt}table,tbody{vertical-align:top;overflow:visible}.table-cell{border:1px solid #babdbf;padding:3pt;text-align:left;vertical-align:top}.table-header{text-align:center;line-height:14pt}.table-text{padding-top:3pt;text-indent:0pt;line-height:14pt}.table-text-indent{padding-left:3pt;padding-right:9pt;text-indent:25pt}.ng-hide{display:none;}</style>';
            var innerContents = document.getElementById(divId).innerHTML;
            var popupWinindow = window.open('', '_blank', 'width=600,height=700,scrollbars=no,menubar=no,toolbar=no,location=no,status=no,titlebar=no');
            popupWinindow.document.open();
            popupWinindow.document.write('<html><head><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">' + css + '</ head > <body style="padding: 0 5% 0 5%;"onload="window.print()">' + innerContents + '</html>');
            popupWinindow.document.close();
        };
        //Initialize
        $scope.loadCustomers();
        // $scope.loadDocs();
    });
</script>
</html>
