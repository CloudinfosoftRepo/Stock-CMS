<html lang="en" ng-app="Stock-CMS">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Dup.-Aff-A.DOCX</title>
    <style type="text/css">
      * {
        margin: 0;
        padding: 0;
        text-indent: 0;
      }
      h2 {
        color: black;
        font-family: Arial, sans-serif;
        font-style: normal;
        font-weight: bold;
        text-decoration: none;
        font-size: 11pt;
      }
      .s1 {
        color: black;
        font-family: Arial, sans-serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 12pt;
      }
      .s3 {
        color: black;
        font-family: Arial, sans-serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 12pt;
      }
      p {
        color: black;
        font-family: Arial, sans-serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 11pt;
        margin: 0pt;
      }
      .s4 {
        color: black;
        font-family: "Times New Roman", serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: underline;
        font-size: 11pt;
      }
      .s6 {
        color: black;
        font-family: "Times New Roman", serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 11pt;
      }
      .s7 {
        color: black;
        font-family: Arial, sans-serif;
        font-style: normal;
        font-weight: bold;
        text-decoration: none;
        font-size: 10pt;
      }
      .s8 {
        color: black;
        font-family: Arial, sans-serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 10pt;
      }
      .s10 {
        color: #d9d9d9;
        font-family: "Times New Roman", serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: underline;
        font-size: 11pt;
      }
      h1 {
        color: black;
        font-family: Arial, sans-serif;
        font-style: normal;
        font-weight: bold;
        text-decoration: none;
        font-size: 12pt;
      }
      .s11 {
        color: black;
        font-family: "Times New Roman", serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: underline;
        font-size: 12pt;
      }
      .s12 {
        color: black;
        font-family: "Times New Roman", serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 12pt;
      }
      li {
        display: block;
      }
      #l1 {
        padding-left: 0pt;
        counter-reset: c1 1;
      }
      #l1 > li > *:first-child:before {
        counter-increment: c1;
        content: counter(c1, decimal) ". ";
        color: black;
        font-family: Arial, sans-serif;
        font-style: normal;
        font-weight: normal;
        text-decoration: none;
        font-size: 11pt;
      }
      #l1 > li:first-child > *:first-child:before {
        counter-increment: c1 0;
      }
      table,
      tbody {
        vertical-align: top;
        overflow: visible;
      }
      table {
  border-collapse: collapse;
  margin-left: 43.5pt;
}

th, td {
  border: 1px solid #babdbf;
  padding: 10px;
}

th {
  width: 100pt; /* Adjust widths as needed */
}

td:nth-child(2) {
  width: 49pt;
}

td:nth-child(3) {
  width: 57pt;
}

td:nth-child(4) {
  width: 78pt;
}

td:nth-child(5), td:nth-child(6) {
  width: 70.5pt; /* Adjust for colspan */
}


        .card {
            border-radius: 10px;
            overflow: hidden;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .form-select {
            width: 100%;
            padding: 0.75rem;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 1rem;
        }

        .btn-primary {
            width: 100%;
            padding: 12px 16px;
            text-transform: uppercase;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

            .btn-primary:hover {
                background-color: #0056b3;
                transform: scale(1.05);
            }

        .mybtn {
            background-color: #51b37f !important;
            color: white !important;
            width: auto !important;
        }

        .myarea {
            justify-content: center !important;
            display: flex !important;
            margin-top: 25px !important;
        }

    </style>
  </head>
<body style="padding: 5%;" ng-controller="FormController">
    <div class="row align-items-center">
        <!-- Arrow Icon aligned to the left -->
        <a class="col-md-1 text-start" style="font-size:35px;" ng-click="navtogenerateform()">
            <i class="bi bi-arrow-left"></i>
        </a>

        <!-- Centered Heading -->
        <div class="col-md-10 text-center">
            <h3>Dup.-Aff-A</h3>
        </div>
    </div>
    <div ng-if="hDiv" class="container my-5">
        <div class="card shadow-sm">
            <div class="card-body">
                <form name="gForm" ng-submit="genrateForm()">
                    <h4 class="card-title text-center mb-4" style="color:#51b37f;">Generate Form</h4>

                    <div class="row">
                        <!-- Select Customer Dropdown -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="seletedId" class="form-label">Select Customer</label>
                                <select class="form-select" id="seletedId" ng-options="f.id as f.name for f in docs" ng-model="seletedId" ng-change="loadCustomers(seletedId, heirId)">
                                    <option selected disabled value="">Select customer</option>
                                </select>
                            </div>
                        </div>

                        <!-- Select Heir Dropdown -->
                        <div class="col-md-4 mb-3" ng-show="legalheirlist">
                            <div class="form-group">
                                <label for="heirId" class="form-label">Select Heir</label>
                                <select class="form-select" id="heirId" ng-options="g.id as g.name for g in heir" ng-model="heirId" ng-change="loadCustomers(seletedId, heirId)">
                                    <option selected disabled value="">Select Heir</option>
                                </select>
                            </div>
                        </div>

                        <!-- Place -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="place" class="form-label">Place</label>
                                <input type="text" ng-model="data.place" class="form-control" placeholder="Place">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="selected" class="form-label">Select Certificate No</label>
                                <select class="form-select" ng-options="s as (s.certificateNo + ' - ' + s.actualQty + ' shares') for s in shares track by (s.certificateNo + '-' + s.actualQty)" ng-model="selected" ng-change="AddSelectedShare(selected)">
                                    <option selected disabled value="">Select Shares</option>
                                </select>
                            </div>
						</div>
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                {{message}}
                            </div>
                        </div>
                        </div>
                        <!-- Submit Button -->
                        <div class="col-md-4 text-center mt-4">
                        <button type="submit" ng-disabled="processdone" class="btn btn-primary px-4" style="background-color:#51b37f; color:white; border-radius: 5px;">
                                Generate Form
                            </button>
                        </div>
                    
                </form>
            </div>
        </div>
    </div>
    <div id="printForm">
    <h2
      style="
        padding-top: 3pt;
        /* padding-left: 213pt; */
        text-indent: 0pt;
        line-height: 180%;
        text-align: center;
      "
    >
      FORM –A AFFIDAVIT
    </h2>
    <h2 style="padding-left: 23pt; text-indent: 0pt; text-align: center">
      [For issuance of duplicate securities]
    </h2>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <div
      class="textbox"
      style="
        border: 1pt solid #000000;
        display: block;
        min-height: 14pt;
        /* width: 411pt; */
      "
    >
      <p
        class="s1"
        style="text-indent: 0pt; line-height: 13pt; text-align: center"
      >
        Note:
        <i
          ><b
            >This affidavit is to be executed in the presence of a Public
            Notary</b
          ></i
        >
      </p>
    </div>
    <p style="padding-top: 11pt; text-indent: 0pt; text-align: left"><br /></p>
    <p
      class="s3"
      style="padding-left: 23pt; text-indent: 0pt; text-align: center"
    >
      [To be submitted in non-judicial stamp paper of appropriate value]
    </p>
    <p style="padding-top: 9pt; text-indent: 0pt; text-align: left"><br /></p>
        <p style="padding-left: 43pt; text-indent: 0pt; text-align: left"  >
      I/We,
            <span class="s4" ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
                <span ng-style="{'color': data.firstAlive ? 'red' : 'inherit'}">{{ data.firstHolder}}</span>
                <span ng-if="data.secondHolder">
                    &
                    <span ng-style="{'color': data.secondAlive ? 'red' : 'inherit'}">
                        {{data.secondHolder}}
                    </span>
                </span>
                <span ng-if="data.thirdHolder">
                    &
                    <span ng-style="{'color': data.thirdAlive ? 'red' : 'inherit'}">
                        {{data.thirdHolder}}
                    </span>
                </span>
            </span>
            <span class="s4" ng-show="data.condition" ng-class="{'hide-print': !data.condition}">
                <span ng-repeat="h in data.heirs track by $index">
                    <span ng-style="{'color': h.dateOfDeath ? 'red' : 'inherit'}">
                        {{h.name}}</span><span ng-if="$index < data.heirs.length - 1"> & </span>
                </span>
            </span> SON/DA/HUS OF
            <span class="s4" ng-show="!data.condition" ng-class="{'hide-print': data.condition}">{{data.sonof}} </span><span class="s4" ng-show="data.condition" ng-class="{'hide-print': !data.condition}"> {{data.heirs[0].sonof}} </span>residing at<span class="s4" ng-show="!data.condition" ng-class="{'hide-print': data.condition}">{{data.address}}</span><span class="s4" ng-show="data.condition" ng-class="{'hide-print': !data.condition}">{{data.heirs[0].address}}</span><span class="s4"> </span> having Permanent Account No(s)
            <span class="s4" ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
                {{data.firstHolderpan}},
                {{data.secondHolderpan}},
                {{data.thirdHolderpan}}
            </span>
            <span class="s4" ng-show="data.condition" ng-class="{'hide-print': !data.condition}" ng-repeat="h in data.heirs">
                {{h.pan}},
            </span>do hereby solemnly affirm and state on oath as follows.
        </p>
  
    <p style="padding-top: 8pt; text-indent: 0pt; text-align: left"><br /></p>
    <ol id="l1">
      <li data-list-text="1.">
        <p
          style="
            padding-left: 43pt;
            text-indent: -14pt;
            line-height: 126%;
            text-align: justify;
          "
        >
          That I/We,
                    <span class="s4" ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
                        <span ng-style="{'color': data.firstAlive ? 'red' : 'inherit'}">{{ data.firstHolder}}</span>
                        <span ng-if="data.secondHolder">
                            &
                            <span ng-style="{'color': data.secondAlive ? 'red' : 'inherit'}">
                                {{data.secondHolder}}
                            </span>
                        </span>
                        <span ng-if="data.thirdHolder">
                            &
                            <span ng-style="{'color': data.thirdAlive ? 'red' : 'inherit'}">
                                {{data.thirdHolder}}
                            </span>
                        </span>
                    </span><span class="s4" ng-show="data.condition" ng-class="{'hide-print': !data.condition}">
                        <span ng-repeat="h in data.heirs track by $index">
                            <span ng-style="{'color': h.dateOfDeath ? 'red' : 'inherit'}">
                                {{h.name}}
                            </span><span ng-if="$index < data.heirs.length - 1"> & </span>
                        </span>
                    </span><span class="s6"> </span>(“all the shareholders”) hold the following
          (number of) securities under Folio no.
          <span class="s4">{{data.folioNo}} </span><span class="s6"> </span>in  <span class="s4">
                        {{data.officename}}
                    </span>(name of the company) in my/ our name as single holder / joint
          holder:
        </p>
      
        <p style="padding-top: 2pt; text-indent: 0pt; text-align: left">
          <br />
        </p>
        <table>
          <tr>
            <th>Company Name</th>
            <th>Folio No.</th>
            <th>No. of Securities Held</th>
            <th>Security Certificate No.</th>
            <th colspan="2">Distinctive Nos.</th>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>From</td>
            <td>To</td>
          </tr>
                    <tr ng-repeat="tmp in selectedShares">
                        <td>@* 1) *@ {{data.officename}}</td>
                        <td>{{tmp.folioNo}}</td>
                        <td>{{tmp.actualQty}}</td>
                        <td>{{tmp.certificateNo}}</td>
                        <td>{{tmp.distinctiveNosFrom}}</td>
                        <td>{{tmp.distinctiveNosTo}}</td>
        </tr>
        </table>
        <p style="padding-top: 3pt; text-indent: 0pt; text-align: left">
          <br />
        </p>
      </li>
      <li data-list-text="2.">
        <p
          style="
            padding-left: 43pt;
            text-indent: -14pt;
            line-height: 113%;
            text-align: justify;
          "
        >
          I/We
                    <span class="s4" ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
                        <span ng-style="{'color': data.firstAlive ? 'red' : 'inherit'}">{{ data.firstHolder}}</span>
                        <span ng-if="data.secondHolder">
                            &
                            <span ng-style="{'color': data.secondAlive ? 'red' : 'inherit'}">
                                {{data.secondHolder}}
                            </span>
                        </span>
                        <span ng-if="data.thirdHolder">
                            &
                            <span ng-style="{'color': data.thirdAlive ? 'red' : 'inherit'}">
                                {{data.thirdHolder}}
                            </span>
                        </span>
                    </span><span class="s4" ng-show="data.condition" ng-class="{'hide-print': !data.condition}">
                        <span ng-repeat="h in data.heirs track by $index">
                            <span ng-style="{'color': h.dateOfDeath ? 'red' : 'inherit'}">
                                {{h.name}}
                            </span><span ng-if="$index < data.heirs.length - 1"> & </span>
                        </span>
                    </span> further swear / solemnly declare that I/ we
          am/are applying for issue of duplicate certificate(s) to me/us on the
          ground that the original security(ies) certificate(s) has/have been
          misplaced / not found by me/us, despite a diligent search made by
          me/us in this behalf.
        </p>
        <p style="padding-top: 2pt; text-indent: 0pt; text-align: left">
          <br />
        </p>
      </li>
      <li data-list-text="3.">
        <p style="padding-left: 43pt; text-indent: -14pt; text-align: justify">
          I/We
                    <span class="s4" ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
                        <span ng-style="{'color': data.firstAlive ? 'red' : 'inherit'}">{{ data.firstHolder}}</span>
                        <span ng-if="data.secondHolder">
                            &
                            <span ng-style="{'color': data.secondAlive ? 'red' : 'inherit'}">
                                {{data.secondHolder}}
                            </span>
                        </span>
                        <span ng-if="data.thirdHolder">
                            &
                            <span ng-style="{'color': data.thirdAlive ? 'red' : 'inherit'}">
                                {{data.thirdHolder}}
                            </span>
                        </span>
                    </span><span class="s4" ng-show="data.condition" ng-class="{'hide-print': !data.condition}">
                        <span ng-repeat="h in data.heirs track by $index">
                            <span ng-style="{'color': h.dateOfDeath ? 'red' : 'inherit'}">
                                {{h.name}}
                            </span><span ng-if="$index < data.heirs.length - 1"> & </span>
                        </span>
                    </span> further swear/solemnly declare that the said securities are not sold or pledged or
            deposited by way of security to any person/company.
        </p>
       
        <p style="text-indent: 0pt; text-align: left"><br /></p>
      </li>
      <li data-list-text="4.">
        <p
          style="
            padding-left: 43pt;
            text-indent: -14pt;
            line-height: 113%;
            text-align: justify;
          "
        >
          I/We
                    <span class="s4" ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
                        <span ng-style="{'color': data.firstAlive ? 'red' : 'inherit'}">{{ data.firstHolder}}</span>
                        <span ng-if="data.secondHolder">
                            &
                            <span ng-style="{'color': data.secondAlive ? 'red' : 'inherit'}">
                                {{data.secondHolder}}
                            </span>
                        </span>
                        <span ng-if="data.thirdHolder">
                            &
                            <span ng-style="{'color': data.thirdAlive ? 'red' : 'inherit'}">
                                {{data.thirdHolder}}
                            </span>
                        </span>
                    </span><span class="s4" ng-show="data.condition" ng-class="{'hide-print': !data.condition}">
                        <span ng-repeat="h in data.heirs track by $index">
                            <span ng-style="{'color': h.dateOfDeath ? 'red' : 'inherit'}">
                                {{h.name}}
                            </span><span ng-if="$index < data.heirs.length - 1"> & </span>
                        </span>
                    </span><span class="s6"> </span>hereby further swear / solemnly declare that
          if, after the duplicate share certificate(s) is / are issued to us as
          aforesaid, the original security(ies) certificate(s) is / are at any
          time subsequently, found, recovered or traced by us or by anyone on
          our behalf, then, we unconditionally undertake not to deal with the
        said original share certificate(s) in any manner whatsoever (whether by physical transfer
        or dematerialization or as security or pledge) and further
        unconditionally undertake to promptly surrender the original share
        certificate(s) to the RTA / Company, for cancellation.
        </p>

        <p style="padding-top: 2pt; text-indent: 0pt; text-align: left">
          <br />
        </p>
      </li>
      <li data-list-text="5.">
        <p
          style="
            padding-left: 43pt;
            text-indent: -14pt;
            line-height: 112%;
            text-align: justify;
          "
        >
          I/We
                    <span class="s4" ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
                        <span ng-style="{'color': data.firstAlive ? 'red' : 'inherit'}">{{ data.firstHolder}}</span>
                        <span ng-if="data.secondHolder">
                            &
                            <span ng-style="{'color': data.secondAlive ? 'red' : 'inherit'}">
                                {{data.secondHolder}}
                            </span>
                        </span>
                        <span ng-if="data.thirdHolder">
                            &
                            <span ng-style="{'color': data.thirdAlive ? 'red' : 'inherit'}">
                                {{data.thirdHolder}}
                            </span>
                        </span>
                    </span><span class="s4" ng-show="data.condition" ng-class="{'hide-print': !data.condition}">
                        <span ng-repeat="h in data.heirs track by $index">
                            <span ng-style="{'color': h.dateOfDeath ? 'red' : 'inherit'}">
                                {{h.name}}
                            </span><span ng-if="$index < data.heirs.length - 1"> & </span>
                        </span>
                    </span><span class="s6"> </span>am/are making the above solemn declaration
          on oath with full knowledge of the fact that in the event the original
          security (ies) certificate(s) issued is /are found, recovered and
          traced by me/us and instead of surrendering the same is / are dealt
          with by me/us as aforesaid, the Company will be at liberty to adopt
          civil and / or criminal proceedings against me/us for my/our failure
          to promptly surrender the original security (ies) certificate(s), for
          cancellation and for breach of my/our solemn declaration and
          undertaking not to deal with the original security (ies)
          certificate(s) in any manner whatsoever as aforesaid at my/our entire
          risk as to cost and consequences.
        </p>
      </li>
    </ol>
    <p style="padding-top: 3pt; text-indent: 0pt; text-align: left"><br /></p>
    <p style="padding-top: 3pt; text-indent: 0pt; text-align: left"><br /></p>
    <p style="padding-left: 215pt; text-indent: 0pt; text-align: left">
      Signature of all deponents :<span style="color: #d9d9d9">X</span
      ><span class="s10">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
      
      <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <span class="s10" >
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
      
      <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      <span class="s10" >
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span
      >
    </p>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p
      style="
        padding-left: 356pt;
        text-indent: 0pt;
        line-height: 1pt;
        text-align: left;
      "
    />
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p
      style="
        padding-left: 356pt;
        text-indent: 0pt;
        line-height: 1pt;
        text-align: left;
      "
    />
    <h1
      style="
        padding-top: 1pt;
        padding-left: 23pt;
        text-indent: 0pt;
        text-align: center;
      "
    >
      VERIFICATION
    </h1>
    <p
      class="s3"
      style="
        padding-top: 10pt;
        padding-left: 43pt;
        text-indent: 0pt;
        line-height: 114%;
        text-align: left;
      "
    >
      We hereby solemnly affirm and state that what is stated herein above is
      true to our knowledge and nothing has been concealed therein and that we
      are competent to contract and entitled to rights and benefits of the above
      mentioned securities.
    </p>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p
      class="s3"
      style="
        padding-left: 43pt;
        text-indent: 0pt;
        line-height: 192%;
        text-align: left;
      "
           ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
      Deponent(s) (1)<span class="s11">
         @* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   *@
                <span ng-style="{'color': data.firstAlive ? 'red' : 'inherit'}">
                    {{data.firstHolder}}
               </span>
     
        </span
      ><br>(2)<span class="s11">
        @* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *@

                <span ng-style="{'color': data.secondAlive ? 'red' : 'inherit'}">
                    {{data.secondHolder}}
                </span>
        </span
      ><br>(3)<span class="s11">
        @* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *@

                <span ng-style="{'color': data.thirdAlive ? 'red' : 'inherit'}">
                    {{data.thirdHolder}}
                    </span>
        </span>
    </p>
    <p
      class="s3"
      style="
        padding-left: 43pt;
        text-indent: 0pt;
        line-height: 192%;
        text-align: left;
      "
           ng-show="data.condition" ng-class="{'hide-print': !data.condition}">
      Deponent(s) (1)<span class="s11">
         @* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   *@
                <span ng-style="{'color': data.heirs[0].dateOfDeath ? 'red' : 'inherit'}">
                    {{ data.heirs[0].name}}
               </span>
     
        </span
      ><br>(2)<span class="s11">
        @* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *@
                <span ng-style="{'color': data.heirs[1].dateOfDeath ? 'red' : 'inherit'}">
                {{ data.heirs[1].name}}
                </span>
        </span
      ><br>(3)<span class="s11">
        @* &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *@
                <span ng-style="{'color': data.heirs[2].dateOfDeath ? 'red' : 'inherit'}">
                {{ data.heirs[2].name}}
                </span>
        </span>
    </p>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p style="padding-left: 43pt; text-indent: 0pt; text-align: left">
      Solemnly affirmed at
      <span class="s4">
                 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
        </span
      >
    </p>
    <p
      style="
        padding-top: 11pt;
        padding-left: 43pt;
        text-indent: 0pt;
        text-align: left;
      "
    >
      Signature of the Deponent(s):
        X<span class="s4">
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  
              <br>.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
          </span><br>
  
    </p>
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p
      style="
        padding-left: 43pt;
        text-indent: 0pt;
        line-height: 1pt;
        text-align: left;
      "
    />
    <p style="padding-top: 2pt; text-indent: 0pt; text-align: left"><br /></p>
    <p
      style="
        padding-left: 43pt;
        text-indent: 0pt;
        line-height: 1pt;
        text-align: left;
      "
    />
    <p style="text-indent: 0pt; text-align: left"><br /></p>
    <p style="padding-left: 43pt; text-indent: 0pt; text-align: justify">
      Signed before me
    </p>
    <p style="padding-left: 43pt; text-indent: 0pt; text-align: left"><br /></p>
    <p style="text-indent: 0pt; text-align: left" />
    <p
      style="
        padding-left: 43pt;
        text-indent: 0pt;
        line-height: 194%;
        text-align: justify;
      "
    >
      Place:
      <span class="s4">
        {{data.place}} </span
      ><span class="s6"> </span><br>Date :
      <span class="s4">@* {{data.date | date:'__/MM/yyyy'}} *@<u>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;</u> </span><span class="s6"> </span><br>X
      <span class="s4"
      >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>
    </p>
    <p style="padding-top: 4pt; text-indent: 0pt; text-align: right">
      Signature of Notary with Official Seal of
    </p>
    <p style="padding-top: 1pt; text-indent: 0pt; text-align: right">
      Notary &amp; Regn. No.
    </p>
     </div>
    <div class="myarea">
        <button class="btn btn-store mybtn" ng-click="printDiv('printForm')">PRINT</button>
    </div>
  </body>
    <script>
    angular.module('Stock-CMS', []).controller('FormController', function ($scope, $http,$timeout) {
        $scope.customers = [];
         $scope.data = undefined;
         $scope.selected = null;
         $scope.selectedShares = [];
            $scope.hDiv = true;
            var params = new URLSearchParams(window.location.search);
            var id = params.get('id');
            var id2 = params.get('id2');
        var isProcessing = false;
        $scope.processdone = false;

    $scope.AddSelectedShare = function(shr) {
            if (shr) {
      // Expect shr to be an object containing certificateNo and actualQty
      var sShare = $scope.shares.find(
        x => x.certificateNo === shr.certificateNo && x.actualQty === shr.actualQty
      );

      if (sShare) {
        // Add the selected share to the selectedShares list
        $scope.selectedSharesQty += sShare.actualQty;
        $scope.selectedShares.push(sShare);

        // Remove the selected share from the available shares list
        $scope.shares = $scope.shares.filter(
          x => !(x.certificateNo === shr.certificateNo && x.actualQty === shr.actualQty)
        );

        // Reset the selected model
        $scope.selected = null;
        $scope.message = shr.certificateNo + ' (' + shr.actualQty + ' qty) is Added';
      }
    }
    };

         // Load Customers
         $scope.loadCustomers = function (sid,hid) {
             if(id){
                 hideLoader();
                 $scope.hDiv = true;
            $http.get('/Enquiry/GetStocksById/'+id).then(function (response) {
                var result = response.data;
                $http.get('/Form/GetHolderByStockId/' +  id).then(function (response) {
                     $scope.docs = response.data;
                    var doc = $scope.docs.find(x => x.id === sid);

                    var isDeceased = !!doc?.dateOfDeath;

                if (isDeceased) {
                    $scope.heirId = null;
    $scope.legalheirlist = isDeceased;
    document.getElementById('heirId').value = '';
                    $http.get('/LegalHeir/GetClaimentLegalHeir/' + doc.id).then(function (response) {
                        $scope.heir = response.data;
                        var heirs = response.data.find(x => x.id === hid); // `hid` needs to be in scope
                        var holder = heirs;

                        populateData(holder, result,$scope.heir,isDeceased,doc);
                    }, function (error) {
                        console.error('Error loading legal heir data:', error);
                        hideLoader();
                    });
                } else {
                    $scope.heirId = null;
    $scope.data = null;
    $scope.legalheirlist = isDeceased;
    document.getElementById('heirId').value = '';
                    var holder = doc;
                    populateData(holder, result,$scope.heir,isDeceased,doc);
                }

                
                hideLoader();
                }, function (error) {
                    console.error('Error loading Docs:', error);
                    hideLoader();
                });
            }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
            });
            }

            if(id2){
                 $scope.hDiv = false;
            $http.get('/Form/GetGenratedFormById/'+id2).then(function (response) {
                var result = response.data;
                var obj = JSON.parse(result.jsonString);
                $scope.data = {
                    docid: obj.docid,
                    customerName: obj.customerName,
                    address: obj.address,
                    folioNo: obj.folioNo,
                    qty: obj.qty,
                    sonof: obj.sonof,
                    accountno: obj.accountno,
                    relationship: obj.relationship,
                    jsondata: obj.jsondata,
                    selectedshareslist: obj.selectedshareslist, 
                    officename: obj.officename,
                    heirs: obj.heirs,
                       firstHolder:obj.firstHolder,
    secondHolder:obj.secondHolder,
    thirdHolder:obj.thirdHolder,
		firstHolderpan: obj.firstHolderpan,
		secondHolderpan: obj.secondHolderpan,
		thirdHolderpan: obj.thirdHolderpan,
                    place: obj.place,
                    date: new Date(obj.date),
                    condition: obj.condition,
                    heirs: obj.heirs,
                    firstAlive: obj.firstAlive,
                    secondAlive: obj.secondAlive,
                    thirdAlive: obj.thirdAlive,
                };
                $scope.docs = $scope.data.holders;
				$scope.selectedShares = JSON.parse($scope.data.selectedshareslist);
                $scope.shares = JSON.parse($scope.data.jsondata);
                      id = result.stockId;
                checkData();
                hideLoader();
            }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
            });
            }

            function populateData(holder, result, heirlist,isDeceased,doc) {
                 $scope.data = {
                    docid: holder.id,
                    customerName : holder.name,
                    address : holder.addressAsPerAadhar,
                    sonof: holder.relativesName,
                    relationship: holder.relationship,
                    accountno:holder.pan,
                    jsondata: result.stockJson,
                    qty: result.qty,
                    folioNo : result.folioNo,
                    officename : result.companyName,
                    firstHolder :result.firstHolderName,
                    secondHolder:result.secondHolderName,
                    thirdHolder: result.thirdHolderName,
                    firstHolderpan: result.firstHolderData ? result.firstHolderData.pan : '',
                    secondHolderpan: result.secondHolderData ? result.secondHolderData.pan : '',
                    thirdHolderpan: result.thirdHolderData ? result.thirdHolderData.pan : '',
                    firstAlive: result?.firstHolderData?.dateOfDeath,
                    secondAlive: result?.secondHolderData?.dateOfDeath,
                    thirdAlive: result?.thirdHolderData?.dateOfDeath,
                    place:'Vadodara',
                    date: new Date(),
                    condition: isDeceased,
                     heirs: isDeceased ? heirlist.map(h => ({ name: h.name, pan: h.pan, address: h.addressAsPerAadhar, sonof: doc.name, dateOfDeath: h.dateOfDeath})) : [],
                };
                $scope.shares = JSON.parse($scope.data.jsondata);
            }
        };

                        function checkData() {
        if ($scope.data !== undefined) {
            // Delay the printDiv execution until the next digest cycle
            $timeout(function() {
                $scope.printDiv('printForm');
            }, 0);  // 0 delay to ensure it runs after the view update
        } else {
            setTimeout(checkData, 1000); // Retry after 1000ms if data is not yet available
        }
    }

          $scope.calculateAge = function(dob) {
              if (!dob) {
                return '';
              }
              var birthDate = new Date(dob);
              var currentDate = new Date();
              var age = currentDate.getFullYear() - birthDate.getFullYear();
              var m = currentDate.getMonth() - birthDate.getMonth();

              // Adjust age if the current month is before the birth month or if the birth day hasn't occurred yet
              if (m < 0 || (m === 0 && currentDate.getDate() < birthDate.getDate())) {
                age--;
              }
              return age;
          };

        //Genrate Form
         $scope.genrateForm = function () {
             if(id){
                 $scope.processdone = true;
                  if($scope.data.jsondata == undefined){
                     Swal.fire({
                            title: 'Error!',
                            text:  'Please Enter Stock Qty data in Custome\'s Stock Page',
                            icon: 'error',
                            confirmButtonText: 'Try Again'
                        });
                        $scope.processdone = false;
                return;
                 }

                 var arr = angular.copy($scope.doc);
                 $scope.data.holders = JSON.stringify(arr,null,2);

                 $scope.data.selectedshareslist= JSON.stringify($scope.selectedShares);
             let jsonString = JSON.stringify($scope.data, null, 2);
             var data ={
                 formName : 'Dup Aff-A',
                 StockId : id,
                 url : `/Form/DupAffA?id2=`,
                 jsonString : jsonString,
                 ClientName: $scope.data.customerName,
                  ClientId: $scope.data.docid,
                 IsActive : true
             }

             const url = '/Form/GenrateForm';
                $http.post(url, data).then(function (response) {
                    if (response.data.success) {
                        Swal.fire({
                            title: 'Success',
                            text: response.data.message || 'Operation successful!',
                            icon: 'success',
                            confirmButtonText: 'OK'
                        });
                        $scope.processdone = false;
                        // $scope.loadCustomers();
                        window.open(response.data.data.url + response.data.data.id,'_self')
                    } else {
                       Swal.fire({
                         title: 'This Form is already Exits',
                         text: "do you want to go to that form?",
                         icon: 'warning',
                         showCancelButton: true,
                         confirmButtonText: 'Yes',
                         cancelButtonText: 'No'
                     }).then((result) => {
                         if (result.isConfirmed) {
                             window.open(response.data.message, '_self');
                         }
                 });
                 $scope.processdone = false;
                    }
                    isProcessing = false;
                }, function (error) {
                    Swal.fire({
                        title: 'Error',
                        text: 'An error occurred.',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                    $scope.processdone = false;
                    isProcessing = false;
                });
            //console.log(dataString);
            }
         }

             $scope.navtogenerateform = function () {
        window.open('/Form/GenerateForm/'+id, '_self');
    };


        // Load Customers
        // $scope.loadCustomers = function () {
        //     $http.get('/Master/GetCustomers').then(function (response) {
        //         $scope.customers = response.data[0];
        //         hideLoader();
        //     }, function (error) {
        //         console.error('Error loading customers:', error);
        //         hideLoader();
        //     });
        // };

        // $scope.loadDocs = function () {
        //     if (true) {
        //         $http.get('/doc/getDocs/' + 1).then(function (response) {
        //             $scope.docs = response.data;
        //             hideLoader();
        //         }, function (error) {
        //             console.error('Error loading Docs:', error);
        //             hideLoader();
        //         });
        //     }
        // };

        //Function
        $scope.printDiv = function (divId) {
            var css ='<style type="text/css">* {margin: 0; padding: 0; text-indent: 0;} h2 {color: black; font-family: Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt;} .s1 {color: black; font-family: Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;} .s3 {color: black; font-family: Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;} p {color: black; font-family: Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; margin: 0pt;} .s4 {color: black; font-family: "Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 11pt;} .s6 {color: black; font-family: "Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt;} .s7 {color: black; font-family: Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt;} .s8 {color: black; font-family: Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt;} .s10 {color: #d9d9d9; font-family: "Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 11pt;} h1 {color: black; font-family: Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt;} .s11 {color: black; font-family: "Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 12pt;} .s12 {color: black; font-family: "Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt;} li {display: block;} #l1 {padding-left: 0pt; counter-reset: c1 1;} #l1 > li > *:first-child:before {counter-increment: c1; content: counter(c1, decimal) ". "; color: black; font-family: Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt;} #l1 > li:first-child > *:first-child:before {counter-increment: c1 0;} table, tbody {vertical-align: top; overflow: visible;} table {border-collapse: collapse; margin-left: 43.5pt;} th, td {border: 1px solid #babdbf; padding: 10px;} th {width: 100pt;} td:nth-child(2) {width: 49pt;} td:nth-child(3) {width: 57pt;} td:nth-child(4) {width: 78pt;} td:nth-child(5), td:nth-child(6) {width: 70.5pt} @@media print {.hide-print {display: none !important;}}</style >';
            var innerContents = document.getElementById(divId).innerHTML;
            var popupWinindow = window.open('', '_blank', 'width=600,height=700,scrollbars=no,menubar=no,toolbar=no,location=no,status=no,titlebar=no');
            popupWinindow.document.open();
            popupWinindow.document.write('<html><head><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">' + css + '</ head > <body style="padding-left: 0 5% 0 5%;"onload="window.print()">' + innerContents + '</html>');
            popupWinindow.document.close();
        };
        //Initialize
        $scope.loadCustomers();
        // $scope.loadDocs();
    });
</script>
</html>
