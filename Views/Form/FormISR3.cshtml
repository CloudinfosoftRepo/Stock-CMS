<html lang="en" ng-app="Stock-CMS">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Form-ISR-3</title>
        <meta name="author" content="A" />
        <style type="text/css">
            * {
                margin: 0;
                padding: 0;
                text-indent: 0;
            }
            h1 {
                color: black;
                font-family: Arial, sans-serif;
                font-style: normal;
                font-weight: bold;
                text-decoration: none;
                font-size: 18pt;
            }
            h2 {
                color: black;
                font-family: Calibri, sans-serif;
                font-style: normal;
                font-weight: bold;
                text-decoration: none;
                font-size: 14pt;
            }
            .s1 {
                color: black;
                font-family: Arial, sans-serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 10pt;
            }
            .s2 {
                color: black;
                font-family: Calibri, sans-serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 10pt;
            }
            p {
                color: black;
                font-family: Calibri, sans-serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 12pt;
                margin: 0pt;
            }
            .s3 {
                color: black;
                font-family: Calibri, sans-serif;
                font-style: normal;
                font-weight: bold;
                text-decoration: none;
                font-size: 12pt;
            }
            .s4 {
                color: black;
                font-family: Calibri, sans-serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 12pt;
            }
            table,
            tbody {
                vertical-align: top;
                overflow: visible;
            }


        .card {
            border-radius: 10px;
            overflow: hidden;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .form-select {
            width: 100%;
            padding: 0.75rem;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 1rem;
        }

        .btn-primary {
            width: 100%;
            padding: 12px 16px;
            text-transform: uppercase;
            font-weight: bold;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

            .btn-primary:hover {
                background-color: #0056b3;
                transform: scale(1.05);
            }

        .mybtn {
            background-color: #003980 !important;
            color: white !important;
            width: auto !important;
        }

        .myarea {
            justify-content: center !important;
            display: flex !important;
            margin-top: 25px !important;
        }
        </style>
    </head>
    <body style="padding: 5%;" ng-controller="FormController">
    <div class="row align-items-center">
        <!-- Arrow Icon aligned to the left -->
        <a class="col-md-1 text-start" style="font-size:35px;" ng-click="navtogenerateform()">
            <i class="bi bi-arrow-left"></i>
        </a>

        <!-- Centered Heading -->
        <div class="col-md-10 text-center">
            <h3>Form-ISR-3</h3>
        </div>
    </div>
    <div ng-if="hDiv" class="container my-5">
        <div class="card shadow-sm">
            <div class="card-body">
                <form name="gForm" ng-submit="genrateForm()">
                    <h4 class="card-title text-center mb-4" style="color:#003980;">Generate Form</h4>

                    <div class="row">
                        <!-- Select Customer Dropdown -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="seletedId" class="form-label">Select Customer</label>
                                <select class="form-select" id="seletedId" ng-options="f.id as f.name for f in docs" ng-model="seletedId" ng-change="loadCustomers(seletedId, heirId)">
                                    <option selected disabled value="">Select customer</option>
                                </select>
                            </div>
                        </div>

                        <!-- Select Heir Dropdown -->
                        <div class="col-md-4 mb-3" ng-show="legalheirlist">
                            <div class="form-group">
                                <label for="heirId" class="form-label">Select Heir</label>
                                <select class="form-select" id="heirId" ng-options="g.id as g.name for g in heir" ng-model="heirId" ng-change="loadCustomers(seletedId, heirId)">
                                    <option selected disabled value="">Select Heir</option>
                                </select>
                            </div>
                        </div>

                        <!-- Nature of Security -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="natureofsecurity" class="form-label">Nature of Security</label>
                                <input type="text" ng-model="data.natureofsecurity" class="form-control" placeholder="Nature of Security">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <!-- Witness Name -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="witnessname" class="form-label">Witness Name</label>
                                <input type="text" ng-model="data.witnessname" class="form-control" placeholder="Witness Name">
                            </div>
                        </div>
                    
                        <!-- Witness Address -->
                        <div class="col-md-4 mb-3">
                            <div class="form-group">
                                <label for="witnessaddress" class="form-label">Witness Address</label>
                                <textarea id="address" ng-model="data.witnessaddress"
                                          class="form-control" style="height: 100px;" placeholder="Witness Address" rows="5" cols="5" required></textarea>
                            </div>
                        </div>
                    </div>
                    <!-- Submit Button -->
                    <div class="col-md-4 text-center mt-4">
                        <button type="submit" ng-disabled="processdone" class="btn btn-primary px-4" style="background-color:#003980; color:white; border-radius: 5px;">
                            Generate Form
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div id="printForm">
        <h1 style="padding-top: 3pt; padding-left: 16pt; text-indent: 0pt; text-align: center;">Form ISR - 3</h1>
        <h2 style="padding-top: 8pt; padding-left: 63pt; text-indent: -50pt; line-height: 108%; text-align: left;">Declaration Form for Opting-out of Nomination by holders of physical securities in Listed Companies</h2>
        <p class="s1" style="padding-left: 16pt; text-indent: 0pt; line-height: 114%; text-align: center;">
            (
            <span class="s2">
                see SEBI circular No. SEBI/HO/MIRSD/MIRSD_RTAMB/P/CIR/2021/655 dated November 03, 2021 on Commonand Simplified Norms for processing investor’s service request by RTAs and norms for furnishing PAN, KYC details and Nomination
            </span>
            )
        </p>
        <p style="padding-top: 3pt; text-indent: 0pt; text-align: left;"><br /></p>
        <p style="padding-left: 11pt; text-indent: 0pt; line-height: 108%; text-align: justify;">
            [Under Section 72 r/w Section 24 (1) (a) of Companies Act, 2013 r/w Section 11(1) and 11Bof SEBI Act, 1992 and Clause C in Schedule VII and Regulation 101 of SEBI (Listing Obligationsand Disclosure Requirements) Regulations,
            2015)]
        </p>
        <p style="padding-top: 1pt; text-indent: 0pt; text-align: left;"><br /></p>
        <p style="padding-left: 11pt; text-indent: 0pt; text-align: justify;">Name of the Company : {{data.officename}}</p>
        <p style="padding-top: 1pt; padding-left: 11pt; text-indent: 0pt; text-align: justify;">Registered Address of the Company: {{data.officeaddress}}</p>
        <p style="padding-top: 10pt; text-indent: 0pt; text-align: left;"><br /></p>
        <p style="padding-left: 11pt; text-indent: 0pt; line-height: 108%; text-align: justify;">
            I / we <u ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
                {{data.firstHolder}},
                {{data.secondHolder}},
                {{data.thirdHolder}}
            </u><u ng-show="data.condition" ng-class="{'hide-print': !data.condition}" ng-repeat="h in data.heirs">
                {{h.name}},
            </u> the holder(s) of the securities particulars of which are given hereunder,
            <u>
                <i><b> do not wish to nominate </b></i>
            </u>
            any person(s) in whom shall vest, all the rights in respect of such securities in the event of my /our death.
        </p>
        <p style="padding-top: 7pt; padding-left: 13pt; text-indent: 0pt; text-align: justify;">PARTICULARS OF THE SECURITIES (in respect of which nomination is being opted out)</p>
        <p style="text-indent: 0pt; text-align: left;"><br /></p>
        <table style="border-collapse: collapse; margin-left: 6.114pt;" cellspacing="0">
            <tr style="height: 30pt;">
                <td
                    style="
                        width: 90pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p class="s3" style="padding-left: 21pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Nature of Securities</p>
                </td>
                <td
                    style="
                        width: 90pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p class="s3" style="padding-left: 22pt; text-indent: 0pt; text-align: left;">Folio No.</p>
                </td>
                <td
                    style="
                        width: 90pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p class="s3" style="padding-left: 21pt; text-indent: 8pt; line-height: 14pt; text-align: left;">No. of Securities</p>
                </td>
                <td
                    style="
                        width: 91pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p class="s3" style="padding-left: 9pt; text-indent: 0pt; text-align: left;">Certificate No.</p>
                </td>
                <td
                    style="
                        width: 90pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p class="s3" style="padding-left: 8pt; text-indent: 0pt; text-align: left;">Distinctive No.</p>
                </td>
            </tr>
            <tr style="height: 15pt;" ng-repeat="tmp in shares">
                <td
                    style="
                        width: 90pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p style="text-indent: 0pt; text-align: left;">{{data.natureofsecurity}}</p>
                </td>
                <td
                    style="
                        width: 90pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p style="text-indent: 0pt; text-align: left;">{{tmp.folioNo}}</p>
                </td>
                <td
                    style="
                        width: 90pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p style="text-indent: 0pt; text-align: left;">{{tmp.actualQty}}</p>
                </td>
                <td
                    style="
                        width: 91pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p style="text-indent: 0pt; text-align: left;">{{tmp.certificateNo}}</p>
                </td>
                <td
                    style="
                        width: 90pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p style="text-indent: 0pt; text-align: left;">{{tmp.distinctiveNosFrom}} - {{tmp.distinctiveNosTo}}</p>
                </td>
            </tr>
        </table>
        <p style="text-indent: 0pt; text-align: left;"><br /></p>
        <p style="padding-left: 11pt; text-indent: 0pt; line-height: 108%; text-align: justify;">
            I/ we understand the issues involved in non-appointment of nominee(s) and further are aware that in case of my / our death, my / our legal heir(s) / representative(s) are requiredto furnish the requisite documents / details,
            including, Will or documents issued by the Court like Decree or Succession Certificate or Letter of Administration / Probate of Will or any other document as may be prescribed by the competent authority, for claiming my /
            ouraforesaid securities.
        </p>
        <p style="text-indent: 0pt; text-align: left;"><br /></p>
        <div ng-show="!data.condition" ng-class="{'hide-print': data.condition}">
        <p style="padding-top: 2pt; padding-left: 11pt; text-indent: 0pt; line-height: 213%; text-align: left;">Name(s) and Address of Security holders(s) ature(s)Sole / First Holder Name</p>
        <p style="padding-top: 1pt; text-indent: 0pt; text-align: left;">{{data.firstHolder}}<br />{{data.firstHolderaddress}}<br /><br /></p>
        <p style="padding-left: 11pt; text-indent: 0pt; text-align: left;">Second Holder Name</p>
        <p style="text-indent: 0pt; text-align: left;">{{data.secondHolder}}<br />{{data.secondHolderaddress}}<br /><br /></p>
        <p style="padding-left: 11pt; text-indent: 0pt; text-align: left;">Third Holder Name</p>
        <p style="padding-top: 3pt; text-indent: 0pt; text-align: left;">{{data.thirdHolder}}<br />{{data.thirdHolderaddress}}<br /></p>
        <p style="padding-left: 11pt; text-indent: 0pt; text-align: left;">Sign</p>
        </div>
        <div ng-show="data.condition" ng-class="{'hide-print': !data.condition}" ng-repeat="h in data.heirs">
            <p style="padding-left: 11pt; text-indent: 0pt; text-align: left;">Claiment Name</p>
            <p style="padding-top: 3pt; text-indent: 0pt; text-align: left;">{{h.name}}<br />{{h.addressAsPerAadhar}}<br /><br /></p>
            <p style="padding-left: 11pt; text-indent: 0pt; text-align: left;">Sign</p>
        </div>
        <p style="padding-top: 4pt; text-indent: 0pt; text-align: left;"><br /></p>
        <table style="border-collapse: collapse; margin-left: 6.114pt;" cellspacing="0">
            <tr style="height: 15pt;">
                <td
                    style="
                        width: 226pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p class="s4" style="padding-left: 5pt; text-indent: 0pt; line-height: 14pt; text-align: left;">Name and Address of Witness</p>
                </td>
                <td
                    style="
                        width: 225pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p class="s4" style="padding-right: 4pt; text-indent: 0pt; line-height: 14pt; text-align: right;">Signature</p>
                </td>
            </tr>
            <tr style="height: 59pt;">
                <td
                    style="
                        width: 226pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p style="text-indent: 0pt; text-align: left;">{{data.witnessname}}, <br /> {{data.witnessaddress}}</p>
                </td>
                <td
                    style="
                        width: 225pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-right-style: solid;
                        border-right-width: 1pt;
                    "
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
            </tr>
        </table>
    </div>
    <div class="myarea">
        <button class="btn btn-store mybtn" ng-click="printDiv('printForm')">PRINT</button>
    </div>
    </body>
<script>
    angular.module('Stock-CMS', []).controller('FormController', function ($scope, $http,$timeout) {
        $scope.customers = [];
        $scope.data = undefined;
            $scope.hDiv = true;
            var params = new URLSearchParams(window.location.search);
            var id = params.get('id');
            var id2 = params.get('id2');
        var isProcessing = false;
        $scope.processdone = false;

        // showLoader();

         // Load Customers
         $scope.loadCustomers = function (sid,hid) {
             if(id){
                 hideLoader();
                 $scope.hDiv = true;
            $http.get('/Enquiry/GetStocksById/'+id).then(function (response) {
                var result = response.data;
                $http.get('/Form/GetHolderByStockId/' +  id).then(function (response) {
                     $scope.docs = response.data;
                    var doc = $scope.docs.find(x => x.id === sid);

                    var isDeceased = !!doc?.dateOfDeath;

                if (isDeceased) {
                    $scope.heirId = null;
    $scope.legalheirlist = isDeceased;
    document.getElementById('heirId').value = '';
                    $http.get('/LegalHeir/GetClaimentLegalHeir/' + doc.id).then(function (response) {
                        $scope.heir = response.data;
                        var heirs = response.data.find(x => x.id === hid); // `hid` needs to be in scope
                        var holder = heirs;

                        populateData(holder, result,$scope.heir,isDeceased);
                    }, function (error) {
                        console.error('Error loading legal heir data:', error);
                        hideLoader();
                    });
                } else {
                    $scope.heirId = null;
    $scope.data = null;
    $scope.legalheirlist = isDeceased;
    document.getElementById('heirId').value = '';
                    var holder = doc;
                    populateData(holder, result,$scope.heir,isDeceased);
                }

                hideLoader();
                }, function (error) {
                    console.error('Error loading Docs:', error);
                    hideLoader();
                });
            }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
            });
            }

            if(id2){
                 $scope.hDiv = false;
            $http.get('/Form/GetGenratedFormById/'+id2).then(function (response) {
                var result = response.data;
                var obj = JSON.parse(result.jsonString);
                $scope.data = {
                    docid: obj.docid,
                    customerName: obj.customerName,
                    address: obj.address,
                    natureofsecurity: obj.natureofsecurity,
                    folioNo: obj.folioNo,
                    qty: obj.qty,
                    jsondata: obj.jsondata,
                    officename: obj.officename,
                    officeaddress: obj.officeaddress,
                    firstHolder: obj.firstHolder,
                    secondHolder:obj.secondHolder,
                    thirdHolder:obj.thirdHolder,
                    firstHolderaddress:obj.firstHolderaddress,
                    secondHolderaddress:obj.secondHolderaddress,
                    thirdHolderaddress:obj.thirdHolderaddress,
                    witnessname: obj.witnessname,
                    witnessaddress: obj.witnessaddress,
                    condition: obj.condition,
					heirs: obj.heirs,
                };
                                id = result.stockId;
                                $scope.shares = JSON.parse($scope.data.jsondata);
                checkData();
                hideLoader();
            }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
            });
            }

            function populateData(holder, result, heirlist,isDeceased) {
                $scope.data = {
                    docid: holder.id,
                    customerName : holder.name,
                    officename : result.companyName,
                    address : holder.addressAsPerAadhar,
                    natureofsecurity: 'Equity',
                    jsondata: result.stockJson,
                    qty: result.qty,
                    folioNo : result.folioNo,
                    officeaddress: result.company.companyAddress,
                    firstHolder :result.firstHolderName,
                   secondHolder:result.secondHolderName,
                   thirdHolder: result.thirdHolderName,
                    firstHolderaddress: result.firstHolderData.addressAsPerAadhar,
                    secondHolderaddress: result.secondHolderData ? result.secondHolderData.addressAsPerAadhar : '',
                    thirdHolderaddress: result.thirdHolderData ? result.thirdHolderData.addressAsPerAadhar : '',
                    witnessname: 'Shreyash Chhagani',
                    witnessaddress: 'B204 Ratnadeep Greens Apartments, Nr. M M Vohra show room, Dabhoi Road Somatalav, Vadodara, Gujarat, India 390025',
                    condition: isDeceased,
                     heirs: isDeceased ? heirlist.map(h => ({ name: h.name, address: h.addressAsPerAadhar })) : [],
                };
                $scope.shares = JSON.parse($scope.data.jsondata);
            }
        };

                        function checkData() {
        if ($scope.data !== undefined) {
            // Delay the printDiv execution until the next digest cycle
            $timeout(function() {
                $scope.printDiv('printForm');
            }, 0);  // 0 delay to ensure it runs after the view update
        } else {
            setTimeout(checkData, 1000); // Retry after 1000ms if data is not yet available
        }
    }

         $scope.calculateAge = function(dob, deathDate) {
        if (!dob) {
            return '';
        }

        var birthDate = new Date(dob);
        var currentDate = new Date();
        var age = currentDate.getFullYear() - birthDate.getFullYear();
        var m = currentDate.getMonth() - birthDate.getMonth();

        if (m < 0 || (m === 0 && currentDate.getDate() < birthDate.getDate())) {
            age--;
        }

        // If deathDate is provided, calculate age at the time of death
        if (deathDate) {
            var deathDateObj = new Date(deathDate);
            age = deathDateObj.getFullYear() - birthDate.getFullYear();
            var mDeath = deathDateObj.getMonth() - birthDate.getMonth();

            if (mDeath < 0 || (mDeath === 0 && deathDateObj.getDate() < birthDate.getDate())) {
                age--;
            }
            return age;
            // return age + ' (deceased)';
        }

        return age;
    };

        //Genrate Form
         $scope.genrateForm = function () {
             if(id){
                 $scope.processdone = true;
                  if($scope.data.jsondata == undefined){
                     Swal.fire({
                            title: 'Error!',
                            text:  'Please Enter Stock Qty data in Custome\'s Stock Page',
                            icon: 'error',
                            confirmButtonText: 'Try Again'
                        });
                        $scope.processdone = false;
                return;
                 }
             let jsonString = JSON.stringify($scope.data, null, 2);
             var data ={
                 formName : 'Form ISR 3',
                 StockId : id,
                 url : `/Form/FormISR3?id2=`,
                 jsonString : jsonString,
                 ClientName: $scope.data.customerName,
                  ClientId: $scope.data.docid,
                 IsActive : true
             }

             const url = '/Form/GenrateForm';
                $http.post(url, data).then(function (response) {
                    if (response.data.success) {
                        Swal.fire({
                            title: 'Success',
                            text: response.data.message || 'Operation successful!',
                            icon: 'success',
                            confirmButtonText: 'OK'
                        });
                        $scope.processdone = false;
                        // $scope.loadCustomers();
                                                window.open(response.data.data.url + response.data.data.id,'_self')

                    } else {
                        Swal.fire({
                         title: 'This Form is already Exits',
                         text: "do you want to go to that form?",
                         icon: 'warning',
                         showCancelButton: true,
                         confirmButtonText: 'Yes',
                         cancelButtonText: 'No'
                     }).then((result) => {
                         if (result.isConfirmed) {
                             window.open(response.data.message, '_self');
                         }
                 });
                 $scope.processdone = false;
                    }
                    isProcessing = false;
                }, function (error) {
                    Swal.fire({
                        title: 'Error',
                        text: 'An error occurred.',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                    $scope.processdone = false;
                    isProcessing = false;
                });
            //console.log(dataString);
            }
         }

             $scope.navtogenerateform = function () {
        window.open('/Form/GenerateForm/'+id, '_self');
    };

        // Load Customers
        // $scope.loadCustomers = function () {
        //     $http.get('/Master/GetCustomers').then(function (response) {
        //         $scope.customers = response.data[0];
        //         hideLoader();
        //     }, function (error) {
        //         console.error('Error loading customers:', error);
        //         hideLoader();
        //     });
        // };

        // $scope.loadDocs = function () {
        //     if (true) {
        //         $http.get('/doc/getDocs/' + 1).then(function (response) {
        //             $scope.docs = response.data;
        //             hideLoader();
        //         }, function (error) {
        //             console.error('Error loading Docs:', error);
        //             hideLoader();
        //         });
        //     }
        // };

        //Function
        $scope.printDiv = function (divId) {
                        var css ='<style type="text/css"> *{margin:0;padding:0;text-indent:0}h1{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:18pt}h2{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:14pt}.s1{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:10pt}.s2{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:10pt}p{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt;margin:0pt}.s3{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:12pt}.s4{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}table,tbody{vertical-align:top;overflow:visible} @@media print {.hide-print {display: none !important;}} </style>';
            var innerContents = document.getElementById(divId).innerHTML;
            var popupWinindow = window.open('', '_blank', 'width=600,height=700,scrollbars=no,menubar=no,toolbar=no,location=no,status=no,titlebar=no');
            popupWinindow.document.open();
            popupWinindow.document.write('<html><head><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">' + css + '</ head > <body style="padding-left: 0 5% 0 5%;" onload="window.print()">' + innerContents + '</html>');
            popupWinindow.document.close();
        };
        //Initialize
        $scope.loadCustomers();
        // $scope.loadDocs();
    });
</script>
</html>
