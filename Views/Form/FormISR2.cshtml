<html lang="en" ng-app="Stock-CMS">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Form-ISR-2</title>
        <meta name="author" content="Manjesh Roy S" />
        <style type="text/css">
            * {
                margin: 0;
                padding: 0;
                text-indent: 0;
            }
            h1 {
                color: black;
                font-family: Arial, sans-serif;
                font-style: normal;
                font-weight: bold;
                text-decoration: none;
                font-size: 18pt;
            }
            p {
                color: black;
                font-family: Calibri, sans-serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 10pt;
                margin: 0pt;
            }
            h2 {
                color: black;
                font-family: Arial, sans-serif;
                font-style: normal;
                font-weight: bold;
                text-decoration: none;
                font-size: 12pt;
            }
            .s1 {
                color: black;
                font-family: Calibri, sans-serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 11pt;
            }
            .s2 {
                color: black;
                font-family: Calibri, sans-serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 12pt;
            }
            .s3 {
                color: black;
                font-family: Calibri, sans-serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 8pt;
                vertical-align: 4pt;
            }
            .s4 {
                color: black;
                font-family: Calibri, sans-serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 12pt;
                vertical-align: -1pt;
            }
            .s5 {
                color: black;
                font-family: Calibri, sans-serif;
                font-style: normal;
                font-weight: normal;
                text-decoration: none;
                font-size: 8pt;
                vertical-align: 3pt;
            }
            table,
            tbody {
                vertical-align: top;
                overflow: visible;
            }
        </style>
    </head>
<body style="padding-left: 8%;" ng-controller="FormController">
    <div ng-if="hDiv">
        <form name="gForm" ng-submit="genrateForm()">
            <div class="row">
                @* <div class="form-group mb-3"> *@
                @*     <label for="seletedid" class="form-label">select customer</label> *@
                @*     <select class="form-select w-auto" ng-options="f.id as f.name for f in doc" ng-model="seletedid" ng-change="loadCustomers(seletedid)"> *@
                @*         <option selected disabled value="">Select customer</option> *@
                @*     </select> *@
                @* </div> *@
                @* <div class="col-md-4"> *@
                <div class="form-group mb-3 col-md-3">
                    <label for="branch" class="form-label">Branch</label>
                    <input type="text" ng-model="data.branch" class="form-control search-orders" placeholder="Branch">
                </div>
                <div class="form-group mb-3 col-md-3">
                    <label for="bankaddress" class="form-label">Bank Address</label>
                    <textarea id="address" ng-model="data.bankaddress"
                              class="form-control" style="height: 100px; width: 100%;" placeholder="Bank Address" rows="5" cols="5" required></textarea>
                </div>
                <div class="form-group mb-3 col-md-3">
                    <label for="bankphone" class="form-label">Bank Phone</label>
                    <input type="text" ng-model="data.bankphone" class="form-control search-orders" placeholder="Bank Phone">
                </div>
                <div class="form-group mb-3 col-md-3">
                    <label for="bankemail" class="form-label">Bank Email</label>
                    <input type="email" ng-model="data.bankemail" class="form-control search-orders" placeholder="Bank Email">
                </div>
                <div class="form-group mb-3 col-md-3">
                    <label for="accountno" class="form-label">Account No</label>
                    <input type="text" ng-model="data.accountno" class="form-control search-orders" placeholder="Account No">
                </div>
                <div class="form-group mb-3 col-md-3">
                    <label for="accountopeningdate" class="form-label">Account Opening Date</label>
                    <input type="date" ng-model="data.accountopeningdate" class="form-control search-orders" placeholder="Account Opening Date">
                </div>
                <div class="form-group mb-3 col-md-3">
                    <label for="email" class="form-label">Customer Email</label>
                    <input type="email" ng-model="data.email" class="form-control search-orders" placeholder="Customer Email">
                </div>
                <div class="form-group mb-3 col-md-3">
                    <label for="place" class="form-label">Place</label>
                    <input type="text" ng-model="data.place" class="form-control search-orders" placeholder="Place of Document Submition">
                </div>  
                <div class="form-group mb-3 col-md-3">
                    <label for="bankmanagername" class="form-label">Bank manager's Name</label>
                    <input type="text" ng-model="data.bankmanagername" class="form-control search-orders" placeholder="Bank manager's Name">
                </div>
                <div class="form-group mb-3 col-md-3">
                    <label for="empcode" class="form-label">Employee Code</label>
                    <input type="text" ng-model="data.empcode" class="form-control search-orders" placeholder="Employee Code">
                </div>
                <div class="form-group mb-3 col-md-3">
                    <label for="bankmanageremail" class="form-label">Bank Manager's Email</label>
                    <input type="email" ng-model="data.bankmanageremail" class="form-control search-orders" placeholder="Bank Manager's Email">
                </div>
                @* </div> *@
                <div class="text-center m-2 col-md-4">
                    <button type="submit" class="btn" style="background-color:#003980; color:white;">
                        Genrate Form
                    </button>
                </div>
            </div>
        </form>
    </div>
    <div id="printForm">
        <h1 style="padding-top: 3pt; padding-left: 1pt; text-indent: 0pt; text-align: center;">Form ISR – 2</h1>
        <p style="padding-left: 1pt; text-indent: 0pt; line-height: 114%; text-align: center;">
            (see circular No. SEBI/HO/MIRSD/MIRSD_RTAMB/P/CIR/2021/655 dated November 03, 2021 on Common and Simplified Norms for processing investor’s service request by RTAs and norms for furnishing PAN, KYC details and Nomination)
        </p>
        <h2 style="padding-top: 7pt; padding-left: 25pt; text-indent: 0pt; text-align: center;">Confirmation of Signature of securities holder by the Banker</h2>
        <p style="padding-top: 2pt; text-indent: 0pt; text-align: left;"><br /></p>
        <table style="border-collapse: collapse; margin-left: 5.554pt;" cellspacing="0">
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 12pt; text-align: left;">1. Bank Name and Branch</p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;">{{data.branch}}</p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
            </tr>
            <tr style="height: 54pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 23pt; padding-right: 109pt; text-indent: -18pt; text-align: left;">2. Bank contact details 
                     <br>Postal Address <br> Phone number <br>E-mail address</p>

                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br>{{data.bankaddress}}<br> {{data.bankphone}} <br>{{data.bankemail}}</p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 13pt; text-align: left;">3. Bank Account number</p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;">{{data.accountno}}</p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 12pt; text-align: left;">4. Account opening date</p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;">{{data.accountopeningdate | date: 'dd/MM/yyyy'}}</p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
            </tr>
            <tr style="height: 68pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 13pt; text-align: left;">5. Account holder(s) name(s)</p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 13pt; text-align: left;">1) {{data.customerName}}</p>
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; text-align: left;">2) {{data.holders}}</p>
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 13pt; text-align: left;">3) </p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
            </tr>
            <tr style="height: 125pt;">
                <td
                    style="
                        width: 446pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="6"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 13pt; text-align: left;padding-bottom: 40px;">6. Latest photograph of the account holder(s)</p>
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                    <p style="text-indent: 0pt; text-align: left;" />
                    <p style="text-indent: 0pt; text-align: left;" />
                    <p style="text-indent: 0pt; text-align: left;" />
                    <p class="s2" style="padding-left: 2pt; text-indent: 0pt; text-align: center;">
                        <span style="margin-right: 10px; border: 1px solid black; padding: 35px;">1<span class="s3">st</span> Holder</span>
                        <span style="margin-right: 10px; border: 1px solid black; padding: 35px;">2<span class="s5">nd</span> Holder</span>
                        <span style="border: 1px solid black; padding: 35px;">3<span class="s3">rd</span> Holder</span>
                    </p>
                </td>
            </tr>
            
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 446pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="6"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 13pt; text-align: left;">7. Account holder(s) details as per Bank Records</p>
                </td>
            </tr>
            <tr style="height: 54pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 23pt; text-indent: 0pt; line-height: 13pt; text-align: left;">a) Address</p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;">{{data.address}}</p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 23pt; text-indent: 0pt; line-height: 12pt; text-align: left;">b) Phone number</p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;">{{data.mobile}}</p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 227pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 23pt; text-indent: 0pt; line-height: 12pt; text-align: left;">c) Email address</p>
                </td>
                <td
                    style="
                        width: 219pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;">{{data.email}}</p>
                </td>
            </tr>
            <tr style="height: 20pt;">
                <td style="width: 446pt; border-top-style: dotted; border-top-width: 1pt; border-left-style: dotted; border-left-width: 1pt; border-right-style: dotted; border-right-width: 1pt;" colspan="6">
                    <p class="s1" style="padding-left: 23pt; text-indent: 0pt; line-height: 13pt; text-align: left;">d) Signature(s)</p>
                </td>
            </tr>
            <tr style="height: 43pt;">
                <td style="width: 18pt; border-left-style: dotted; border-left-width: 1pt; border-right-style: solid; border-right-width: 1pt; border-right-color: #221f1f;">
                    <p style="padding-top: 6pt; text-indent: 0pt; text-align: left;"><br /></p>
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; text-align: left;">1)</p>
                </td>
                <td
                    style="
                        width: 126pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-top-color: #221f1f;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-left-color: #221f1f;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-bottom-color: #221f1f;
                        border-right-style: solid;
                        border-right-width: 1pt;
                        border-right-color: #221f1f;
                    "
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
                <td style="width: 26pt; border-left-style: solid; border-left-width: 1pt; border-left-color: #221f1f; border-right-style: solid; border-right-width: 1pt; border-right-color: #221f1f;">
                    <p style="padding-top: 6pt; text-indent: 0pt; text-align: left;"><br /></p>
                    <p class="s1" style="padding-left: 14pt; text-indent: 0pt; text-align: left;">2)</p>
                </td>
                <td
                    style="
                        width: 126pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-top-color: #221f1f;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-left-color: #221f1f;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-bottom-color: #221f1f;
                        border-right-style: solid;
                        border-right-width: 1pt;
                        border-right-color: #221f1f;
                    "
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
                <td style="width: 23pt; border-left-style: solid; border-left-width: 1pt; border-left-color: #221f1f; border-right-style: solid; border-right-width: 1pt; border-right-color: #221f1f;">
                    <p style="padding-top: 6pt; text-indent: 0pt; text-align: left;"><br /></p>
                    <p class="s1" style="padding-left: 11pt; text-indent: 0pt; text-align: left;">3)</p>
                </td>
                <td
                    style="
                        width: 127pt;
                        border-top-style: solid;
                        border-top-width: 1pt;
                        border-top-color: #221f1f;
                        border-left-style: solid;
                        border-left-width: 1pt;
                        border-left-color: #221f1f;
                        border-bottom-style: solid;
                        border-bottom-width: 1pt;
                        border-bottom-color: #221f1f;
                        border-right-style: solid;
                        border-right-width: 1pt;
                        border-right-color: #221f1f;
                    "
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
            </tr>
            <tr style="height: 59pt;">
                <td style="width: 446pt; border-left-style: dotted; border-left-width: 1pt; border-bottom-style: dotted; border-bottom-width: 1pt; border-right-style: dotted; border-right-width: 1pt;" colspan="6">
                    <p class="s2" style="padding-top: 2pt; padding-left: 231pt; text-indent: 0pt; text-align: left;">Signature verified as recorded with the Bank</p>
                    <p class="s2" style="padding-left: 5pt; text-indent: 0pt; text-align: left;">Seal of the Bank</p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 127pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
                <td
                    style="
                        width: 319pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 12pt; text-align: left;">(Signature)</p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 127pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 12pt; text-align: left;">Place: {{data.place}}</p>
                </td>
                <td
                    style="
                        width: 319pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 12pt; text-align: left;">Name of the Bank Manager:{{data.bankmanagername}}</p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 127pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p style="text-indent: 0pt; text-align: left;"><br /></p>
                </td>
                <td
                    style="
                        width: 319pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 12pt; text-align: left;">Employee Code: {{data.empcode}}</p>
                </td>
            </tr>
            <tr style="height: 14pt;">
                <td
                    style="
                        width: 127pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="2"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 12pt; text-align: left;">Date: {{data.date | date:'dd/MM/yyyy'}}</p>
                </td>
                <td
                    style="
                        width: 319pt;
                        border-top-style: dotted;
                        border-top-width: 1pt;
                        border-left-style: dotted;
                        border-left-width: 1pt;
                        border-bottom-style: dotted;
                        border-bottom-width: 1pt;
                        border-right-style: dotted;
                        border-right-width: 1pt;
                    "
                    colspan="4"
                >
                    <p class="s1" style="padding-left: 5pt; text-indent: 0pt; line-height: 12pt; text-align: left;">E-mail address: {{data.bankmanageremail}}</p>
                </td>
            </tr>
        </table>
         </div>
    <button class="btn btn-store" ng-click="printDiv('printForm')">Print</button>
    </body>
    <script>
    angular.module('Stock-CMS', []).controller('FormController', function ($scope, $http) {
        $scope.customers = [];
         $scope.hDiv = true;
            var params = new URLSearchParams(window.location.search);
            var id = params.get('id');
            var id2 = params.get('id2');
        var isProcessing = false;

        // showLoader();

        // Load Customers

        $scope.loadCustomers = function (sid) {

             if(id){
                 var currentDate = new Date();
             var monthsOfYear = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
                 $scope.hDiv = true;
            $http.get('/Enquiry/GetStocksById/'+id).then(function (response) {
                var result = response.data;
                let holders = [
                        result.firstHolder || '',
                        result.secondHolder || '',
                        result.thirdHolder || ''
                    ].filter(holder => holder.trim() !== '');
                 // $http.get('/doc/getDocs/' + result.customer.id).then(function (response) {
                 //    $scope.doc = response.data;
                 //    var docs = response.data[sid - 1];
                 //    var Age = $scope.calculateAge(docs.dob);


                $scope.data = {
                    branch: '',
                    bankaddress: '',
                    bankphone: '',
                    bankemail: '',
                    accountno:'',
                    accountopeningdate: '',
                   customerName : result.customer.customerName,
                   address : result.customer.address,
                   mobile: result.customer.mobile,
                   holders : holders.length > 0 ? `${holders.join(') (')}` : '',
                   email: '',
                   place: '',
                   date: new Date(),
                   bankmanagername: '',
                   empcode: '',
                   bankmanageremail: '',
                };

                hideLoader();
                // }, function (error) {
                //     console.error('Error loading Docs:', error);
                //     hideLoader();
                // });
            }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
            });
            }

            if(id2){
                 $scope.hDiv = false;
            $http.get('/Form/GetGenratedFormById/'+id2).then(function (response) {
                var result = response.data;
                var obj = JSON.parse(result.jsonString);
                $scope.data = {
                    branch: obj.branch,
                    bankaddress: obj.bankaddress,
                    bankphone: obj.bankphone,
                    bankemail: obj.bankemail,
                    accountno: obj.accountno,
                    accountopeningdate: new Date(obj.accountopeningdate),
                    customerName: obj.customerName,
                    address:obj.address,
                    mobile: obj.mobile,
                   holders: obj.holders,
                   email: obj.email,
                   place: obj.place,
                   date: new Date(obj.date),
                   bankmanagername: obj.bankmanagername,
                   empcode: obj.empcode,
                   bankmanageremail: obj.bankmanageremail,
                };
                hideLoader();
            }, function (error) {
                console.error('Error loading customers:', error);
                hideLoader();
            });
            }
        };

     $scope.calculateAge = function(dob) {
      if (!dob) {
        return '';
      }
      var birthDate = new Date(dob);
      var currentDate = new Date();
      var age = currentDate.getFullYear() - birthDate.getFullYear();
      var m = currentDate.getMonth() - birthDate.getMonth();

      // Adjust age if the current month is before the birth month or if the birth day hasn't occurred yet
      if (m < 0 || (m === 0 && currentDate.getDate() < birthDate.getDate())) {
        age--;
      }
      return age;
    };

        //Genrate Form
         $scope.genrateForm = function () {
             if(id){
             let jsonString = JSON.stringify($scope.data, null, 2);
             var data ={
                 formName : 'Form ISR 2',
                 StockId : id,
                 url : `/Form/FormISR2?id2=`,
                 jsonString : jsonString,
                 IsActive : true
             }

             const url = '/Form/GenrateForm';
                $http.post(url, data).then(function (response) {
                    if (response.data.success) {
                        Swal.fire({
                            title: 'Success',
                            text: response.data.message || 'Operation successful!',
                            icon: 'success',
                            confirmButtonText: 'OK'
                        });
                        $scope.loadCustomers();
                    } else {
                        Swal.fire({
                            title: 'Error!',
                            text: response.data.message || 'There was an issue adding the customer.',
                            icon: 'error',
                            confirmButtonText: 'Try Again'
                        });
                    }
                    isProcessing = false;
                }, function (error) {
                    Swal.fire({
                        title: 'Error',
                        text: 'An error occurred.',
                        icon: 'error',
                        confirmButtonText: 'OK'
                    });
                    isProcessing = false;
                });
            //console.log(dataString);
            }
         }

        // Load Customers
        // $scope.loadCustomers = function () {
        //     $http.get('/Master/GetCustomers').then(function (response) {
        //         $scope.customers = response.data[0];
        //         hideLoader();
        //     }, function (error) {
        //         console.error('Error loading customers:', error);
        //         hideLoader();
        //     });
        // };

        // $scope.loadDocs = function () {
        //     if (true) {
        //         $http.get('/doc/getDocs/' + 1).then(function (response) {
        //             $scope.docs = response.data;
        //             hideLoader();
        //         }, function (error) {
        //             console.error('Error loading Docs:', error);
        //             hideLoader();
        //         });
        //     }
        // };

        //Function
        $scope.printDiv = function (divId) {
                var css ='<style type="text/css">*{margin:0;padding:0;text-indent:0}h1{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:18pt}p{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:10pt;margin:0pt}h2{color:black;font-family:Arial,sans-serif;font-style:normal;font-weight:bold;text-decoration:none;font-size:12pt}.s1{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:11pt}.s2{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt}.s3{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:8pt;vertical-align:4pt}.s4{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:12pt;vertical-align:-1pt}.s5{color:black;font-family:Calibri,sans-serif;font-style:normal;font-weight:normal;text-decoration:none;font-size:8pt;vertical-align:3pt}table,tbody{vertical-align:top;overflow:visible}</style>';
            var innerContents = document.getElementById(divId).innerHTML;
            var popupWinindow = window.open('', '_blank', 'width=600,height=700,scrollbars=no,menubar=no,toolbar=no,location=no,status=no,titlebar=no');
            popupWinindow.document.open();
            popupWinindow.document.write('<html><head><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">' + css + '</ head > <body style="padding-left: 10%;"onload="window.print()">' + innerContents + '</html>');
            popupWinindow.document.close();
        };
        //Initialize
        $scope.loadCustomers();
        // $scope.loadDocs();
    });
</script>
</html>
